  0%|          | 0/264 [00:00<?, ?it/s][Info] initializing weights...
  0%|          | 1/264 [00:04<19:44,  4.51s/it]  1%|          | 2/264 [00:05<14:53,  3.41s/it]  1%|          | 3/264 [00:06<11:25,  2.63s/it]  2%|▏         | 4/264 [00:06<09:02,  2.09s/it]  2%|▏         | 5/264 [00:07<07:21,  1.70s/it]  2%|▏         | 6/264 [00:08<06:13,  1.45s/it]  3%|▎         | 7/264 [00:09<05:22,  1.25s/it]  3%|▎         | 8/264 [00:10<04:47,  1.12s/it]  3%|▎         | 9/264 [00:11<04:23,  1.04s/it]  4%|▍         | 10/264 [00:11<04:07,  1.03it/s]  4%|▍         | 11/264 [00:12<04:06,  1.03it/s]  5%|▍         | 12/264 [00:13<03:53,  1.08it/s]  5%|▍         | 13/264 [00:14<03:48,  1.10it/s]  5%|▌         | 14/264 [00:15<03:43,  1.12it/s]  6%|▌         | 15/264 [00:16<03:37,  1.15it/s]  6%|▌         | 16/264 [00:17<03:31,  1.17it/s]  6%|▋         | 17/264 [00:17<03:30,  1.17it/s]  7%|▋         | 18/264 [00:18<03:25,  1.20it/s]  7%|▋         | 19/264 [00:19<03:23,  1.20it/s]  8%|▊         | 20/264 [00:20<03:22,  1.20it/s]  8%|▊         | 21/264 [00:21<03:26,  1.18it/s]  8%|▊         | 22/264 [00:22<03:34,  1.13it/s]  9%|▊         | 23/264 [00:23<03:30,  1.15it/s]  9%|▉         | 24/264 [00:23<03:24,  1.17it/s]  9%|▉         | 25/264 [00:24<03:22,  1.18it/s] 10%|▉         | 26/264 [00:25<03:17,  1.20it/s] 10%|█         | 27/264 [00:26<03:15,  1.22it/s] 11%|█         | 28/264 [00:27<03:15,  1.21it/s] 11%|█         | 29/264 [00:28<03:19,  1.18it/s] 11%|█▏        | 30/264 [00:28<03:21,  1.16it/s] 12%|█▏        | 31/264 [00:29<03:22,  1.15it/s] 12%|█▏        | 32/264 [00:30<03:25,  1.13it/s] 12%|█▎        | 33/264 [00:31<03:21,  1.15it/s] 13%|█▎        | 34/264 [00:32<03:17,  1.17it/s] 13%|█▎        | 35/264 [00:33<03:13,  1.18it/s] 14%|█▎        | 36/264 [00:34<03:11,  1.19it/s] 14%|█▍        | 37/264 [00:34<03:08,  1.20it/s] 14%|█▍        | 38/264 [00:35<03:14,  1.16it/s] 15%|█▍        | 39/264 [00:36<03:19,  1.13it/s] 15%|█▌        | 40/264 [00:37<03:16,  1.14it/s] 16%|█▌        | 41/264 [00:38<03:10,  1.17it/s] 16%|█▌        | 42/264 [00:39<03:14,  1.14it/s] 16%|█▋        | 43/264 [00:40<03:07,  1.18it/s] 17%|█▋        | 44/264 [00:40<03:06,  1.18it/s] 17%|█▋        | 45/264 [00:41<03:03,  1.19it/s] 17%|█▋        | 46/264 [00:42<03:07,  1.16it/s] 18%|█▊        | 47/264 [00:43<03:03,  1.19it/s] 18%|█▊        | 48/264 [00:44<02:59,  1.20it/s] 19%|█▊        | 49/264 [00:45<02:57,  1.21it/s] 19%|█▉        | 50/264 [00:45<02:55,  1.22it/s] 19%|█▉        | 51/264 [00:46<02:53,  1.23it/s] 20%|█▉        | 52/264 [00:47<02:52,  1.23it/s] 20%|██        | 53/264 [00:48<02:51,  1.23it/s] 20%|██        | 54/264 [00:49<03:02,  1.15it/s] 21%|██        | 55/264 [00:50<03:06,  1.12it/s] 21%|██        | 56/264 [00:51<03:03,  1.14it/s] 22%|██▏       | 57/264 [00:51<02:58,  1.16it/s] 22%|██▏       | 58/264 [00:52<02:55,  1.17it/s] 22%|██▏       | 59/264 [00:53<02:53,  1.18it/s] 23%|██▎       | 60/264 [00:54<02:50,  1.19it/s] 23%|██▎       | 61/264 [00:55<02:54,  1.16it/s] 23%|██▎       | 62/264 [00:56<02:50,  1.18it/s] 24%|██▍       | 63/264 [00:57<02:52,  1.17it/s] 24%|██▍       | 64/264 [00:57<02:48,  1.18it/s] 25%|██▍       | 65/264 [00:58<02:50,  1.17it/s] 25%|██▌       | 66/264 [00:59<02:49,  1.17it/s] 25%|██▌       | 67/264 [01:00<02:49,  1.16it/s] 26%|██▌       | 68/264 [01:01<02:46,  1.18it/s] 26%|██▌       | 69/264 [01:02<02:42,  1.20it/s] 27%|██▋       | 70/264 [01:03<02:46,  1.17it/s] 27%|██▋       | 71/264 [01:03<02:43,  1.18it/s] 27%|██▋       | 72/264 [01:04<02:46,  1.15it/s] 28%|██▊       | 73/264 [01:05<02:48,  1.14it/s] 28%|██▊       | 74/264 [01:06<02:42,  1.17it/s] 28%|██▊       | 75/264 [01:07<02:40,  1.18it/s] 29%|██▉       | 76/264 [01:08<02:36,  1.20it/s] 29%|██▉       | 77/264 [01:09<02:43,  1.14it/s] 30%|██▉       | 78/264 [01:09<02:41,  1.15it/s] 30%|██▉       | 79/264 [01:10<02:37,  1.18it/s] 30%|███       | 80/264 [01:11<02:40,  1.14it/s] 31%|███       | 81/264 [01:12<02:37,  1.16it/s] 31%|███       | 82/264 [01:13<02:34,  1.18it/s] 31%|███▏      | 83/264 [01:14<02:31,  1.20it/s] 32%|███▏      | 84/264 [01:14<02:30,  1.20it/s] 32%|███▏      | 85/264 [01:15<02:34,  1.16it/s] 33%|███▎      | 86/264 [01:16<02:36,  1.14it/s] 33%|███▎      | 87/264 [01:17<02:29,  1.18it/s] 33%|███▎      | 88/264 [01:18<02:29,  1.18it/s] 34%|███▎      | 89/264 [01:19<02:27,  1.19it/s] 34%|███▍      | 90/264 [01:20<02:24,  1.20it/s] 34%|███▍      | 91/264 [01:20<02:22,  1.21it/s] 35%|███▍      | 92/264 [01:21<02:26,  1.18it/s] 35%|███▌      | 93/264 [01:22<02:24,  1.19it/s] 36%|███▌      | 94/264 [01:23<02:21,  1.20it/s] 36%|███▌      | 95/264 [01:24<02:18,  1.22it/s] 36%|███▋      | 96/264 [01:24<02:17,  1.22it/s] 37%|███▋      | 97/264 [01:25<02:17,  1.21it/s] 37%|███▋      | 98/264 [01:26<02:20,  1.18it/s] 38%|███▊      | 99/264 [01:27<02:26,  1.12it/s] 38%|███▊      | 100/264 [01:28<02:25,  1.12it/s] 38%|███▊      | 101/264 [01:29<02:25,  1.12it/s] 39%|███▊      | 102/264 [01:30<02:20,  1.15it/s] 39%|███▉      | 103/264 [01:31<02:17,  1.17it/s] 39%|███▉      | 104/264 [01:31<02:12,  1.21it/s] 40%|███▉      | 105/264 [01:32<02:11,  1.21it/s] 40%|████      | 106/264 [01:33<02:11,  1.20it/s] 41%|████      | 107/264 [01:34<02:15,  1.16it/s] 41%|████      | 108/264 [01:35<02:11,  1.19it/s] 41%|████▏     | 109/264 [01:36<02:14,  1.15it/s] 42%|████▏     | 110/264 [01:37<02:17,  1.12it/s] 42%|████▏     | 111/264 [01:37<02:11,  1.16it/s] 42%|████▏     | 112/264 [01:38<02:15,  1.12it/s] 43%|████▎     | 113/264 [01:39<02:11,  1.15it/s] 43%|████▎     | 114/264 [01:40<02:12,  1.13it/s] 44%|████▎     | 115/264 [01:41<02:07,  1.17it/s] 44%|████▍     | 116/264 [01:42<02:05,  1.18it/s] 44%|████▍     | 117/264 [01:43<02:02,  1.20it/s] 45%|████▍     | 118/264 [01:43<02:02,  1.20it/s] 45%|████▌     | 119/264 [01:44<02:05,  1.15it/s] 45%|████▌     | 120/264 [01:45<02:02,  1.18it/s] 46%|████▌     | 121/264 [01:46<02:03,  1.16it/s] 46%|████▌     | 122/264 [01:47<02:00,  1.18it/s] 47%|████▋     | 123/264 [01:48<01:58,  1.19it/s] 47%|████▋     | 124/264 [01:49<01:56,  1.21it/s] 47%|████▋     | 125/264 [01:49<01:54,  1.21it/s] 48%|████▊     | 126/264 [01:50<01:53,  1.22it/s] 48%|████▊     | 127/264 [01:51<01:52,  1.21it/s] 48%|████▊     | 128/264 [01:52<01:51,  1.22it/s] 49%|████▉     | 129/264 [01:53<01:49,  1.23it/s] 49%|████▉     | 130/264 [01:53<01:48,  1.23it/s] 50%|████▉     | 131/264 [01:54<01:48,  1.23it/s] 50%|█████     | 132/264 [01:55<01:52,  1.17it/s] 50%|█████     | 133/264 [01:56<01:51,  1.17it/s] 51%|█████     | 134/264 [01:57<01:49,  1.19it/s] 51%|█████     | 135/264 [01:58<01:48,  1.19it/s] 52%|█████▏    | 136/264 [01:58<01:45,  1.21it/s] 52%|█████▏    | 137/264 [01:59<01:44,  1.21it/s] 52%|█████▏    | 138/264 [02:00<01:43,  1.22it/s] 53%|█████▎    | 139/264 [02:01<01:43,  1.21it/s] 53%|█████▎    | 140/264 [02:02<01:46,  1.17it/s] 53%|█████▎    | 141/264 [02:03<01:42,  1.20it/s] 54%|█████▍    | 142/264 [02:03<01:40,  1.21it/s] 54%|█████▍    | 143/264 [02:04<01:41,  1.20it/s] 55%|█████▍    | 144/264 [02:05<01:39,  1.21it/s] 55%|█████▍    | 145/264 [02:06<01:38,  1.21it/s] 55%|█████▌    | 146/264 [02:07<01:36,  1.22it/s] 56%|█████▌    | 147/264 [02:08<01:35,  1.23it/s] 56%|█████▌    | 148/264 [02:08<01:34,  1.23it/s] 56%|█████▋    | 149/264 [02:09<01:33,  1.23it/s] 57%|█████▋    | 150/264 [02:10<01:32,  1.23it/s] 57%|█████▋    | 151/264 [02:11<01:31,  1.23it/s] 58%|█████▊    | 152/264 [02:12<01:30,  1.23it/s] 58%|█████▊    | 153/264 [02:12<01:30,  1.23it/s] 58%|█████▊    | 154/264 [02:13<01:30,  1.21it/s] 59%|█████▊    | 155/264 [02:14<01:30,  1.21it/s] 59%|█████▉    | 156/264 [02:15<01:29,  1.21it/s] 59%|█████▉    | 157/264 [02:16<01:27,  1.23it/s] 60%|█████▉    | 158/264 [02:17<01:26,  1.23it/s] 60%|██████    | 159/264 [02:17<01:29,  1.18it/s] 61%|██████    | 160/264 [02:18<01:27,  1.19it/s] 61%|██████    | 161/264 [02:19<01:25,  1.20it/s] 61%|██████▏   | 162/264 [02:20<01:24,  1.21it/s] 62%|██████▏   | 163/264 [02:21<01:25,  1.18it/s] 62%|██████▏   | 164/264 [02:22<01:24,  1.19it/s] 62%|██████▎   | 165/264 [02:23<01:27,  1.14it/s] 63%|██████▎   | 166/264 [02:23<01:26,  1.14it/s] 63%|██████▎   | 167/264 [02:24<01:23,  1.16it/s] 64%|██████▎   | 168/264 [02:25<01:21,  1.18it/s] 64%|██████▍   | 169/264 [02:26<01:22,  1.15it/s] 64%|██████▍   | 170/264 [02:27<01:19,  1.19it/s] 65%|██████▍   | 171/264 [02:28<01:17,  1.20it/s] 65%|██████▌   | 172/264 [02:28<01:15,  1.21it/s] 66%|██████▌   | 173/264 [02:29<01:18,  1.16it/s] 66%|██████▌   | 174/264 [02:30<01:16,  1.18it/s] 66%|██████▋   | 175/264 [02:31<01:17,  1.15it/s] 67%|██████▋   | 176/264 [02:32<01:15,  1.16it/s] 67%|██████▋   | 177/264 [02:33<01:15,  1.15it/s] 67%|██████▋   | 178/264 [02:34<01:16,  1.13it/s] 68%|██████▊   | 179/264 [02:35<01:14,  1.14it/s] 68%|██████▊   | 180/264 [02:35<01:11,  1.17it/s] 69%|██████▊   | 181/264 [02:36<01:12,  1.15it/s] 69%|██████▉   | 182/264 [02:37<01:12,  1.13it/s] 69%|██████▉   | 183/264 [02:38<01:09,  1.16it/s] 70%|██████▉   | 184/264 [02:39<01:09,  1.16it/s] 70%|███████   | 185/264 [02:40<01:09,  1.14it/s] 70%|███████   | 186/264 [02:41<01:07,  1.16it/s] 71%|███████   | 187/264 [02:42<01:08,  1.13it/s] 71%|███████   | 188/264 [02:42<01:07,  1.13it/s] 72%|███████▏  | 189/264 [02:43<01:04,  1.16it/s] 72%|███████▏  | 190/264 [02:44<01:03,  1.16it/s] 72%|███████▏  | 191/264 [02:45<01:03,  1.14it/s] 73%|███████▎  | 192/264 [02:46<01:02,  1.16it/s] 73%|███████▎  | 193/264 [02:47<01:01,  1.15it/s] 73%|███████▎  | 194/264 [02:48<00:59,  1.18it/s] 74%|███████▍  | 195/264 [02:48<00:57,  1.20it/s] 74%|███████▍  | 196/264 [02:49<00:56,  1.21it/s] 75%|███████▍  | 197/264 [02:50<00:54,  1.22it/s] 75%|███████▌  | 198/264 [02:51<00:54,  1.21it/s] 75%|███████▌  | 199/264 [02:52<00:53,  1.22it/s] 76%|███████▌  | 200/264 [02:52<00:52,  1.22it/s] 76%|███████▌  | 201/264 [02:53<00:51,  1.22it/s] 77%|███████▋  | 202/264 [02:54<00:50,  1.22it/s] 77%|███████▋  | 203/264 [02:55<00:50,  1.22it/s] 77%|███████▋  | 204/264 [02:56<00:49,  1.22it/s] 78%|███████▊  | 205/264 [02:57<00:48,  1.22it/s] 78%|███████▊  | 206/264 [02:57<00:48,  1.21it/s] 78%|███████▊  | 207/264 [02:58<00:48,  1.18it/s] 79%|███████▉  | 208/264 [02:59<00:47,  1.17it/s] 79%|███████▉  | 209/264 [03:00<00:47,  1.16it/s] 80%|███████▉  | 210/264 [03:01<00:45,  1.18it/s] 80%|███████▉  | 211/264 [03:02<00:46,  1.14it/s] 80%|████████  | 212/264 [03:03<00:44,  1.17it/s] 81%|████████  | 213/264 [03:03<00:43,  1.19it/s] 81%|████████  | 214/264 [03:04<00:43,  1.16it/s] 81%|████████▏ | 215/264 [03:05<00:43,  1.13it/s] 82%|████████▏ | 216/264 [03:06<00:41,  1.16it/s] 82%|████████▏ | 217/264 [03:07<00:39,  1.18it/s] 83%|████████▎ | 218/264 [03:08<00:38,  1.21it/s] 83%|████████▎ | 219/264 [03:09<00:38,  1.16it/s] 83%|████████▎ | 220/264 [03:10<00:38,  1.13it/s] 84%|████████▎ | 221/264 [03:10<00:37,  1.13it/s] 84%|████████▍ | 222/264 [03:11<00:36,  1.15it/s] 84%|████████▍ | 223/264 [03:12<00:35,  1.17it/s] 85%|████████▍ | 224/264 [03:13<00:34,  1.16it/s] 85%|████████▌ | 225/264 [03:14<00:33,  1.18it/s] 86%|████████▌ | 226/264 [03:15<00:31,  1.20it/s] 86%|████████▌ | 227/264 [03:15<00:30,  1.21it/s] 86%|████████▋ | 228/264 [03:16<00:29,  1.22it/s] 87%|████████▋ | 229/264 [03:17<00:28,  1.23it/s] 87%|████████▋ | 230/264 [03:18<00:27,  1.23it/s] 88%|████████▊ | 231/264 [03:19<00:27,  1.22it/s] 88%|████████▊ | 232/264 [03:19<00:26,  1.22it/s] 88%|████████▊ | 233/264 [03:20<00:25,  1.23it/s] 89%|████████▊ | 234/264 [03:21<00:24,  1.22it/s] 89%|████████▉ | 235/264 [03:22<00:23,  1.22it/s] 89%|████████▉ | 236/264 [03:23<00:22,  1.22it/s] 90%|████████▉ | 237/264 [03:24<00:22,  1.22it/s] 90%|█████████ | 238/264 [03:24<00:22,  1.16it/s] 91%|█████████ | 239/264 [03:25<00:21,  1.18it/s] 91%|█████████ | 240/264 [03:26<00:19,  1.21it/s] 91%|█████████▏| 241/264 [03:27<00:18,  1.21it/s] 92%|█████████▏| 242/264 [03:28<00:18,  1.20it/s] 92%|█████████▏| 243/264 [03:29<00:17,  1.21it/s] 92%|█████████▏| 244/264 [03:29<00:16,  1.21it/s] 93%|█████████▎| 245/264 [03:30<00:15,  1.21it/s] 93%|█████████▎| 246/264 [03:31<00:14,  1.20it/s] 94%|█████████▎| 247/264 [03:32<00:14,  1.21it/s] 94%|█████████▍| 248/264 [03:33<00:13,  1.21it/s] 94%|█████████▍| 249/264 [03:34<00:12,  1.19it/s] 95%|█████████▍| 250/264 [03:34<00:11,  1.20it/s] 95%|█████████▌| 251/264 [03:35<00:11,  1.17it/s] 95%|█████████▌| 252/264 [03:36<00:10,  1.19it/s] 96%|█████████▌| 253/264 [03:37<00:09,  1.18it/s] 96%|█████████▌| 254/264 [03:38<00:08,  1.20it/s] 97%|█████████▋| 255/264 [03:39<00:07,  1.16it/s] 97%|█████████▋| 256/264 [03:39<00:06,  1.18it/s] 97%|█████████▋| 257/264 [03:40<00:05,  1.21it/s] 98%|█████████▊| 258/264 [03:41<00:04,  1.22it/s] 98%|█████████▊| 259/264 [03:42<00:04,  1.21it/s] 98%|█████████▊| 260/264 [03:43<00:03,  1.22it/s] 99%|█████████▉| 261/264 [03:44<00:02,  1.24it/s] 99%|█████████▉| 262/264 [03:44<00:01,  1.29it/s]100%|█████████▉| 263/264 [03:45<00:00,  1.33it/s]100%|██████████| 264/264 [03:46<00:00,  1.34it/s]100%|██████████| 264/264 [03:46<00:00,  1.17it/s]Step: 0. Epoch: 0/30. Iteration: 1/264. Cls loss: 35375.80078. Reg loss: 0.53151. Total loss: 35376.33203
Step 0: Current Classification Loss:35375.800781; Current Regression Loss:0.531507; Current Loss:35376.332031;              Average Classification Loss:35375.800781; Average Regression Loss:0.531507; Average Loss:35376.332031; Current Learning Rate:0.000100.
Save Model
Save current model ...
[Error] Traceback (most recent call last):
  File "train.py", line 346, in train
    save_model(model, best_model, current_model, best_loss, loss, opt.saved_model_path, step, opt.compound_coef)
  File "train.py", line 439, in save_model
    torch.save(model, model_path)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 328, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 401, in _legacy_save
    pickler.dump(obj)
AttributeError: Can't pickle local object 'train.<locals>.ModelWithLoss'

Can't pickle local object 'train.<locals>.ModelWithLoss'
Step: 100. Epoch: 0/30. Iteration: 101/264. Cls loss: 46920.49219. Reg loss: 0.38522. Total loss: 46920.87891
Step 100: Current Classification Loss:46920.492188; Current Regression Loss:0.385216; Current Loss:46920.878906;              Average Classification Loss:49851.160079; Average Regression Loss:0.358759; Average Loss:49851.518893; Current Learning Rate:0.000100.
Save Model
Save current model ...
[Error] Traceback (most recent call last):
  File "train.py", line 346, in train
    save_model(model, best_model, current_model, best_loss, loss, opt.saved_model_path, step, opt.compound_coef)
  File "train.py", line 439, in save_model
    torch.save(model, model_path)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 328, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 401, in _legacy_save
    pickler.dump(obj)
AttributeError: Can't pickle local object 'train.<locals>.ModelWithLoss'

Can't pickle local object 'train.<locals>.ModelWithLoss'
Step: 200. Epoch: 0/30. Iteration: 201/264. Cls loss: 31258.83594. Reg loss: 0.09256. Total loss: 31258.92773
Step 200: Current Classification Loss:31258.835938; Current Regression Loss:0.092562; Current Loss:31258.927734;              Average Classification Loss:43920.107558; Average Regression Loss:0.315274; Average Loss:43920.422876; Current Learning Rate:0.000100.

  0%|          | 0/264 [00:00<?, ?it/s]Val. Epoch: 0/30. Classification loss: 13829.87175. Regression loss: 0.11514. Total loss: 13829.98689
--------------------------------------------After Epoch 0------------------------------------------------
Step 264: Validation Classification Loss:13829.871750; Regression Loss:0.115141; Total Loss:13829.986891
----------------------------------------------------------------------------------------------------------
  0%|          | 1/264 [00:01<08:31,  1.94s/it]  1%|          | 2/264 [00:02<07:11,  1.65s/it]  1%|          | 3/264 [00:03<06:11,  1.42s/it]  2%|▏         | 4/264 [00:04<05:36,  1.29s/it]  2%|▏         | 5/264 [00:05<05:04,  1.18s/it]  2%|▏         | 6/264 [00:06<04:44,  1.10s/it]  3%|▎         | 7/264 [00:07<04:25,  1.03s/it]  3%|▎         | 8/264 [00:08<04:05,  1.04it/s]  3%|▎         | 9/264 [00:09<03:53,  1.09it/s]  4%|▍         | 10/264 [00:09<03:48,  1.11it/s]  4%|▍         | 11/264 [00:10<03:43,  1.13it/s]  5%|▍         | 12/264 [00:11<03:38,  1.15it/s]  5%|▍         | 13/264 [00:12<03:34,  1.17it/s]  5%|▌         | 14/264 [00:13<03:30,  1.19it/s]  6%|▌         | 15/264 [00:14<03:31,  1.18it/s]  6%|▌         | 16/264 [00:15<03:34,  1.16it/s]  6%|▋         | 17/264 [00:15<03:28,  1.18it/s]  7%|▋         | 18/264 [00:16<03:24,  1.20it/s]  7%|▋         | 19/264 [00:17<03:23,  1.20it/s]  8%|▊         | 20/264 [00:18<03:26,  1.18it/s]  8%|▊         | 21/264 [00:19<03:25,  1.18it/s]  8%|▊         | 22/264 [00:19<03:21,  1.20it/s]  9%|▊         | 23/264 [00:20<03:20,  1.20it/s]  9%|▉         | 24/264 [00:21<03:29,  1.14it/s]  9%|▉         | 25/264 [00:22<03:25,  1.16it/s] 10%|▉         | 26/264 [00:23<03:22,  1.17it/s] 10%|█         | 27/264 [00:24<03:19,  1.19it/s] 11%|█         | 28/264 [00:25<03:26,  1.14it/s] 11%|█         | 29/264 [00:26<03:22,  1.16it/s] 11%|█▏        | 30/264 [00:26<03:19,  1.17it/s] 12%|█▏        | 31/264 [00:27<03:16,  1.19it/s] 12%|█▏        | 32/264 [00:28<03:13,  1.20it/s] 12%|█▎        | 33/264 [00:29<03:12,  1.20it/s] 13%|█▎        | 34/264 [00:30<03:10,  1.21it/s] 13%|█▎        | 35/264 [00:31<03:17,  1.16it/s] 14%|█▎        | 36/264 [00:31<03:14,  1.17it/s] 14%|█▍        | 37/264 [00:32<03:10,  1.19it/s] 14%|█▍        | 38/264 [00:33<03:16,  1.15it/s] 15%|█▍        | 39/264 [00:34<03:10,  1.18it/s] 15%|█▌        | 40/264 [00:35<03:08,  1.19it/s] 16%|█▌        | 41/264 [00:36<03:04,  1.21it/s] 16%|█▌        | 42/264 [00:37<03:08,  1.18it/s] 16%|█▋        | 43/264 [00:37<03:08,  1.17it/s] 17%|█▋        | 44/264 [00:38<03:06,  1.18it/s] 17%|█▋        | 45/264 [00:39<03:03,  1.20it/s] 17%|█▋        | 46/264 [00:40<03:00,  1.21it/s] 18%|█▊        | 47/264 [00:41<02:59,  1.21it/s] 18%|█▊        | 48/264 [00:41<02:55,  1.23it/s] 19%|█▊        | 49/264 [00:42<02:55,  1.23it/s] 19%|█▉        | 50/264 [00:43<02:54,  1.23it/s] 19%|█▉        | 51/264 [00:44<02:56,  1.21it/s] 20%|█▉        | 52/264 [00:45<02:53,  1.22it/s] 20%|██        | 53/264 [00:46<02:53,  1.22it/s] 20%|██        | 54/264 [00:46<02:52,  1.21it/s] 21%|██        | 55/264 [00:47<02:52,  1.21it/s] 21%|██        | 56/264 [00:48<02:57,  1.17it/s] 22%|██▏       | 57/264 [00:49<02:58,  1.16it/s] 22%|██▏       | 58/264 [00:50<02:59,  1.15it/s] 22%|██▏       | 59/264 [00:51<02:56,  1.16it/s] 23%|██▎       | 60/264 [00:52<02:54,  1.17it/s] 23%|██▎       | 61/264 [00:52<02:51,  1.19it/s] 23%|██▎       | 62/264 [00:53<02:55,  1.15it/s] 24%|██▍       | 63/264 [00:54<02:56,  1.14it/s] 24%|██▍       | 64/264 [00:55<02:49,  1.18it/s] 25%|██▍       | 65/264 [00:56<02:50,  1.17it/s] 25%|██▌       | 66/264 [00:57<02:46,  1.19it/s] 25%|██▌       | 67/264 [00:58<02:49,  1.16it/s] 26%|██▌       | 68/264 [00:59<02:53,  1.13it/s] 26%|██▌       | 69/264 [00:59<02:49,  1.15it/s] 27%|██▋       | 70/264 [01:00<02:46,  1.17it/s] 27%|██▋       | 71/264 [01:01<02:42,  1.18it/s] 27%|██▋       | 72/264 [01:02<02:39,  1.21it/s] 28%|██▊       | 73/264 [01:03<02:37,  1.21it/s] 28%|██▊       | 74/264 [01:03<02:36,  1.22it/s] 28%|██▊       | 75/264 [01:04<02:34,  1.22it/s] 29%|██▉       | 76/264 [01:05<02:36,  1.20it/s] 29%|██▉       | 77/264 [01:06<02:35,  1.20it/s] 30%|██▉       | 78/264 [01:07<02:33,  1.21it/s] 30%|██▉       | 79/264 [01:08<02:32,  1.22it/s] 30%|███       | 80/264 [01:08<02:31,  1.21it/s] 31%|███       | 81/264 [01:09<02:36,  1.17it/s] 31%|███       | 82/264 [01:10<02:34,  1.18it/s] 31%|███▏      | 83/264 [01:11<02:34,  1.17it/s] 32%|███▏      | 84/264 [01:12<02:33,  1.18it/s] 32%|███▏      | 85/264 [01:13<02:31,  1.18it/s] 33%|███▎      | 86/264 [01:13<02:27,  1.21it/s] 33%|███▎      | 87/264 [01:14<02:29,  1.19it/s] 33%|███▎      | 88/264 [01:15<02:26,  1.20it/s] 34%|███▎      | 89/264 [01:16<02:26,  1.20it/s] 34%|███▍      | 90/264 [01:17<02:29,  1.16it/s] 34%|███▍      | 91/264 [01:18<02:31,  1.14it/s] 35%|███▍      | 92/264 [01:19<02:26,  1.18it/s] 35%|███▌      | 93/264 [01:19<02:23,  1.19it/s] 36%|███▌      | 94/264 [01:20<02:24,  1.17it/s] 36%|███▌      | 95/264 [01:21<02:23,  1.18it/s] 36%|███▋      | 96/264 [01:22<02:19,  1.21it/s] 37%|███▋      | 97/264 [01:23<02:23,  1.16it/s] 37%|███▋      | 98/264 [01:24<02:23,  1.16it/s] 38%|███▊      | 99/264 [01:25<02:22,  1.16it/s] 38%|███▊      | 100/264 [01:25<02:20,  1.17it/s] 38%|███▊      | 101/264 [01:26<02:20,  1.16it/s] 39%|███▊      | 102/264 [01:27<02:23,  1.13it/s] 39%|███▉      | 103/264 [01:28<02:18,  1.16it/s] 39%|███▉      | 104/264 [01:29<02:17,  1.16it/s] 40%|███▉      | 105/264 [01:30<02:15,  1.18it/s] 40%|████      | 106/264 [01:31<02:11,  1.21it/s] 41%|████      | 107/264 [01:31<02:09,  1.21it/s] 41%|████      | 108/264 [01:32<02:08,  1.21it/s] 41%|████▏     | 109/264 [01:33<02:16,  1.13it/s] 42%|████▏     | 110/264 [01:34<02:12,  1.16it/s] 42%|████▏     | 111/264 [01:35<02:08,  1.19it/s] 42%|████▏     | 112/264 [01:36<02:13,  1.14it/s] 43%|████▎     | 113/264 [01:37<02:08,  1.18it/s] 43%|████▎     | 114/264 [01:37<02:06,  1.18it/s] 44%|████▎     | 115/264 [01:38<02:04,  1.20it/s] 44%|████▍     | 116/264 [01:39<02:03,  1.20it/s] 44%|████▍     | 117/264 [01:40<02:01,  1.21it/s] 45%|████▍     | 118/264 [01:41<02:00,  1.21it/s] 45%|████▌     | 119/264 [01:42<02:05,  1.16it/s] 45%|████▌     | 120/264 [01:43<02:09,  1.11it/s] 46%|████▌     | 121/264 [01:43<02:06,  1.13it/s] 46%|████▌     | 122/264 [01:44<02:03,  1.15it/s] 47%|████▋     | 123/264 [01:45<02:04,  1.14it/s] 47%|████▋     | 124/264 [01:46<02:01,  1.15it/s] 47%|████▋     | 125/264 [01:47<01:58,  1.17it/s] 48%|████▊     | 126/264 [01:48<01:56,  1.18it/s] 48%|████▊     | 127/264 [01:49<01:54,  1.19it/s] 48%|████▊     | 128/264 [01:49<01:52,  1.21it/s] 49%|████▉     | 129/264 [01:50<01:52,  1.20it/s] 49%|████▉     | 130/264 [01:51<01:50,  1.21it/s] 50%|████▉     | 131/264 [01:52<01:52,  1.18it/s] 50%|█████     | 132/264 [01:53<01:55,  1.15it/s] 50%|█████     | 133/264 [01:54<01:54,  1.15it/s] 51%|█████     | 134/264 [01:54<01:50,  1.17it/s] 51%|█████     | 135/264 [01:55<01:52,  1.14it/s] 52%|█████▏    | 136/264 [01:56<01:49,  1.17it/s] 52%|█████▏    | 137/264 [01:57<01:51,  1.14it/s] 52%|█████▏    | 138/264 [01:58<01:48,  1.16it/s] 53%|█████▎    | 139/264 [01:59<01:50,  1.13it/s] 53%|█████▎    | 140/264 [02:00<01:48,  1.14it/s] 53%|█████▎    | 141/264 [02:01<01:45,  1.17it/s] 54%|█████▍    | 142/264 [02:02<01:49,  1.12it/s] 54%|█████▍    | 143/264 [02:02<01:44,  1.15it/s] 55%|█████▍    | 144/264 [02:03<01:44,  1.14it/s] 55%|█████▍    | 145/264 [02:04<01:42,  1.16it/s] 55%|█████▌    | 146/264 [02:05<01:39,  1.18it/s] 56%|█████▌    | 147/264 [02:06<01:36,  1.21it/s] 56%|█████▌    | 148/264 [02:06<01:35,  1.22it/s] 56%|█████▋    | 149/264 [02:07<01:34,  1.21it/s] 57%|█████▋    | 150/264 [02:08<01:33,  1.22it/s] 57%|█████▋    | 151/264 [02:09<01:32,  1.22it/s] 58%|█████▊    | 152/264 [02:10<01:34,  1.19it/s] 58%|█████▊    | 153/264 [02:11<01:35,  1.17it/s] 58%|█████▊    | 154/264 [02:12<01:34,  1.16it/s] 59%|█████▊    | 155/264 [02:12<01:32,  1.18it/s] 59%|█████▉    | 156/264 [02:13<01:33,  1.15it/s] 59%|█████▉    | 157/264 [02:14<01:30,  1.18it/s] 60%|█████▉    | 158/264 [02:15<01:29,  1.19it/s] 60%|██████    | 159/264 [02:16<01:29,  1.17it/s] 61%|██████    | 160/264 [02:17<01:28,  1.18it/s] 61%|██████    | 161/264 [02:17<01:25,  1.20it/s] 61%|██████▏   | 162/264 [02:18<01:27,  1.17it/s] 62%|██████▏   | 163/264 [02:19<01:25,  1.18it/s] 62%|██████▏   | 164/264 [02:20<01:29,  1.12it/s] 62%|██████▎   | 165/264 [02:21<01:26,  1.14it/s] 63%|██████▎   | 166/264 [02:22<01:24,  1.17it/s] 63%|██████▎   | 167/264 [02:23<01:22,  1.17it/s] 64%|██████▎   | 168/264 [02:23<01:20,  1.19it/s] 64%|██████▍   | 169/264 [02:24<01:18,  1.21it/s] 64%|██████▍   | 170/264 [02:25<01:17,  1.21it/s] 65%|██████▍   | 171/264 [02:26<01:16,  1.21it/s] 65%|██████▌   | 172/264 [02:27<01:14,  1.23it/s] 66%|██████▌   | 173/264 [02:28<01:14,  1.21it/s] 66%|██████▌   | 174/264 [02:28<01:14,  1.22it/s] 66%|██████▋   | 175/264 [02:29<01:14,  1.19it/s] 67%|██████▋   | 176/264 [02:30<01:13,  1.20it/s] 67%|██████▋   | 177/264 [02:31<01:11,  1.21it/s] 67%|██████▋   | 178/264 [02:32<01:10,  1.22it/s] 68%|██████▊   | 179/264 [02:33<01:09,  1.22it/s] 68%|██████▊   | 180/264 [02:33<01:10,  1.19it/s] 69%|██████▊   | 181/264 [02:34<01:08,  1.20it/s] 69%|██████▉   | 182/264 [02:35<01:07,  1.22it/s] 69%|██████▉   | 183/264 [02:36<01:09,  1.17it/s] 70%|██████▉   | 184/264 [02:37<01:07,  1.18it/s] 70%|███████   | 185/264 [02:38<01:06,  1.18it/s] 70%|███████   | 186/264 [02:39<01:06,  1.17it/s] 71%|███████   | 187/264 [02:39<01:07,  1.13it/s] 71%|███████   | 188/264 [02:40<01:05,  1.17it/s] 72%|███████▏  | 189/264 [02:41<01:03,  1.17it/s] 72%|███████▏  | 190/264 [02:42<01:04,  1.14it/s] 72%|███████▏  | 191/264 [02:43<01:02,  1.18it/s] 73%|███████▎  | 192/264 [02:44<01:01,  1.17it/s] 73%|███████▎  | 193/264 [02:45<01:01,  1.15it/s] 73%|███████▎  | 194/264 [02:45<00:59,  1.18it/s] 74%|███████▍  | 195/264 [02:46<01:00,  1.15it/s] 74%|███████▍  | 196/264 [02:47<00:58,  1.17it/s] 75%|███████▍  | 197/264 [02:48<00:58,  1.15it/s] 75%|███████▌  | 198/264 [02:49<00:56,  1.16it/s] 75%|███████▌  | 199/264 [02:50<00:54,  1.19it/s] 76%|███████▌  | 200/264 [02:50<00:53,  1.20it/s] 76%|███████▌  | 201/264 [02:51<00:52,  1.21it/s] 77%|███████▋  | 202/264 [02:52<00:51,  1.20it/s] 77%|███████▋  | 203/264 [02:53<00:50,  1.21it/s] 77%|███████▋  | 204/264 [02:54<00:50,  1.18it/s] 78%|███████▊  | 205/264 [02:55<00:51,  1.16it/s] 78%|███████▊  | 206/264 [02:56<00:49,  1.17it/s] 78%|███████▊  | 207/264 [02:57<00:49,  1.14it/s] 79%|███████▉  | 208/264 [02:57<00:48,  1.16it/s] 79%|███████▉  | 209/264 [02:58<00:46,  1.18it/s] 80%|███████▉  | 210/264 [02:59<00:45,  1.20it/s] 80%|███████▉  | 211/264 [03:00<00:43,  1.21it/s] 80%|████████  | 212/264 [03:01<00:42,  1.22it/s] 81%|████████  | 213/264 [03:01<00:41,  1.22it/s] 81%|████████  | 214/264 [03:02<00:40,  1.22it/s] 81%|████████▏ | 215/264 [03:03<00:41,  1.18it/s] 82%|████████▏ | 216/264 [03:04<00:41,  1.15it/s] 82%|████████▏ | 217/264 [03:05<00:40,  1.17it/s] 83%|████████▎ | 218/264 [03:06<00:38,  1.18it/s] 83%|████████▎ | 219/264 [03:07<00:37,  1.19it/s] 83%|████████▎ | 220/264 [03:07<00:37,  1.19it/s] 84%|████████▎ | 221/264 [03:08<00:35,  1.20it/s] 84%|████████▍ | 222/264 [03:09<00:34,  1.21it/s] 84%|████████▍ | 223/264 [03:10<00:33,  1.22it/s] 85%|████████▍ | 224/264 [03:11<00:32,  1.22it/s] 85%|████████▌ | 225/264 [03:12<00:33,  1.17it/s] 86%|████████▌ | 226/264 [03:12<00:32,  1.19it/s] 86%|████████▌ | 227/264 [03:13<00:30,  1.20it/s] 86%|████████▋ | 228/264 [03:14<00:29,  1.21it/s] 87%|████████▋ | 229/264 [03:15<00:28,  1.21it/s] 87%|████████▋ | 230/264 [03:16<00:28,  1.21it/s] 88%|████████▊ | 231/264 [03:16<00:27,  1.21it/s] 88%|████████▊ | 232/264 [03:17<00:26,  1.22it/s] 88%|████████▊ | 233/264 [03:18<00:26,  1.17it/s] 89%|████████▊ | 234/264 [03:19<00:25,  1.17it/s] 89%|████████▉ | 235/264 [03:20<00:24,  1.17it/s] 89%|████████▉ | 236/264 [03:21<00:24,  1.15it/s] 90%|████████▉ | 237/264 [03:22<00:23,  1.16it/s] 90%|█████████ | 238/264 [03:23<00:22,  1.17it/s] 91%|█████████ | 239/264 [03:23<00:21,  1.18it/s] 91%|█████████ | 240/264 [03:24<00:20,  1.18it/s] 91%|█████████▏| 241/264 [03:25<00:19,  1.19it/s] 92%|█████████▏| 242/264 [03:26<00:18,  1.20it/s] 92%|█████████▏| 243/264 [03:27<00:17,  1.21it/s] 92%|█████████▏| 244/264 [03:27<00:16,  1.21it/s] 93%|█████████▎| 245/264 [03:28<00:15,  1.22it/s] 93%|█████████▎| 246/264 [03:29<00:14,  1.22it/s] 94%|█████████▎| 247/264 [03:30<00:13,  1.22it/s] 94%|█████████▍| 248/264 [03:31<00:13,  1.23it/s] 94%|█████████▍| 249/264 [03:32<00:12,  1.18it/s] 95%|█████████▍| 250/264 [03:32<00:11,  1.18it/s] 95%|█████████▌| 251/264 [03:33<00:10,  1.19it/s] 95%|█████████▌| 252/264 [03:34<00:10,  1.17it/s] 96%|█████████▌| 253/264 [03:35<00:09,  1.19it/s] 96%|█████████▌| 254/264 [03:36<00:08,  1.19it/s] 97%|█████████▋| 255/264 [03:37<00:07,  1.19it/s] 97%|█████████▋| 256/264 [03:38<00:06,  1.20it/s] 97%|█████████▋| 257/264 [03:38<00:05,  1.22it/s] 98%|█████████▊| 258/264 [03:39<00:04,  1.21it/s] 98%|█████████▊| 259/264 [03:40<00:04,  1.23it/s] 98%|█████████▊| 260/264 [03:41<00:03,  1.23it/s] 99%|█████████▉| 261/264 [03:41<00:02,  1.26it/s] 99%|█████████▉| 262/264 [03:42<00:01,  1.31it/s]100%|█████████▉| 263/264 [03:43<00:00,  1.33it/s]100%|██████████| 264/264 [03:44<00:00,  1.36it/s]100%|██████████| 264/264 [03:44<00:00,  1.18it/s]Save Model
Save current model ...
[Error] Traceback (most recent call last):
  File "train.py", line 346, in train
    save_model(model, best_model, current_model, best_loss, loss, opt.saved_model_path, step, opt.compound_coef)
  File "train.py", line 439, in save_model
    torch.save(model, model_path)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 328, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 401, in _legacy_save
    pickler.dump(obj)
AttributeError: Can't pickle local object 'train.<locals>.ModelWithLoss'

Can't pickle local object 'train.<locals>.ModelWithLoss'
Step: 300. Epoch: 1/30. Iteration: 37/264. Cls loss: 33105.48438. Reg loss: 0.05776. Total loss: 33105.54297
Step 300: Current Classification Loss:33105.484375; Current Regression Loss:0.057764; Current Loss:33105.542969;              Average Classification Loss:28164.746622; Average Regression Loss:0.179091; Average Loss:28164.925781; Current Learning Rate:0.000100.
Save Model
Save current model ...
[Error] Traceback (most recent call last):
  File "train.py", line 346, in train
    save_model(model, best_model, current_model, best_loss, loss, opt.saved_model_path, step, opt.compound_coef)
  File "train.py", line 439, in save_model
    torch.save(model.module.model.state_dict(), model_path)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 328, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 401, in _legacy_save
    pickler.dump(obj)
AttributeError: Can't pickle local object 'train.<locals>.ModelWithLoss'

Can't pickle local object 'train.<locals>.ModelWithLoss'
Step: 400. Epoch: 1/30. Iteration: 137/264. Cls loss: 26209.11328. Reg loss: 0.49029. Total loss: 26209.60352
Step 400: Current Classification Loss:26209.113281; Current Regression Loss:0.490287; Current Loss:26209.603516;              Average Classification Loss:26800.183252; Average Regression Loss:0.193680; Average Loss:26800.376967; Current Learning Rate:0.000100.
Save Model
Save current model ...
[Error] Traceback (most recent call last):
  File "train.py", line 346, in train
    save_model(model, best_model, current_model, best_loss, loss, opt.saved_model_path, step, opt.compound_coef)
  File "train.py", line 439, in save_model
    torch.save(model.module.model.state_dict(), model_path)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 328, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 401, in _legacy_save
    pickler.dump(obj)
AttributeError: Can't pickle local object 'train.<locals>.ModelWithLoss'

Can't pickle local object 'train.<locals>.ModelWithLoss'
Step: 500. Epoch: 1/30. Iteration: 237/264. Cls loss: 13227.46484. Reg loss: 0.59245. Total loss: 13228.05762
Step 500: Current Classification Loss:13227.464844; Current Regression Loss:0.592454; Current Loss:13228.057617;              Average Classification Loss:23882.718837; Average Regression Loss:0.184204; Average Loss:23882.903067; Current Learning Rate:0.000100.

  0%|          | 0/264 [00:00<?, ?it/s]Val. Epoch: 1/30. Classification loss: 7397.18450. Regression loss: 0.09852. Total loss: 7397.28303
--------------------------------------------After Epoch 1------------------------------------------------
Step 528: Validation Classification Loss:7397.184503; Regression Loss:0.098525; Total Loss:7397.283028
----------------------------------------------------------------------------------------------------------
  0%|          | 1/264 [00:01<08:25,  1.92s/it]  1%|          | 2/264 [00:02<07:03,  1.62s/it]  1%|          | 3/264 [00:03<06:09,  1.41s/it]  2%|▏         | 4/264 [00:04<05:35,  1.29s/it]  2%|▏         | 5/264 [00:05<05:06,  1.18s/it]  2%|▏         | 6/264 [00:06<04:41,  1.09s/it]  3%|▎         | 7/264 [00:07<04:23,  1.03s/it]  3%|▎         | 8/264 [00:08<04:04,  1.04it/s]  3%|▎         | 9/264 [00:09<03:53,  1.09it/s]  4%|▍         | 10/264 [00:09<03:45,  1.13it/s]  4%|▍         | 11/264 [00:10<03:47,  1.11it/s]  5%|▍         | 12/264 [00:11<03:40,  1.14it/s]  5%|▍         | 13/264 [00:12<03:33,  1.17it/s]  5%|▌         | 14/264 [00:13<03:36,  1.15it/s]  6%|▌         | 15/264 [00:14<03:36,  1.15it/s]  6%|▌         | 16/264 [00:15<03:35,  1.15it/s]  6%|▋         | 17/264 [00:15<03:36,  1.14it/s]  7%|▋         | 18/264 [00:16<03:38,  1.13it/s]  7%|▋         | 19/264 [00:17<03:40,  1.11it/s]  8%|▊         | 20/264 [00:18<03:33,  1.14it/s]  8%|▊         | 21/264 [00:19<03:31,  1.15it/s]  8%|▊         | 22/264 [00:20<03:25,  1.18it/s]  9%|▊         | 23/264 [00:21<03:27,  1.16it/s]  9%|▉         | 24/264 [00:22<03:24,  1.18it/s]  9%|▉         | 25/264 [00:22<03:26,  1.16it/s] 10%|▉         | 26/264 [00:23<03:26,  1.15it/s] 10%|█         | 27/264 [00:24<03:24,  1.16it/s] 11%|█         | 28/264 [00:25<03:23,  1.16it/s] 11%|█         | 29/264 [00:26<03:18,  1.19it/s] 11%|█▏        | 30/264 [00:27<03:16,  1.19it/s] 12%|█▏        | 31/264 [00:27<03:14,  1.20it/s] 12%|█▏        | 32/264 [00:28<03:15,  1.19it/s] 12%|█▎        | 33/264 [00:29<03:12,  1.20it/s] 13%|█▎        | 34/264 [00:30<03:14,  1.18it/s] 13%|█▎        | 35/264 [00:31<03:12,  1.19it/s] 14%|█▎        | 36/264 [00:32<03:09,  1.20it/s] 14%|█▍        | 37/264 [00:32<03:09,  1.20it/s] 14%|█▍        | 38/264 [00:33<03:07,  1.21it/s] 15%|█▍        | 39/264 [00:34<03:06,  1.20it/s] 15%|█▌        | 40/264 [00:35<03:12,  1.17it/s] 16%|█▌        | 41/264 [00:36<03:10,  1.17it/s] 16%|█▌        | 42/264 [00:37<03:12,  1.15it/s] 16%|█▋        | 43/264 [00:38<03:15,  1.13it/s] 17%|█▋        | 44/264 [00:39<03:14,  1.13it/s] 17%|█▋        | 45/264 [00:39<03:10,  1.15it/s] 17%|█▋        | 46/264 [00:40<03:13,  1.13it/s] 18%|█▊        | 47/264 [00:41<03:11,  1.13it/s] 18%|█▊        | 48/264 [00:42<03:09,  1.14it/s] 19%|█▊        | 49/264 [00:43<03:03,  1.17it/s] 19%|█▉        | 50/264 [00:44<02:58,  1.20it/s] 19%|█▉        | 51/264 [00:44<02:55,  1.22it/s] 20%|█▉        | 52/264 [00:45<02:55,  1.21it/s] 20%|██        | 53/264 [00:46<02:53,  1.22it/s] 20%|██        | 54/264 [00:47<02:55,  1.20it/s] 21%|██        | 55/264 [00:48<02:54,  1.20it/s] 21%|██        | 56/264 [00:49<02:52,  1.21it/s] 22%|██▏       | 57/264 [00:49<02:49,  1.22it/s] 22%|██▏       | 58/264 [00:50<02:48,  1.22it/s] 22%|██▏       | 59/264 [00:51<02:47,  1.22it/s] 23%|██▎       | 60/264 [00:52<02:45,  1.23it/s] 23%|██▎       | 61/264 [00:53<02:45,  1.23it/s] 23%|██▎       | 62/264 [00:53<02:44,  1.23it/s] 24%|██▍       | 63/264 [00:54<02:43,  1.23it/s] 24%|██▍       | 64/264 [00:55<02:42,  1.23it/s] 25%|██▍       | 65/264 [00:56<02:45,  1.20it/s] 25%|██▌       | 66/264 [00:57<02:43,  1.21it/s] 25%|██▌       | 67/264 [00:58<02:42,  1.21it/s] 26%|██▌       | 68/264 [00:58<02:41,  1.21it/s] 26%|██▌       | 69/264 [00:59<02:45,  1.18it/s] 27%|██▋       | 70/264 [01:00<02:41,  1.20it/s] 27%|██▋       | 71/264 [01:01<02:39,  1.21it/s] 27%|██▋       | 72/264 [01:02<02:38,  1.21it/s] 28%|██▊       | 73/264 [01:03<02:36,  1.22it/s] 28%|██▊       | 74/264 [01:03<02:35,  1.22it/s] 28%|██▊       | 75/264 [01:04<02:33,  1.23it/s] 29%|██▉       | 76/264 [01:05<02:35,  1.21it/s] 29%|██▉       | 77/264 [01:06<02:34,  1.21it/s] 30%|██▉       | 78/264 [01:07<02:32,  1.22it/s] 30%|██▉       | 79/264 [01:08<02:39,  1.16it/s] 30%|███       | 80/264 [01:08<02:35,  1.19it/s] 31%|███       | 81/264 [01:09<02:37,  1.16it/s] 31%|███       | 82/264 [01:10<02:41,  1.13it/s] 31%|███▏      | 83/264 [01:11<02:36,  1.16it/s] 32%|███▏      | 84/264 [01:12<02:33,  1.17it/s] 32%|███▏      | 85/264 [01:13<02:31,  1.18it/s] 33%|███▎      | 86/264 [01:14<02:31,  1.18it/s] 33%|███▎      | 87/264 [01:15<02:30,  1.18it/s] 33%|███▎      | 88/264 [01:15<02:29,  1.17it/s] 34%|███▎      | 89/264 [01:16<02:31,  1.16it/s] 34%|███▍      | 90/264 [01:17<02:28,  1.17it/s] 34%|███▍      | 91/264 [01:18<02:24,  1.20it/s] 35%|███▍      | 92/264 [01:19<02:23,  1.20it/s] 35%|███▌      | 93/264 [01:20<02:21,  1.21it/s] 36%|███▌      | 94/264 [01:20<02:20,  1.21it/s] 36%|███▌      | 95/264 [01:21<02:19,  1.21it/s] 36%|███▋      | 96/264 [01:22<02:18,  1.21it/s] 37%|███▋      | 97/264 [01:23<02:16,  1.22it/s] 37%|███▋      | 98/264 [01:24<02:23,  1.15it/s] 38%|███▊      | 99/264 [01:25<02:20,  1.18it/s] 38%|███▊      | 100/264 [01:25<02:17,  1.20it/s] 38%|███▊      | 101/264 [01:26<02:15,  1.20it/s] 39%|███▊      | 102/264 [01:27<02:13,  1.22it/s] 39%|███▉      | 103/264 [01:28<02:11,  1.23it/s] 39%|███▉      | 104/264 [01:29<02:10,  1.23it/s] 40%|███▉      | 105/264 [01:29<02:09,  1.23it/s] 40%|████      | 106/264 [01:30<02:09,  1.22it/s] 41%|████      | 107/264 [01:31<02:14,  1.16it/s] 41%|████      | 108/264 [01:32<02:15,  1.15it/s] 41%|████▏     | 109/264 [01:33<02:13,  1.16it/s] 42%|████▏     | 110/264 [01:34<02:09,  1.19it/s] 42%|████▏     | 111/264 [01:35<02:07,  1.20it/s] 42%|████▏     | 112/264 [01:35<02:09,  1.18it/s] 43%|████▎     | 113/264 [01:36<02:11,  1.15it/s] 43%|████▎     | 114/264 [01:37<02:07,  1.18it/s] 44%|████▎     | 115/264 [01:38<02:06,  1.18it/s] 44%|████▍     | 116/264 [01:39<02:06,  1.17it/s] 44%|████▍     | 117/264 [01:40<02:02,  1.20it/s] 45%|████▍     | 118/264 [01:40<02:01,  1.20it/s] 45%|████▌     | 119/264 [01:41<01:58,  1.23it/s] 45%|████▌     | 120/264 [01:42<02:04,  1.16it/s] 46%|████▌     | 121/264 [01:43<02:01,  1.18it/s] 46%|████▌     | 122/264 [01:44<02:03,  1.15it/s] 47%|████▋     | 123/264 [01:45<02:01,  1.16it/s] 47%|████▋     | 124/264 [01:46<01:58,  1.18it/s] 47%|████▋     | 125/264 [01:46<01:55,  1.20it/s] 48%|████▊     | 126/264 [01:47<01:53,  1.22it/s] 48%|████▊     | 127/264 [01:48<01:53,  1.20it/s] 48%|████▊     | 128/264 [01:49<01:51,  1.22it/s] 49%|████▉     | 129/264 [01:50<01:55,  1.17it/s] 49%|████▉     | 130/264 [01:51<01:52,  1.19it/s] 50%|████▉     | 131/264 [01:51<01:53,  1.18it/s] 50%|█████     | 132/264 [01:52<01:50,  1.20it/s] 50%|█████     | 133/264 [01:53<01:49,  1.20it/s] 51%|█████     | 134/264 [01:54<01:49,  1.19it/s] 51%|█████     | 135/264 [01:55<01:49,  1.18it/s] 52%|█████▏    | 136/264 [01:56<01:48,  1.18it/s] 52%|█████▏    | 137/264 [01:57<01:49,  1.16it/s] 52%|█████▏    | 138/264 [01:57<01:47,  1.17it/s] 53%|█████▎    | 139/264 [01:58<01:45,  1.19it/s] 53%|█████▎    | 140/264 [01:59<01:41,  1.22it/s] 53%|█████▎    | 141/264 [02:00<01:41,  1.21it/s] 54%|█████▍    | 142/264 [02:01<01:41,  1.21it/s] 54%|█████▍    | 143/264 [02:02<01:40,  1.20it/s] 55%|█████▍    | 144/264 [02:02<01:39,  1.21it/s] 55%|█████▍    | 145/264 [02:03<01:38,  1.21it/s] 55%|█████▌    | 146/264 [02:04<01:36,  1.22it/s] 56%|█████▌    | 147/264 [02:05<01:35,  1.22it/s] 56%|█████▌    | 148/264 [02:06<01:35,  1.22it/s] 56%|█████▋    | 149/264 [02:06<01:34,  1.22it/s] 57%|█████▋    | 150/264 [02:07<01:33,  1.22it/s] 57%|█████▋    | 151/264 [02:08<01:33,  1.21it/s] 58%|█████▊    | 152/264 [02:09<01:32,  1.21it/s] 58%|█████▊    | 153/264 [02:10<01:32,  1.20it/s] 58%|█████▊    | 154/264 [02:11<01:30,  1.22it/s] 59%|█████▊    | 155/264 [02:11<01:28,  1.23it/s] 59%|█████▉    | 156/264 [02:12<01:27,  1.24it/s] 59%|█████▉    | 157/264 [02:13<01:26,  1.24it/s] 60%|█████▉    | 158/264 [02:14<01:25,  1.23it/s] 60%|██████    | 159/264 [02:15<01:25,  1.23it/s] 61%|██████    | 160/264 [02:15<01:27,  1.18it/s] 61%|██████    | 161/264 [02:16<01:28,  1.16it/s] 61%|██████▏   | 162/264 [02:17<01:25,  1.19it/s] 62%|██████▏   | 163/264 [02:18<01:23,  1.21it/s] 62%|██████▏   | 164/264 [02:19<01:23,  1.20it/s] 62%|██████▎   | 165/264 [02:20<01:21,  1.21it/s] 63%|██████▎   | 166/264 [02:20<01:20,  1.22it/s] 63%|██████▎   | 167/264 [02:21<01:20,  1.21it/s] 64%|██████▎   | 168/264 [02:22<01:18,  1.22it/s] 64%|██████▍   | 169/264 [02:23<01:17,  1.23it/s] 64%|██████▍   | 170/264 [02:24<01:16,  1.23it/s] 65%|██████▍   | 171/264 [02:25<01:15,  1.23it/s] 65%|██████▌   | 172/264 [02:25<01:17,  1.18it/s] 66%|██████▌   | 173/264 [02:26<01:16,  1.18it/s] 66%|██████▌   | 174/264 [02:27<01:17,  1.16it/s] 66%|██████▋   | 175/264 [02:28<01:16,  1.17it/s] 67%|██████▋   | 176/264 [02:29<01:16,  1.16it/s] 67%|██████▋   | 177/264 [02:30<01:14,  1.17it/s] 67%|██████▋   | 178/264 [02:31<01:12,  1.19it/s] 68%|██████▊   | 179/264 [02:31<01:10,  1.21it/s] 68%|██████▊   | 180/264 [02:32<01:12,  1.17it/s] 69%|██████▊   | 181/264 [02:33<01:09,  1.19it/s] 69%|██████▉   | 182/264 [02:34<01:09,  1.18it/s] 69%|██████▉   | 183/264 [02:35<01:09,  1.16it/s] 70%|██████▉   | 184/264 [02:36<01:08,  1.17it/s] 70%|███████   | 185/264 [02:37<01:07,  1.17it/s] 70%|███████   | 186/264 [02:37<01:06,  1.17it/s] 71%|███████   | 187/264 [02:38<01:06,  1.16it/s] 71%|███████   | 188/264 [02:39<01:04,  1.18it/s] 72%|███████▏  | 189/264 [02:40<01:05,  1.15it/s] 72%|███████▏  | 190/264 [02:41<01:02,  1.18it/s] 72%|███████▏  | 191/264 [02:42<01:01,  1.19it/s] 73%|███████▎  | 192/264 [02:42<01:00,  1.19it/s] 73%|███████▎  | 193/264 [02:43<01:00,  1.18it/s] 73%|███████▎  | 194/264 [02:44<00:58,  1.19it/s] 74%|███████▍  | 195/264 [02:45<00:59,  1.17it/s] 74%|███████▍  | 196/264 [02:46<00:57,  1.18it/s] 75%|███████▍  | 197/264 [02:47<00:58,  1.15it/s] 75%|███████▌  | 198/264 [02:48<00:55,  1.19it/s] 75%|███████▌  | 199/264 [02:48<00:54,  1.20it/s] 76%|███████▌  | 200/264 [02:49<00:52,  1.21it/s] 76%|███████▌  | 201/264 [02:50<00:53,  1.17it/s] 77%|███████▋  | 202/264 [02:51<00:52,  1.19it/s] 77%|███████▋  | 203/264 [02:52<00:53,  1.15it/s] 77%|███████▋  | 204/264 [02:53<00:51,  1.17it/s] 78%|███████▊  | 205/264 [02:54<00:52,  1.13it/s] 78%|███████▊  | 206/264 [02:54<00:49,  1.17it/s] 78%|███████▊  | 207/264 [02:55<00:49,  1.15it/s] 79%|███████▉  | 208/264 [02:56<00:50,  1.11it/s] 79%|███████▉  | 209/264 [02:57<00:48,  1.13it/s] 80%|███████▉  | 210/264 [02:58<00:46,  1.15it/s] 80%|███████▉  | 211/264 [02:59<00:46,  1.14it/s] 80%|████████  | 212/264 [03:00<00:44,  1.16it/s] 81%|████████  | 213/264 [03:01<00:43,  1.18it/s] 81%|████████  | 214/264 [03:01<00:43,  1.15it/s] 81%|████████▏ | 215/264 [03:02<00:41,  1.17it/s] 82%|████████▏ | 216/264 [03:03<00:40,  1.18it/s] 82%|████████▏ | 217/264 [03:04<00:39,  1.20it/s] 83%|████████▎ | 218/264 [03:05<00:38,  1.21it/s] 83%|████████▎ | 219/264 [03:06<00:37,  1.19it/s] 83%|████████▎ | 220/264 [03:06<00:36,  1.20it/s] 84%|████████▎ | 221/264 [03:07<00:35,  1.21it/s] 84%|████████▍ | 222/264 [03:08<00:34,  1.21it/s] 84%|████████▍ | 223/264 [03:09<00:33,  1.23it/s] 85%|████████▍ | 224/264 [03:10<00:32,  1.22it/s] 85%|████████▌ | 225/264 [03:10<00:31,  1.23it/s] 86%|████████▌ | 226/264 [03:11<00:31,  1.19it/s] 86%|████████▌ | 227/264 [03:12<00:31,  1.18it/s] 86%|████████▋ | 228/264 [03:13<00:31,  1.14it/s] 87%|████████▋ | 229/264 [03:14<00:29,  1.17it/s] 87%|████████▋ | 230/264 [03:15<00:29,  1.16it/s] 88%|████████▊ | 231/264 [03:16<00:28,  1.17it/s] 88%|████████▊ | 232/264 [03:17<00:27,  1.15it/s] 88%|████████▊ | 233/264 [03:17<00:26,  1.17it/s] 89%|████████▊ | 234/264 [03:18<00:25,  1.19it/s] 89%|████████▉ | 235/264 [03:19<00:24,  1.16it/s] 89%|████████▉ | 236/264 [03:20<00:24,  1.14it/s] 90%|████████▉ | 237/264 [03:21<00:23,  1.17it/s] 90%|█████████ | 238/264 [03:22<00:21,  1.21it/s] 91%|█████████ | 239/264 [03:22<00:21,  1.18it/s] 91%|█████████ | 240/264 [03:23<00:20,  1.16it/s] 91%|█████████▏| 241/264 [03:24<00:19,  1.15it/s] 92%|█████████▏| 242/264 [03:25<00:19,  1.14it/s] 92%|█████████▏| 243/264 [03:26<00:18,  1.13it/s] 92%|█████████▏| 244/264 [03:27<00:17,  1.15it/s] 93%|█████████▎| 245/264 [03:28<00:16,  1.17it/s] 93%|█████████▎| 246/264 [03:29<00:15,  1.15it/s] 94%|█████████▎| 247/264 [03:29<00:14,  1.16it/s] 94%|█████████▍| 248/264 [03:30<00:13,  1.18it/s] 94%|█████████▍| 249/264 [03:31<00:12,  1.16it/s] 95%|█████████▍| 250/264 [03:32<00:11,  1.18it/s] 95%|█████████▌| 251/264 [03:33<00:10,  1.20it/s] 95%|█████████▌| 252/264 [03:34<00:09,  1.20it/s] 96%|█████████▌| 253/264 [03:35<00:09,  1.18it/s] 96%|█████████▌| 254/264 [03:35<00:08,  1.20it/s] 97%|█████████▋| 255/264 [03:36<00:07,  1.16it/s] 97%|█████████▋| 256/264 [03:37<00:06,  1.17it/s] 97%|█████████▋| 257/264 [03:38<00:05,  1.17it/s] 98%|█████████▊| 258/264 [03:39<00:05,  1.15it/s] 98%|█████████▊| 259/264 [03:40<00:04,  1.15it/s] 98%|█████████▊| 260/264 [03:41<00:03,  1.15it/s] 99%|█████████▉| 261/264 [03:41<00:02,  1.21it/s] 99%|█████████▉| 262/264 [03:42<00:01,  1.27it/s]100%|█████████▉| 263/264 [03:43<00:00,  1.30it/s]100%|██████████| 264/264 [03:43<00:00,  1.33it/s]100%|██████████| 264/264 [03:43<00:00,  1.18it/s]Save Model
Save current model ...
[Error] Traceback (most recent call last):
  File "train.py", line 346, in train
    best_model, best_loss, current_model = \
  File "train.py", line 439, in save_model
    model_path = os.path.join(save_dir, current_model)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 328, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 401, in _legacy_save
    pickler.dump(obj)
AttributeError: Can't pickle local object 'train.<locals>.ModelWithLoss'

Can't pickle local object 'train.<locals>.ModelWithLoss'
Step: 600. Epoch: 2/30. Iteration: 73/264. Cls loss: 15055.36914. Reg loss: 0.04464. Total loss: 15055.41406
Step 600: Current Classification Loss:15055.369141; Current Regression Loss:0.044642; Current Loss:15055.414062;              Average Classification Loss:14241.387929; Average Regression Loss:0.160579; Average Loss:14241.548561; Current Learning Rate:0.000100.
Save Model
Save current model ...
[Error] Traceback (most recent call last):
  File "train.py", line 346, in train
    best_model, best_loss, current_model = \
  File "train.py", line 439, in save_model
    model_path = os.path.join(save_dir, current_model)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 328, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 401, in _legacy_save
    pickler.dump(obj)
AttributeError: Can't pickle local object 'train.<locals>.ModelWithLoss'

Can't pickle local object 'train.<locals>.ModelWithLoss'
Step: 700. Epoch: 2/30. Iteration: 173/264. Cls loss: 5809.02881. Reg loss: 0.08196. Total loss: 5809.11084
Step 700: Current Classification Loss:5809.028809; Current Regression Loss:0.081959; Current Loss:5809.110840;              Average Classification Loss:12040.771696; Average Regression Loss:0.163927; Average Loss:12040.935632; Current Learning Rate:0.000100.

  0%|          | 0/264 [00:00<?, ?it/s]Val. Epoch: 2/30. Classification loss: 2849.46612. Regression loss: 0.11131. Total loss: 2849.57743
--------------------------------------------After Epoch 2------------------------------------------------
Step 792: Validation Classification Loss:2849.466119; Regression Loss:0.111313; Total Loss:2849.577432
----------------------------------------------------------------------------------------------------------
  0%|          | 1/264 [00:01<08:19,  1.90s/it]  1%|          | 2/264 [00:02<07:01,  1.61s/it]  1%|          | 3/264 [00:03<06:00,  1.38s/it]  2%|▏         | 4/264 [00:04<05:22,  1.24s/it]  2%|▏         | 5/264 [00:05<04:51,  1.13s/it]  2%|▏         | 6/264 [00:06<04:25,  1.03s/it]  3%|▎         | 7/264 [00:07<04:12,  1.02it/s]  3%|▎         | 8/264 [00:07<03:58,  1.07it/s]  3%|▎         | 9/264 [00:08<04:03,  1.05it/s]  4%|▍         | 10/264 [00:09<03:52,  1.09it/s]  4%|▍         | 11/264 [00:10<03:43,  1.13it/s]  5%|▍         | 12/264 [00:11<03:38,  1.15it/s]  5%|▍         | 13/264 [00:12<03:33,  1.17it/s]  5%|▌         | 14/264 [00:13<03:29,  1.19it/s]  6%|▌         | 15/264 [00:13<03:26,  1.20it/s]  6%|▌         | 16/264 [00:14<03:38,  1.14it/s]  6%|▋         | 17/264 [00:15<03:40,  1.12it/s]  7%|▋         | 18/264 [00:16<03:33,  1.15it/s]  7%|▋         | 19/264 [00:17<03:35,  1.14it/s]  8%|▊         | 20/264 [00:18<03:28,  1.17it/s]  8%|▊         | 21/264 [00:19<03:39,  1.11it/s]  8%|▊         | 22/264 [00:20<03:32,  1.14it/s]  9%|▊         | 23/264 [00:20<03:28,  1.16it/s]  9%|▉         | 24/264 [00:21<03:22,  1.19it/s]  9%|▉         | 25/264 [00:22<03:21,  1.19it/s] 10%|▉         | 26/264 [00:23<03:27,  1.15it/s] 10%|█         | 27/264 [00:24<03:24,  1.16it/s] 11%|█         | 28/264 [00:25<03:20,  1.18it/s] 11%|█         | 29/264 [00:25<03:16,  1.20it/s] 11%|█▏        | 30/264 [00:26<03:21,  1.16it/s] 12%|█▏        | 31/264 [00:27<03:26,  1.13it/s] 12%|█▏        | 32/264 [00:28<03:24,  1.13it/s] 12%|█▎        | 33/264 [00:29<03:16,  1.17it/s] 13%|█▎        | 34/264 [00:30<03:12,  1.20it/s] 13%|█▎        | 35/264 [00:31<03:10,  1.20it/s] 14%|█▎        | 36/264 [00:31<03:08,  1.21it/s] 14%|█▍        | 37/264 [00:32<03:17,  1.15it/s] 14%|█▍        | 38/264 [00:33<03:14,  1.16it/s] 15%|█▍        | 39/264 [00:34<03:16,  1.14it/s] 15%|█▌        | 40/264 [00:35<03:18,  1.13it/s] 16%|█▌        | 41/264 [00:36<03:18,  1.12it/s] 16%|█▌        | 42/264 [00:37<03:11,  1.16it/s] 16%|█▋        | 43/264 [00:38<03:17,  1.12it/s] 17%|█▋        | 44/264 [00:39<03:11,  1.15it/s] 17%|█▋        | 45/264 [00:39<03:12,  1.14it/s] 17%|█▋        | 46/264 [00:40<03:06,  1.17it/s] 18%|█▊        | 47/264 [00:41<03:02,  1.19it/s] 18%|█▊        | 48/264 [00:42<03:00,  1.20it/s] 19%|█▊        | 49/264 [00:43<02:57,  1.21it/s] 19%|█▉        | 50/264 [00:43<02:55,  1.22it/s] 19%|█▉        | 51/264 [00:44<02:54,  1.22it/s] 20%|█▉        | 52/264 [00:45<02:53,  1.22it/s] 20%|██        | 53/264 [00:46<03:01,  1.16it/s] 20%|██        | 54/264 [00:47<02:59,  1.17it/s] 21%|██        | 55/264 [00:48<02:59,  1.17it/s] 21%|██        | 56/264 [00:49<03:02,  1.14it/s] 22%|██▏       | 57/264 [00:50<02:57,  1.16it/s] 22%|██▏       | 58/264 [00:50<02:52,  1.20it/s] 22%|██▏       | 59/264 [00:51<02:50,  1.20it/s] 23%|██▎       | 60/264 [00:52<02:48,  1.21it/s] 23%|██▎       | 61/264 [00:53<02:54,  1.16it/s] 23%|██▎       | 62/264 [00:54<02:49,  1.19it/s] 24%|██▍       | 63/264 [00:55<02:59,  1.12it/s] 24%|██▍       | 64/264 [00:55<02:53,  1.15it/s] 25%|██▍       | 65/264 [00:56<02:52,  1.15it/s] 25%|██▌       | 66/264 [00:57<02:46,  1.19it/s] 25%|██▌       | 67/264 [00:58<02:44,  1.19it/s] 26%|██▌       | 68/264 [00:59<02:42,  1.21it/s] 26%|██▌       | 69/264 [01:00<02:47,  1.16it/s] 27%|██▋       | 70/264 [01:01<02:44,  1.18it/s] 27%|██▋       | 71/264 [01:01<02:41,  1.19it/s] 27%|██▋       | 72/264 [01:02<02:38,  1.21it/s] 28%|██▊       | 73/264 [01:03<02:37,  1.22it/s] 28%|██▊       | 74/264 [01:04<02:41,  1.17it/s] 28%|██▊       | 75/264 [01:05<02:42,  1.16it/s] 29%|██▉       | 76/264 [01:06<02:44,  1.14it/s] 29%|██▉       | 77/264 [01:06<02:39,  1.17it/s] 30%|██▉       | 78/264 [01:07<02:36,  1.19it/s] 30%|██▉       | 79/264 [01:08<02:41,  1.14it/s] 30%|███       | 80/264 [01:09<02:38,  1.16it/s] 31%|███       | 81/264 [01:10<02:36,  1.17it/s] 31%|███       | 82/264 [01:11<02:31,  1.20it/s] 31%|███▏      | 83/264 [01:12<02:30,  1.20it/s] 32%|███▏      | 84/264 [01:12<02:33,  1.17it/s] 32%|███▏      | 85/264 [01:13<02:35,  1.15it/s] 33%|███▎      | 86/264 [01:14<02:34,  1.16it/s] 33%|███▎      | 87/264 [01:15<02:32,  1.16it/s] 33%|███▎      | 88/264 [01:16<02:32,  1.16it/s] 34%|███▎      | 89/264 [01:17<02:28,  1.18it/s] 34%|███▍      | 90/264 [01:18<02:25,  1.20it/s] 34%|███▍      | 91/264 [01:18<02:27,  1.17it/s] 35%|███▍      | 92/264 [01:19<02:28,  1.16it/s] 35%|███▌      | 93/264 [01:20<02:29,  1.14it/s] 36%|███▌      | 94/264 [01:21<02:31,  1.12it/s] 36%|███▌      | 95/264 [01:22<02:26,  1.16it/s] 36%|███▋      | 96/264 [01:23<02:23,  1.17it/s] 37%|███▋      | 97/264 [01:24<02:20,  1.19it/s] 37%|███▋      | 98/264 [01:24<02:20,  1.18it/s] 38%|███▊      | 99/264 [01:25<02:18,  1.19it/s] 38%|███▊      | 100/264 [01:26<02:17,  1.19it/s] 38%|███▊      | 101/264 [01:27<02:14,  1.21it/s] 39%|███▊      | 102/264 [01:28<02:14,  1.21it/s] 39%|███▉      | 103/264 [01:29<02:11,  1.22it/s] 39%|███▉      | 104/264 [01:29<02:12,  1.21it/s] 40%|███▉      | 105/264 [01:30<02:11,  1.21it/s] 40%|████      | 106/264 [01:31<02:09,  1.22it/s] 41%|████      | 107/264 [01:32<02:09,  1.22it/s] 41%|████      | 108/264 [01:33<02:07,  1.22it/s] 41%|████▏     | 109/264 [01:34<02:09,  1.20it/s] 42%|████▏     | 110/264 [01:34<02:07,  1.21it/s] 42%|████▏     | 111/264 [01:35<02:06,  1.21it/s] 42%|████▏     | 112/264 [01:36<02:10,  1.17it/s] 43%|████▎     | 113/264 [01:37<02:06,  1.19it/s] 43%|████▎     | 114/264 [01:38<02:04,  1.21it/s] 44%|████▎     | 115/264 [01:38<02:02,  1.22it/s] 44%|████▍     | 116/264 [01:39<02:01,  1.21it/s] 44%|████▍     | 117/264 [01:40<02:00,  1.22it/s] 45%|████▍     | 118/264 [01:41<02:00,  1.21it/s] 45%|████▌     | 119/264 [01:42<01:58,  1.22it/s] 45%|████▌     | 120/264 [01:43<02:00,  1.19it/s] 46%|████▌     | 121/264 [01:44<02:03,  1.16it/s] 46%|████▌     | 122/264 [01:44<02:00,  1.18it/s] 47%|████▋     | 123/264 [01:45<02:01,  1.16it/s] 47%|████▋     | 124/264 [01:46<02:02,  1.15it/s] 47%|████▋     | 125/264 [01:47<02:02,  1.14it/s] 48%|████▊     | 126/264 [01:48<02:03,  1.12it/s] 48%|████▊     | 127/264 [01:49<01:58,  1.16it/s] 48%|████▊     | 128/264 [01:50<02:00,  1.13it/s] 49%|████▉     | 129/264 [01:51<01:57,  1.15it/s] 49%|████▉     | 130/264 [01:51<01:54,  1.17it/s] 50%|████▉     | 131/264 [01:52<01:52,  1.18it/s] 50%|█████     | 132/264 [01:53<01:55,  1.14it/s] 50%|█████     | 133/264 [01:54<01:55,  1.13it/s] 51%|█████     | 134/264 [01:55<01:51,  1.17it/s] 51%|█████     | 135/264 [01:56<01:48,  1.19it/s] 52%|█████▏    | 136/264 [01:56<01:47,  1.19it/s] 52%|█████▏    | 137/264 [01:57<01:45,  1.21it/s] 52%|█████▏    | 138/264 [01:58<01:43,  1.22it/s] 53%|█████▎    | 139/264 [01:59<01:42,  1.22it/s] 53%|█████▎    | 140/264 [02:00<01:41,  1.23it/s] 53%|█████▎    | 141/264 [02:00<01:39,  1.24it/s] 54%|█████▍    | 142/264 [02:01<01:40,  1.21it/s] 54%|█████▍    | 143/264 [02:02<01:39,  1.22it/s] 55%|█████▍    | 144/264 [02:03<01:38,  1.22it/s] 55%|█████▍    | 145/264 [02:04<01:37,  1.22it/s] 55%|█████▌    | 146/264 [02:05<01:36,  1.23it/s] 56%|█████▌    | 147/264 [02:06<01:39,  1.18it/s] 56%|█████▌    | 148/264 [02:06<01:36,  1.20it/s] 56%|█████▋    | 149/264 [02:07<01:38,  1.16it/s] 57%|█████▋    | 150/264 [02:08<01:35,  1.19it/s] 57%|█████▋    | 151/264 [02:09<01:34,  1.20it/s] 58%|█████▊    | 152/264 [02:10<01:32,  1.21it/s] 58%|█████▊    | 153/264 [02:11<01:31,  1.21it/s] 58%|█████▊    | 154/264 [02:11<01:30,  1.21it/s] 59%|█████▊    | 155/264 [02:12<01:29,  1.21it/s] 59%|█████▉    | 156/264 [02:13<01:28,  1.22it/s] 59%|█████▉    | 157/264 [02:14<01:27,  1.23it/s] 60%|█████▉    | 158/264 [02:15<01:26,  1.23it/s] 60%|██████    | 159/264 [02:15<01:25,  1.23it/s] 61%|██████    | 160/264 [02:16<01:24,  1.24it/s] 61%|██████    | 161/264 [02:17<01:23,  1.23it/s] 61%|██████▏   | 162/264 [02:18<01:26,  1.19it/s] 62%|██████▏   | 163/264 [02:19<01:24,  1.20it/s] 62%|██████▏   | 164/264 [02:20<01:30,  1.10it/s] 62%|██████▎   | 165/264 [02:21<01:26,  1.14it/s] 63%|██████▎   | 166/264 [02:21<01:25,  1.15it/s] 63%|██████▎   | 167/264 [02:22<01:22,  1.17it/s] 64%|██████▎   | 168/264 [02:23<01:22,  1.16it/s] 64%|██████▍   | 169/264 [02:24<01:20,  1.17it/s] 64%|██████▍   | 170/264 [02:25<01:18,  1.19it/s] 65%|██████▍   | 171/264 [02:26<01:20,  1.16it/s] 65%|██████▌   | 172/264 [02:27<01:17,  1.18it/s] 66%|██████▌   | 173/264 [02:27<01:16,  1.19it/s] 66%|██████▌   | 174/264 [02:28<01:14,  1.21it/s] 66%|██████▋   | 175/264 [02:29<01:21,  1.09it/s] 67%|██████▋   | 176/264 [02:30<01:18,  1.12it/s] 67%|██████▋   | 177/264 [02:31<01:17,  1.13it/s] 67%|██████▋   | 178/264 [02:32<01:14,  1.16it/s] 68%|██████▊   | 179/264 [02:33<01:13,  1.15it/s] 68%|██████▊   | 180/264 [02:34<01:11,  1.17it/s] 69%|██████▊   | 181/264 [02:34<01:09,  1.20it/s] 69%|██████▉   | 182/264 [02:35<01:07,  1.21it/s] 69%|██████▉   | 183/264 [02:36<01:06,  1.22it/s] 70%|██████▉   | 184/264 [02:37<01:08,  1.17it/s] 70%|███████   | 185/264 [02:38<01:09,  1.14it/s] 70%|███████   | 186/264 [02:39<01:08,  1.14it/s] 71%|███████   | 187/264 [02:39<01:05,  1.17it/s] 71%|███████   | 188/264 [02:40<01:07,  1.13it/s] 72%|███████▏  | 189/264 [02:41<01:04,  1.16it/s] 72%|███████▏  | 190/264 [02:42<01:05,  1.14it/s] 72%|███████▏  | 191/264 [02:43<01:05,  1.12it/s] 73%|███████▎  | 192/264 [02:44<01:04,  1.12it/s] 73%|███████▎  | 193/264 [02:45<01:03,  1.12it/s] 73%|███████▎  | 194/264 [02:46<01:00,  1.15it/s] 74%|███████▍  | 195/264 [02:47<01:00,  1.13it/s] 74%|███████▍  | 196/264 [02:47<00:58,  1.17it/s] 75%|███████▍  | 197/264 [02:48<00:57,  1.17it/s] 75%|███████▌  | 198/264 [02:49<00:55,  1.19it/s] 75%|███████▌  | 199/264 [02:50<00:54,  1.20it/s] 76%|███████▌  | 200/264 [02:51<00:55,  1.16it/s] 76%|███████▌  | 201/264 [02:52<00:54,  1.16it/s] 77%|███████▋  | 202/264 [02:53<00:53,  1.16it/s] 77%|███████▋  | 203/264 [02:53<00:52,  1.17it/s] 77%|███████▋  | 204/264 [02:54<00:50,  1.19it/s] 78%|███████▊  | 205/264 [02:55<00:49,  1.20it/s] 78%|███████▊  | 206/264 [02:56<00:48,  1.20it/s] 78%|███████▊  | 207/264 [02:57<00:48,  1.17it/s] 79%|███████▉  | 208/264 [02:58<00:50,  1.10it/s] 79%|███████▉  | 209/264 [02:59<00:49,  1.12it/s] 80%|███████▉  | 210/264 [03:00<00:48,  1.11it/s] 80%|███████▉  | 211/264 [03:00<00:48,  1.09it/s] 80%|████████  | 212/264 [03:01<00:45,  1.13it/s] 81%|████████  | 213/264 [03:02<00:44,  1.15it/s] 81%|████████  | 214/264 [03:03<00:42,  1.17it/s] 81%|████████▏ | 215/264 [03:04<00:43,  1.13it/s] 82%|████████▏ | 216/264 [03:05<00:41,  1.15it/s] 82%|████████▏ | 217/264 [03:06<00:39,  1.18it/s] 83%|████████▎ | 218/264 [03:06<00:39,  1.17it/s] 83%|████████▎ | 219/264 [03:07<00:38,  1.15it/s] 83%|████████▎ | 220/264 [03:08<00:37,  1.16it/s] 84%|████████▎ | 221/264 [03:09<00:36,  1.19it/s] 84%|████████▍ | 222/264 [03:10<00:35,  1.19it/s] 84%|████████▍ | 223/264 [03:11<00:34,  1.20it/s] 85%|████████▍ | 224/264 [03:11<00:33,  1.20it/s] 85%|████████▌ | 225/264 [03:12<00:33,  1.15it/s] 86%|████████▌ | 226/264 [03:13<00:32,  1.17it/s] 86%|████████▌ | 227/264 [03:14<00:30,  1.20it/s] 86%|████████▋ | 228/264 [03:15<00:29,  1.21it/s] 87%|████████▋ | 229/264 [03:16<00:28,  1.21it/s] 87%|████████▋ | 230/264 [03:16<00:28,  1.19it/s] 88%|████████▊ | 231/264 [03:17<00:27,  1.20it/s] 88%|████████▊ | 232/264 [03:18<00:26,  1.20it/s] 88%|████████▊ | 233/264 [03:19<00:25,  1.20it/s] 89%|████████▊ | 234/264 [03:20<00:24,  1.20it/s] 89%|████████▉ | 235/264 [03:21<00:24,  1.20it/s] 89%|████████▉ | 236/264 [03:21<00:23,  1.22it/s] 90%|████████▉ | 237/264 [03:22<00:22,  1.22it/s] 90%|█████████ | 238/264 [03:23<00:22,  1.15it/s] 91%|█████████ | 239/264 [03:24<00:21,  1.18it/s] 91%|█████████ | 240/264 [03:25<00:20,  1.18it/s] 91%|█████████▏| 241/264 [03:26<00:20,  1.15it/s] 92%|█████████▏| 242/264 [03:27<00:19,  1.14it/s] 92%|█████████▏| 243/264 [03:28<00:18,  1.14it/s] 92%|█████████▏| 244/264 [03:28<00:17,  1.16it/s] 93%|█████████▎| 245/264 [03:29<00:16,  1.18it/s] 93%|█████████▎| 246/264 [03:30<00:15,  1.19it/s] 94%|█████████▎| 247/264 [03:31<00:14,  1.20it/s] 94%|█████████▍| 248/264 [03:32<00:13,  1.22it/s] 94%|█████████▍| 249/264 [03:32<00:12,  1.22it/s] 95%|█████████▍| 250/264 [03:33<00:11,  1.22it/s] 95%|█████████▌| 251/264 [03:34<00:10,  1.22it/s] 95%|█████████▌| 252/264 [03:35<00:10,  1.15it/s] 96%|█████████▌| 253/264 [03:36<00:09,  1.15it/s] 96%|█████████▌| 254/264 [03:37<00:08,  1.11it/s] 97%|█████████▋| 255/264 [03:38<00:07,  1.15it/s] 97%|█████████▋| 256/264 [03:39<00:07,  1.13it/s] 97%|█████████▋| 257/264 [03:39<00:05,  1.17it/s] 98%|█████████▊| 258/264 [03:40<00:05,  1.14it/s] 98%|█████████▊| 259/264 [03:41<00:04,  1.15it/s] 98%|█████████▊| 260/264 [03:42<00:03,  1.17it/s] 99%|█████████▉| 261/264 [03:43<00:02,  1.22it/s] 99%|█████████▉| 262/264 [03:43<00:01,  1.27it/s]100%|█████████▉| 263/264 [03:44<00:00,  1.30it/s]100%|██████████| 264/264 [03:45<00:00,  1.33it/s]100%|██████████| 264/264 [03:45<00:00,  1.17it/s]Save Model
Save current model ...
[Error] Traceback (most recent call last):
  File "train.py", line 346, in train
    best_model, best_loss, current_model = \
  File "train.py", line 439, in save_model
    model_path = os.path.join(save_dir, current_model)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 328, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 401, in _legacy_save
    pickler.dump(obj)
AttributeError: Can't pickle local object 'train.<locals>.ModelWithLoss'

Can't pickle local object 'train.<locals>.ModelWithLoss'
Step: 800. Epoch: 3/30. Iteration: 9/264. Cls loss: 4680.29102. Reg loss: 0.05468. Total loss: 4680.34570
Step 800: Current Classification Loss:4680.291016; Current Regression Loss:0.054680; Current Loss:4680.345703;              Average Classification Loss:5685.833008; Average Regression Loss:0.079350; Average Loss:5685.912299; Current Learning Rate:0.000100.
Save Model
Save current model ...
[Error] Traceback (most recent call last):
  File "train.py", line 346, in train
    best_model, best_loss, current_model = \
  File "train.py", line 439, in save_model
    model_path = os.path.join(save_dir, current_model)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 328, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 401, in _legacy_save
    pickler.dump(obj)
AttributeError: Can't pickle local object 'train.<locals>.ModelWithLoss'

Can't pickle local object 'train.<locals>.ModelWithLoss'
Step: 900. Epoch: 3/30. Iteration: 109/264. Cls loss: 3837.13062. Reg loss: 0.06247. Total loss: 3837.19312
Step 900: Current Classification Loss:3837.130615; Current Regression Loss:0.062467; Current Loss:3837.193115;              Average Classification Loss:4757.047086; Average Regression Loss:0.120822; Average Loss:4757.167916; Current Learning Rate:0.000100.
Save Model
Save current model ...
[Error] Traceback (most recent call last):
  File "train.py", line 346, in train
    best_model, best_loss, current_model = \
  File "train.py", line 439, in save_model
    model_path = os.path.join(save_dir, current_model)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 328, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 401, in _legacy_save
    pickler.dump(obj)
AttributeError: Can't pickle local object 'train.<locals>.ModelWithLoss'

Can't pickle local object 'train.<locals>.ModelWithLoss'
Step: 1000. Epoch: 3/30. Iteration: 209/264. Cls loss: 2384.22314. Reg loss: 0.14430. Total loss: 2384.36743
Step 1000: Current Classification Loss:2384.223145; Current Regression Loss:0.144298; Current Loss:2384.367432;              Average Classification Loss:3958.025181; Average Regression Loss:0.116434; Average Loss:3958.141613; Current Learning Rate:0.000100.

  0%|          | 0/264 [00:00<?, ?it/s]Val. Epoch: 3/30. Classification loss: 1111.93030. Regression loss: 0.07884. Total loss: 1112.00915
--------------------------------------------After Epoch 3------------------------------------------------
Step 1056: Validation Classification Loss:1111.930303; Regression Loss:0.078843; Total Loss:1112.009146
----------------------------------------------------------------------------------------------------------
  0%|          | 1/264 [00:01<08:41,  1.98s/it]  1%|          | 2/264 [00:02<07:15,  1.66s/it]  1%|          | 3/264 [00:03<06:18,  1.45s/it]  2%|▏         | 4/264 [00:04<05:36,  1.29s/it]  2%|▏         | 5/264 [00:05<05:19,  1.24s/it]  2%|▏         | 6/264 [00:06<04:58,  1.16s/it]  3%|▎         | 7/264 [00:07<04:31,  1.06s/it]  3%|▎         | 8/264 [00:08<04:12,  1.01it/s]  3%|▎         | 9/264 [00:09<04:04,  1.04it/s]  4%|▍         | 10/264 [00:10<03:55,  1.08it/s]  4%|▍         | 11/264 [00:11<03:45,  1.12it/s]  5%|▍         | 12/264 [00:11<03:39,  1.15it/s]  5%|▍         | 13/264 [00:12<03:35,  1.17it/s]  5%|▌         | 14/264 [00:13<03:31,  1.18it/s]  6%|▌         | 15/264 [00:14<03:28,  1.19it/s]  6%|▌         | 16/264 [00:15<03:25,  1.21it/s]  6%|▋         | 17/264 [00:16<03:26,  1.20it/s]  7%|▋         | 18/264 [00:16<03:24,  1.20it/s]  7%|▋         | 19/264 [00:17<03:25,  1.19it/s]  8%|▊         | 20/264 [00:18<03:22,  1.21it/s]  8%|▊         | 21/264 [00:19<03:23,  1.19it/s]  8%|▊         | 22/264 [00:20<03:20,  1.21it/s]  9%|▊         | 23/264 [00:21<03:31,  1.14it/s]  9%|▉         | 24/264 [00:22<03:34,  1.12it/s]  9%|▉         | 25/264 [00:22<03:31,  1.13it/s] 10%|▉         | 26/264 [00:23<03:35,  1.10it/s] 10%|█         | 27/264 [00:24<03:25,  1.15it/s] 11%|█         | 28/264 [00:25<03:21,  1.17it/s] 11%|█         | 29/264 [00:26<03:16,  1.19it/s] 11%|█▏        | 30/264 [00:27<03:14,  1.21it/s] 12%|█▏        | 31/264 [00:27<03:11,  1.22it/s] 12%|█▏        | 32/264 [00:28<03:25,  1.13it/s] 12%|█▎        | 33/264 [00:29<03:26,  1.12it/s] 13%|█▎        | 34/264 [00:30<03:26,  1.11it/s] 13%|█▎        | 35/264 [00:31<03:29,  1.09it/s] 14%|█▎        | 36/264 [00:32<03:28,  1.09it/s] 14%|█▍        | 37/264 [00:33<03:31,  1.07it/s] 14%|█▍        | 38/264 [00:34<03:27,  1.09it/s] 15%|█▍        | 39/264 [00:35<03:22,  1.11it/s] 15%|█▌        | 40/264 [00:36<03:20,  1.11it/s] 16%|█▌        | 41/264 [00:37<03:17,  1.13it/s] 16%|█▌        | 42/264 [00:38<03:18,  1.12it/s] 16%|█▋        | 43/264 [00:38<03:21,  1.10it/s] 17%|█▋        | 44/264 [00:39<03:18,  1.11it/s] 17%|█▋        | 45/264 [00:40<03:18,  1.10it/s] 17%|█▋        | 46/264 [00:41<03:15,  1.11it/s] 18%|█▊        | 47/264 [00:42<03:08,  1.15it/s] 18%|█▊        | 48/264 [00:43<03:11,  1.13it/s] 19%|█▊        | 49/264 [00:44<03:18,  1.08it/s] 19%|█▉        | 50/264 [00:45<03:10,  1.12it/s] 19%|█▉        | 51/264 [00:46<03:07,  1.14it/s] 20%|█▉        | 52/264 [00:46<03:09,  1.12it/s] 20%|██        | 53/264 [00:47<03:03,  1.15it/s] 20%|██        | 54/264 [00:48<03:02,  1.15it/s] 21%|██        | 55/264 [00:49<02:58,  1.17it/s] 21%|██        | 56/264 [00:50<03:02,  1.14it/s] 22%|██▏       | 57/264 [00:51<03:10,  1.09it/s] 22%|██▏       | 58/264 [00:52<03:18,  1.04it/s] 22%|██▏       | 59/264 [00:53<03:14,  1.06it/s] 23%|██▎       | 60/264 [00:54<03:04,  1.11it/s] 23%|██▎       | 61/264 [00:55<02:59,  1.13it/s] 23%|██▎       | 62/264 [00:55<02:54,  1.16it/s] 24%|██▍       | 63/264 [00:56<02:58,  1.12it/s] 24%|██▍       | 64/264 [00:57<02:56,  1.14it/s] 25%|██▍       | 65/264 [00:58<03:00,  1.10it/s] 25%|██▌       | 66/264 [00:59<02:52,  1.15it/s] 25%|██▌       | 67/264 [01:00<02:48,  1.17it/s] 26%|██▌       | 68/264 [01:01<02:47,  1.17it/s] 26%|██▌       | 69/264 [01:01<02:44,  1.19it/s] 27%|██▋       | 70/264 [01:02<02:41,  1.20it/s] 27%|██▋       | 71/264 [01:03<02:41,  1.20it/s] 27%|██▋       | 72/264 [01:04<02:39,  1.20it/s] 28%|██▊       | 73/264 [01:05<02:41,  1.18it/s] 28%|██▊       | 74/264 [01:06<02:38,  1.20it/s] 28%|██▊       | 75/264 [01:07<02:43,  1.15it/s] 29%|██▉       | 76/264 [01:07<02:48,  1.11it/s] 29%|██▉       | 77/264 [01:08<02:42,  1.15it/s] 30%|██▉       | 78/264 [01:09<02:38,  1.17it/s] 30%|██▉       | 79/264 [01:10<02:43,  1.13it/s] 30%|███       | 80/264 [01:11<02:37,  1.17it/s] 31%|███       | 81/264 [01:12<02:34,  1.18it/s] 31%|███       | 82/264 [01:13<02:39,  1.14it/s] 31%|███▏      | 83/264 [01:13<02:35,  1.17it/s] 32%|███▏      | 84/264 [01:14<02:32,  1.18it/s] 32%|███▏      | 85/264 [01:15<02:29,  1.20it/s] 33%|███▎      | 86/264 [01:16<02:26,  1.21it/s] 33%|███▎      | 87/264 [01:17<02:26,  1.20it/s] 33%|███▎      | 88/264 [01:18<02:26,  1.20it/s] 34%|███▎      | 89/264 [01:18<02:23,  1.22it/s] 34%|███▍      | 90/264 [01:19<02:22,  1.22it/s] 34%|███▍      | 91/264 [01:20<02:22,  1.22it/s] 35%|███▍      | 92/264 [01:21<02:22,  1.20it/s] 35%|███▌      | 93/264 [01:22<02:26,  1.17it/s] 36%|███▌      | 94/264 [01:23<02:28,  1.14it/s] 36%|███▌      | 95/264 [01:24<02:27,  1.15it/s] 36%|███▋      | 96/264 [01:24<02:28,  1.13it/s] 37%|███▋      | 97/264 [01:25<02:26,  1.14it/s] 37%|███▋      | 98/264 [01:26<02:24,  1.15it/s] 38%|███▊      | 99/264 [01:27<02:20,  1.18it/s] 38%|███▊      | 100/264 [01:28<02:17,  1.19it/s] 38%|███▊      | 101/264 [01:29<02:17,  1.19it/s] 39%|███▊      | 102/264 [01:29<02:15,  1.20it/s] 39%|███▉      | 103/264 [01:30<02:13,  1.20it/s] 39%|███▉      | 104/264 [01:31<02:17,  1.16it/s] 40%|███▉      | 105/264 [01:32<02:17,  1.16it/s] 40%|████      | 106/264 [01:33<02:19,  1.14it/s] 41%|████      | 107/264 [01:34<02:16,  1.15it/s] 41%|████      | 108/264 [01:35<02:12,  1.18it/s] 41%|████▏     | 109/264 [01:36<02:18,  1.12it/s] 42%|████▏     | 110/264 [01:37<02:17,  1.12it/s] 42%|████▏     | 111/264 [01:37<02:17,  1.11it/s] 42%|████▏     | 112/264 [01:38<02:12,  1.15it/s] 43%|████▎     | 113/264 [01:39<02:08,  1.17it/s] 43%|████▎     | 114/264 [01:40<02:05,  1.19it/s] 44%|████▎     | 115/264 [01:41<02:04,  1.19it/s] 44%|████▍     | 116/264 [01:42<02:10,  1.14it/s] 44%|████▍     | 117/264 [01:42<02:06,  1.16it/s] 45%|████▍     | 118/264 [01:43<02:03,  1.18it/s] 45%|████▌     | 119/264 [01:44<02:02,  1.19it/s] 45%|████▌     | 120/264 [01:45<02:01,  1.18it/s] 46%|████▌     | 121/264 [01:46<01:58,  1.20it/s] 46%|████▌     | 122/264 [01:47<01:57,  1.21it/s] 47%|████▋     | 123/264 [01:47<01:55,  1.22it/s] 47%|████▋     | 124/264 [01:48<01:53,  1.23it/s] 47%|████▋     | 125/264 [01:49<01:54,  1.21it/s] 48%|████▊     | 126/264 [01:50<01:55,  1.19it/s] 48%|████▊     | 127/264 [01:51<01:53,  1.20it/s] 48%|████▊     | 128/264 [01:52<01:52,  1.21it/s] 49%|████▉     | 129/264 [01:53<01:59,  1.13it/s] 49%|████▉     | 130/264 [01:53<01:54,  1.17it/s] 50%|████▉     | 131/264 [01:54<01:55,  1.15it/s] 50%|█████     | 132/264 [01:55<01:52,  1.17it/s] 50%|█████     | 133/264 [01:56<01:50,  1.19it/s] 51%|█████     | 134/264 [01:57<01:52,  1.16it/s] 51%|█████     | 135/264 [01:58<01:53,  1.13it/s] 52%|█████▏    | 136/264 [01:59<01:53,  1.12it/s] 52%|█████▏    | 137/264 [02:00<01:53,  1.12it/s] 52%|█████▏    | 138/264 [02:00<01:52,  1.12it/s] 53%|█████▎    | 139/264 [02:01<01:49,  1.15it/s] 53%|█████▎    | 140/264 [02:02<01:50,  1.12it/s] 53%|█████▎    | 141/264 [02:03<01:51,  1.10it/s] 54%|█████▍    | 142/264 [02:04<01:49,  1.12it/s] 54%|█████▍    | 143/264 [02:05<01:48,  1.11it/s] 55%|█████▍    | 144/264 [02:06<01:48,  1.11it/s] 55%|█████▍    | 145/264 [02:07<01:46,  1.12it/s] 55%|█████▌    | 146/264 [02:08<01:43,  1.14it/s] 56%|█████▌    | 147/264 [02:08<01:41,  1.16it/s] 56%|█████▌    | 148/264 [02:09<01:38,  1.18it/s] 56%|█████▋    | 149/264 [02:10<01:36,  1.19it/s] 57%|█████▋    | 150/264 [02:11<01:45,  1.08it/s] 57%|█████▋    | 151/264 [02:12<01:48,  1.04it/s] 58%|█████▊    | 152/264 [02:13<01:45,  1.06it/s] 58%|█████▊    | 153/264 [02:14<01:43,  1.08it/s] 58%|█████▊    | 154/264 [02:15<01:42,  1.07it/s] 59%|█████▊    | 155/264 [02:16<01:38,  1.11it/s] 59%|█████▉    | 156/264 [02:17<01:35,  1.13it/s] 59%|█████▉    | 157/264 [02:17<01:31,  1.17it/s] 60%|█████▉    | 158/264 [02:18<01:30,  1.18it/s] 60%|██████    | 159/264 [02:19<01:29,  1.18it/s] 61%|██████    | 160/264 [02:20<01:27,  1.19it/s] 61%|██████    | 161/264 [02:21<01:26,  1.19it/s] 61%|██████▏   | 162/264 [02:22<01:25,  1.19it/s] 62%|██████▏   | 163/264 [02:22<01:25,  1.19it/s] 62%|██████▏   | 164/264 [02:23<01:24,  1.18it/s] 62%|██████▎   | 165/264 [02:24<01:23,  1.19it/s] 63%|██████▎   | 166/264 [02:25<01:21,  1.20it/s] 63%|██████▎   | 167/264 [02:26<01:25,  1.13it/s] 64%|██████▎   | 168/264 [02:27<01:27,  1.10it/s] 64%|██████▍   | 169/264 [02:28<01:24,  1.12it/s] 64%|██████▍   | 170/264 [02:29<01:22,  1.14it/s] 65%|██████▍   | 171/264 [02:30<01:23,  1.11it/s] 65%|██████▌   | 172/264 [02:30<01:22,  1.11it/s] 66%|██████▌   | 173/264 [02:31<01:23,  1.09it/s] 66%|██████▌   | 174/264 [02:32<01:20,  1.12it/s] 66%|██████▋   | 175/264 [02:33<01:18,  1.14it/s] 67%|██████▋   | 176/264 [02:34<01:16,  1.15it/s] 67%|██████▋   | 177/264 [02:35<01:16,  1.14it/s] 67%|██████▋   | 178/264 [02:36<01:13,  1.17it/s] 68%|██████▊   | 179/264 [02:37<01:16,  1.11it/s] 68%|██████▊   | 180/264 [02:37<01:13,  1.14it/s] 69%|██████▊   | 181/264 [02:38<01:11,  1.16it/s] 69%|██████▉   | 182/264 [02:39<01:10,  1.16it/s] 69%|██████▉   | 183/264 [02:40<01:08,  1.18it/s] 70%|██████▉   | 184/264 [02:41<01:07,  1.19it/s] 70%|███████   | 185/264 [02:42<01:08,  1.15it/s] 70%|███████   | 186/264 [02:43<01:09,  1.12it/s] 71%|███████   | 187/264 [02:44<01:08,  1.12it/s] 71%|███████   | 188/264 [02:44<01:07,  1.12it/s] 72%|███████▏  | 189/264 [02:45<01:05,  1.14it/s] 72%|███████▏  | 190/264 [02:46<01:03,  1.16it/s] 72%|███████▏  | 191/264 [02:47<01:01,  1.18it/s] 73%|███████▎  | 192/264 [02:48<01:00,  1.19it/s] 73%|███████▎  | 193/264 [02:49<00:59,  1.19it/s] 73%|███████▎  | 194/264 [02:49<00:58,  1.20it/s] 74%|███████▍  | 195/264 [02:50<00:57,  1.19it/s] 74%|███████▍  | 196/264 [02:51<00:57,  1.17it/s] 75%|███████▍  | 197/264 [02:52<00:57,  1.17it/s] 75%|███████▌  | 198/264 [02:53<00:56,  1.18it/s] 75%|███████▌  | 199/264 [02:54<00:54,  1.20it/s] 76%|███████▌  | 200/264 [02:54<00:53,  1.20it/s] 76%|███████▌  | 201/264 [02:55<00:54,  1.16it/s] 77%|███████▋  | 202/264 [02:56<00:55,  1.13it/s] 77%|███████▋  | 203/264 [02:57<00:54,  1.12it/s] 77%|███████▋  | 204/264 [02:58<00:53,  1.12it/s] 78%|███████▊  | 205/264 [02:59<00:53,  1.11it/s] 78%|███████▊  | 206/264 [03:00<00:51,  1.12it/s] 78%|███████▊  | 207/264 [03:01<00:49,  1.15it/s] 79%|███████▉  | 208/264 [03:02<00:48,  1.14it/s] 79%|███████▉  | 209/264 [03:03<00:49,  1.11it/s] 80%|███████▉  | 210/264 [03:04<00:49,  1.10it/s] 80%|███████▉  | 211/264 [03:05<00:50,  1.06it/s] 80%|████████  | 212/264 [03:05<00:48,  1.08it/s] 81%|████████  | 213/264 [03:06<00:46,  1.10it/s] 81%|████████  | 214/264 [03:07<00:45,  1.09it/s] 81%|████████▏ | 215/264 [03:08<00:44,  1.11it/s] 82%|████████▏ | 216/264 [03:09<00:43,  1.10it/s] 82%|████████▏ | 217/264 [03:10<00:41,  1.12it/s] 83%|████████▎ | 218/264 [03:11<00:39,  1.16it/s] 83%|████████▎ | 219/264 [03:12<00:38,  1.17it/s] 83%|████████▎ | 220/264 [03:12<00:37,  1.18it/s] 84%|████████▎ | 221/264 [03:13<00:37,  1.15it/s] 84%|████████▍ | 222/264 [03:14<00:36,  1.16it/s] 84%|████████▍ | 223/264 [03:15<00:35,  1.17it/s] 85%|████████▍ | 224/264 [03:16<00:35,  1.14it/s] 85%|████████▌ | 225/264 [03:17<00:33,  1.16it/s] 86%|████████▌ | 226/264 [03:18<00:32,  1.17it/s] 86%|████████▌ | 227/264 [03:18<00:31,  1.18it/s] 86%|████████▋ | 228/264 [03:19<00:30,  1.18it/s] 87%|████████▋ | 229/264 [03:20<00:29,  1.18it/s] 87%|████████▋ | 230/264 [03:21<00:28,  1.18it/s] 88%|████████▊ | 231/264 [03:22<00:27,  1.20it/s] 88%|████████▊ | 232/264 [03:23<00:27,  1.17it/s] 88%|████████▊ | 233/264 [03:23<00:26,  1.18it/s] 89%|████████▊ | 234/264 [03:24<00:25,  1.19it/s] 89%|████████▉ | 235/264 [03:25<00:24,  1.20it/s] 89%|████████▉ | 236/264 [03:26<00:23,  1.21it/s] 90%|████████▉ | 237/264 [03:27<00:22,  1.22it/s] 90%|█████████ | 238/264 [03:28<00:21,  1.21it/s] 91%|█████████ | 239/264 [03:29<00:21,  1.14it/s] 91%|█████████ | 240/264 [03:29<00:21,  1.13it/s] 91%|█████████▏| 241/264 [03:30<00:20,  1.12it/s] 92%|█████████▏| 242/264 [03:31<00:19,  1.15it/s] 92%|█████████▏| 243/264 [03:32<00:17,  1.18it/s] 92%|█████████▏| 244/264 [03:33<00:16,  1.19it/s] 93%|█████████▎| 245/264 [03:34<00:15,  1.19it/s] 93%|█████████▎| 246/264 [03:35<00:15,  1.14it/s] 94%|█████████▎| 247/264 [03:36<00:15,  1.13it/s] 94%|█████████▍| 248/264 [03:36<00:14,  1.11it/s] 94%|█████████▍| 249/264 [03:37<00:13,  1.08it/s] 95%|█████████▍| 250/264 [03:38<00:12,  1.11it/s] 95%|█████████▌| 251/264 [03:39<00:11,  1.14it/s] 95%|█████████▌| 252/264 [03:40<00:10,  1.14it/s] 96%|█████████▌| 253/264 [03:41<00:09,  1.13it/s] 96%|█████████▌| 254/264 [03:42<00:08,  1.13it/s] 97%|█████████▋| 255/264 [03:43<00:07,  1.15it/s] 97%|█████████▋| 256/264 [03:44<00:07,  1.12it/s] 97%|█████████▋| 257/264 [03:44<00:06,  1.10it/s] 98%|█████████▊| 258/264 [03:45<00:05,  1.13it/s] 98%|█████████▊| 259/264 [03:46<00:04,  1.16it/s] 98%|█████████▊| 260/264 [03:47<00:03,  1.18it/s] 99%|█████████▉| 261/264 [03:48<00:02,  1.22it/s] 99%|█████████▉| 262/264 [03:48<00:01,  1.27it/s]100%|█████████▉| 263/264 [03:49<00:00,  1.30it/s]100%|██████████| 264/264 [03:50<00:00,  1.33it/s]100%|██████████| 264/264 [03:50<00:00,  1.15it/s]Save Model
Save current model ...
[Error] Traceback (most recent call last):
  File "train.py", line 346, in train
    best_model, best_loss, current_model = \
  File "train.py", line 439, in save_model
    model_path = os.path.join(save_dir, current_model)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 328, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 401, in _legacy_save
    pickler.dump(obj)
AttributeError: Can't pickle local object 'train.<locals>.ModelWithLoss'

Can't pickle local object 'train.<locals>.ModelWithLoss'
Step: 1100. Epoch: 4/30. Iteration: 45/264. Cls loss: 2197.83594. Reg loss: 0.22452. Total loss: 2198.06055
Step 1100: Current Classification Loss:2197.835938; Current Regression Loss:0.224523; Current Loss:2198.060547;              Average Classification Loss:1827.632534; Average Regression Loss:0.116420; Average Loss:1827.748943; Current Learning Rate:0.000100.
Save Model
Save current model ...
[Error] Traceback (most recent call last):
  File "train.py", line 346, in train
    best_model, best_loss, current_model = \
  File "train.py", line 439, in save_model
    model_path = os.path.join(save_dir, current_model)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 328, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 401, in _legacy_save
    pickler.dump(obj)
AttributeError: Can't pickle local object 'train.<locals>.ModelWithLoss'

Can't pickle local object 'train.<locals>.ModelWithLoss'
Step: 1200. Epoch: 4/30. Iteration: 145/264. Cls loss: 880.64398. Reg loss: 0.12578. Total loss: 880.76978
Step 1200: Current Classification Loss:880.643982; Current Regression Loss:0.125780; Current Loss:880.769775;              Average Classification Loss:1647.475967; Average Regression Loss:0.108170; Average Loss:1647.584130; Current Learning Rate:0.000100.
Save Model
Save current model ...
[Error] Traceback (most recent call last):
  File "train.py", line 346, in train
    best_model, best_loss, current_model = \
  File "train.py", line 439, in save_model
    model_path = os.path.join(save_dir, current_model)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 328, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 401, in _legacy_save
    pickler.dump(obj)
AttributeError: Can't pickle local object 'train.<locals>.ModelWithLoss'

Can't pickle local object 'train.<locals>.ModelWithLoss'
Step: 1300. Epoch: 4/30. Iteration: 245/264. Cls loss: 803.56738. Reg loss: 0.07879. Total loss: 803.64618
Step 1300: Current Classification Loss:803.567383; Current Regression Loss:0.078794; Current Loss:803.646179;              Average Classification Loss:1404.723391; Average Regression Loss:0.105282; Average Loss:1404.828667; Current Learning Rate:0.000100.

  0%|          | 0/264 [00:00<?, ?it/s]Val. Epoch: 4/30. Classification loss: 498.11900. Regression loss: 0.07278. Total loss: 498.19178
--------------------------------------------After Epoch 4------------------------------------------------
Step 1320: Validation Classification Loss:498.119002; Regression Loss:0.072780; Total Loss:498.191782
----------------------------------------------------------------------------------------------------------
  0%|          | 1/264 [00:02<09:25,  2.15s/it]  1%|          | 2/264 [00:03<07:51,  1.80s/it]  1%|          | 3/264 [00:04<06:44,  1.55s/it]  2%|▏         | 4/264 [00:05<05:58,  1.38s/it]  2%|▏         | 5/264 [00:05<05:18,  1.23s/it]  2%|▏         | 6/264 [00:06<04:45,  1.11s/it]  3%|▎         | 7/264 [00:07<04:38,  1.08s/it]  3%|▎         | 8/264 [00:08<04:20,  1.02s/it]  3%|▎         | 9/264 [00:09<04:08,  1.03it/s]  4%|▍         | 10/264 [00:10<04:00,  1.06it/s]  4%|▍         | 11/264 [00:11<03:49,  1.10it/s]  5%|▍         | 12/264 [00:12<03:42,  1.13it/s]  5%|▍         | 13/264 [00:12<03:37,  1.16it/s]  5%|▌         | 14/264 [00:13<03:32,  1.17it/s]  6%|▌         | 15/264 [00:14<03:35,  1.15it/s]  6%|▌         | 16/264 [00:15<03:32,  1.17it/s]  6%|▋         | 17/264 [00:16<03:43,  1.11it/s]  7%|▋         | 18/264 [00:17<03:37,  1.13it/s]  7%|▋         | 19/264 [00:18<03:39,  1.11it/s]  8%|▊         | 20/264 [00:19<03:33,  1.14it/s]  8%|▊         | 21/264 [00:19<03:33,  1.14it/s]  8%|▊         | 22/264 [00:20<03:36,  1.12it/s]  9%|▊         | 23/264 [00:21<03:43,  1.08it/s]  9%|▉         | 24/264 [00:22<03:33,  1.13it/s]  9%|▉         | 25/264 [00:23<03:27,  1.15it/s] 10%|▉         | 26/264 [00:24<03:22,  1.17it/s] 10%|█         | 27/264 [00:25<03:25,  1.15it/s] 11%|█         | 28/264 [00:26<03:30,  1.12it/s] 11%|█         | 29/264 [00:26<03:23,  1.15it/s] 11%|█▏        | 30/264 [00:27<03:29,  1.11it/s] 12%|█▏        | 31/264 [00:28<03:22,  1.15it/s] 12%|█▏        | 32/264 [00:29<03:28,  1.11it/s] 12%|█▎        | 33/264 [00:30<03:23,  1.13it/s] 13%|█▎        | 34/264 [00:31<03:18,  1.16it/s] 13%|█▎        | 35/264 [00:32<03:22,  1.13it/s] 14%|█▎        | 36/264 [00:33<03:23,  1.12it/s] 14%|█▍        | 37/264 [00:34<03:20,  1.13it/s] 14%|█▍        | 38/264 [00:34<03:22,  1.12it/s] 15%|█▍        | 39/264 [00:35<03:18,  1.13it/s] 15%|█▌        | 40/264 [00:36<03:19,  1.12it/s] 16%|█▌        | 41/264 [00:37<03:14,  1.15it/s] 16%|█▌        | 42/264 [00:38<03:10,  1.16it/s] 16%|█▋        | 43/264 [00:39<03:10,  1.16it/s] 17%|█▋        | 44/264 [00:40<03:14,  1.13it/s] 17%|█▋        | 45/264 [00:41<03:14,  1.13it/s] 17%|█▋        | 46/264 [00:42<03:14,  1.12it/s] 18%|█▊        | 47/264 [00:42<03:15,  1.11it/s] 18%|█▊        | 48/264 [00:43<03:17,  1.09it/s] 19%|█▊        | 49/264 [00:44<03:17,  1.09it/s] 19%|█▉        | 50/264 [00:45<03:15,  1.10it/s] 19%|█▉        | 51/264 [00:46<03:12,  1.11it/s] 20%|█▉        | 52/264 [00:47<03:15,  1.09it/s] 20%|██        | 53/264 [00:48<03:10,  1.11it/s] 20%|██        | 54/264 [00:49<03:16,  1.07it/s] 21%|██        | 55/264 [00:50<03:15,  1.07it/s] 21%|██        | 56/264 [00:51<03:10,  1.09it/s] 22%|██▏       | 57/264 [00:52<03:07,  1.10it/s] 22%|██▏       | 58/264 [00:52<03:01,  1.13it/s] 22%|██▏       | 59/264 [00:53<02:57,  1.15it/s] 23%|██▎       | 60/264 [00:54<03:02,  1.12it/s] 23%|██▎       | 61/264 [00:55<02:57,  1.14it/s] 23%|██▎       | 62/264 [00:56<02:53,  1.17it/s] 24%|██▍       | 63/264 [00:57<02:48,  1.19it/s] 24%|██▍       | 64/264 [00:58<02:56,  1.13it/s] 25%|██▍       | 65/264 [00:59<02:53,  1.15it/s] 25%|██▌       | 66/264 [00:59<02:48,  1.17it/s] 25%|██▌       | 67/264 [01:00<02:55,  1.13it/s] 26%|██▌       | 68/264 [01:01<02:50,  1.15it/s] 26%|██▌       | 69/264 [01:02<02:48,  1.16it/s] 27%|██▋       | 70/264 [01:03<02:46,  1.17it/s] 27%|██▋       | 71/264 [01:04<02:50,  1.13it/s] 27%|██▋       | 72/264 [01:05<02:52,  1.11it/s] 28%|██▊       | 73/264 [01:06<02:50,  1.12it/s] 28%|██▊       | 74/264 [01:06<02:47,  1.14it/s] 28%|██▊       | 75/264 [01:07<02:41,  1.17it/s] 29%|██▉       | 76/264 [01:08<02:49,  1.11it/s] 29%|██▉       | 77/264 [01:09<02:47,  1.12it/s] 30%|██▉       | 78/264 [01:10<02:45,  1.13it/s] 30%|██▉       | 79/264 [01:11<02:43,  1.13it/s] 30%|███       | 80/264 [01:12<02:39,  1.15it/s] 31%|███       | 81/264 [01:13<02:43,  1.12it/s] 31%|███       | 82/264 [01:13<02:38,  1.15it/s] 31%|███▏      | 83/264 [01:14<02:40,  1.13it/s] 32%|███▏      | 84/264 [01:15<02:35,  1.16it/s] 32%|███▏      | 85/264 [01:16<02:40,  1.11it/s] 33%|███▎      | 86/264 [01:17<02:37,  1.13it/s] 33%|███▎      | 87/264 [01:18<02:38,  1.11it/s] 33%|███▎      | 88/264 [01:19<02:33,  1.14it/s] 34%|███▎      | 89/264 [01:20<02:36,  1.12it/s] 34%|███▍      | 90/264 [01:21<02:38,  1.10it/s] 34%|███▍      | 91/264 [01:22<02:37,  1.10it/s] 35%|███▍      | 92/264 [01:22<02:32,  1.13it/s] 35%|███▌      | 93/264 [01:23<02:29,  1.14it/s] 36%|███▌      | 94/264 [01:24<02:26,  1.16it/s] 36%|███▌      | 95/264 [01:25<02:30,  1.13it/s] 36%|███▋      | 96/264 [01:26<02:30,  1.12it/s] 37%|███▋      | 97/264 [01:27<02:25,  1.15it/s] 37%|███▋      | 98/264 [01:28<02:30,  1.11it/s] 38%|███▊      | 99/264 [01:29<02:27,  1.12it/s] 38%|███▊      | 100/264 [01:29<02:23,  1.14it/s] 38%|███▊      | 101/264 [01:30<02:20,  1.16it/s] 39%|███▊      | 102/264 [01:31<02:17,  1.18it/s] 39%|███▉      | 103/264 [01:32<02:20,  1.14it/s] 39%|███▉      | 104/264 [01:33<02:19,  1.14it/s] 40%|███▉      | 105/264 [01:34<02:15,  1.18it/s] 40%|████      | 106/264 [01:35<02:16,  1.16it/s] 41%|████      | 107/264 [01:35<02:10,  1.20it/s] 41%|████      | 108/264 [01:36<02:09,  1.21it/s] 41%|████▏     | 109/264 [01:37<02:12,  1.17it/s] 42%|████▏     | 110/264 [01:38<02:13,  1.15it/s] 42%|████▏     | 111/264 [01:39<02:13,  1.15it/s] 42%|████▏     | 112/264 [01:40<02:09,  1.17it/s] 43%|████▎     | 113/264 [01:40<02:06,  1.20it/s] 43%|████▎     | 114/264 [01:41<02:06,  1.19it/s] 44%|████▎     | 115/264 [01:42<02:10,  1.14it/s] 44%|████▍     | 116/264 [01:43<02:07,  1.16it/s] 44%|████▍     | 117/264 [01:44<02:07,  1.16it/s] 45%|████▍     | 118/264 [01:45<02:12,  1.11it/s] 45%|████▌     | 119/264 [01:46<02:06,  1.15it/s] 45%|████▌     | 120/264 [01:47<02:10,  1.11it/s] 46%|████▌     | 121/264 [01:48<02:04,  1.15it/s] 46%|████▌     | 122/264 [01:48<02:07,  1.11it/s] 47%|████▋     | 123/264 [01:49<02:02,  1.15it/s] 47%|████▋     | 124/264 [01:50<02:00,  1.16it/s] 47%|████▋     | 125/264 [01:51<01:59,  1.16it/s] 48%|████▊     | 126/264 [01:52<01:57,  1.17it/s] 48%|████▊     | 127/264 [01:53<01:57,  1.16it/s] 48%|████▊     | 128/264 [01:54<01:57,  1.15it/s] 49%|████▉     | 129/264 [01:54<01:57,  1.15it/s] 49%|████▉     | 130/264 [01:55<01:55,  1.16it/s] 50%|████▉     | 131/264 [01:56<01:54,  1.16it/s] 50%|█████     | 132/264 [01:57<01:56,  1.13it/s] 50%|█████     | 133/264 [01:58<01:55,  1.13it/s] 51%|█████     | 134/264 [01:59<01:53,  1.14it/s] 51%|█████     | 135/264 [02:00<01:50,  1.17it/s] 52%|█████▏    | 136/264 [02:00<01:47,  1.19it/s] 52%|█████▏    | 137/264 [02:01<01:46,  1.19it/s] 52%|█████▏    | 138/264 [02:02<01:45,  1.20it/s] 53%|█████▎    | 139/264 [02:03<01:43,  1.21it/s] 53%|█████▎    | 140/264 [02:04<01:42,  1.21it/s] 53%|█████▎    | 141/264 [02:05<01:47,  1.14it/s] 54%|█████▍    | 142/264 [02:06<01:45,  1.16it/s] 54%|█████▍    | 143/264 [02:07<01:46,  1.13it/s] 55%|█████▍    | 144/264 [02:07<01:44,  1.15it/s] 55%|█████▍    | 145/264 [02:08<01:41,  1.17it/s] 55%|█████▌    | 146/264 [02:09<01:38,  1.19it/s] 56%|█████▌    | 147/264 [02:10<01:42,  1.14it/s] 56%|█████▌    | 148/264 [02:11<01:38,  1.18it/s] 56%|█████▋    | 149/264 [02:12<01:36,  1.19it/s] 57%|█████▋    | 150/264 [02:12<01:34,  1.20it/s] 57%|█████▋    | 151/264 [02:13<01:33,  1.21it/s] 58%|█████▊    | 152/264 [02:14<01:32,  1.21it/s] 58%|█████▊    | 153/264 [02:15<01:32,  1.20it/s] 58%|█████▊    | 154/264 [02:16<01:31,  1.20it/s] 59%|█████▊    | 155/264 [02:16<01:30,  1.20it/s] 59%|█████▉    | 156/264 [02:17<01:33,  1.16it/s] 59%|█████▉    | 157/264 [02:18<01:34,  1.13it/s] 60%|█████▉    | 158/264 [02:19<01:33,  1.13it/s] 60%|██████    | 159/264 [02:20<01:32,  1.14it/s] 61%|██████    | 160/264 [02:21<01:33,  1.12it/s] 61%|██████    | 161/264 [02:22<01:31,  1.13it/s] 61%|██████▏   | 162/264 [02:23<01:27,  1.17it/s] 62%|██████▏   | 163/264 [02:24<01:25,  1.19it/s] 62%|██████▏   | 164/264 [02:24<01:24,  1.19it/s] 62%|██████▎   | 165/264 [02:25<01:22,  1.20it/s] 63%|██████▎   | 166/264 [02:26<01:21,  1.20it/s] 63%|██████▎   | 167/264 [02:27<01:20,  1.21it/s] 64%|██████▎   | 168/264 [02:28<01:19,  1.21it/s] 64%|██████▍   | 169/264 [02:28<01:18,  1.21it/s] 64%|██████▍   | 170/264 [02:29<01:17,  1.21it/s] 65%|██████▍   | 171/264 [02:30<01:17,  1.20it/s] 65%|██████▌   | 172/264 [02:31<01:19,  1.15it/s] 66%|██████▌   | 173/264 [02:32<01:19,  1.15it/s] 66%|██████▌   | 174/264 [02:33<01:19,  1.14it/s] 66%|██████▋   | 175/264 [02:34<01:20,  1.10it/s] 67%|██████▋   | 176/264 [02:35<01:18,  1.12it/s] 67%|██████▋   | 177/264 [02:36<01:16,  1.14it/s] 67%|██████▋   | 178/264 [02:36<01:15,  1.14it/s] 68%|██████▊   | 179/264 [02:37<01:15,  1.12it/s] 68%|██████▊   | 180/264 [02:38<01:11,  1.17it/s] 69%|██████▊   | 181/264 [02:39<01:09,  1.19it/s] 69%|██████▉   | 182/264 [02:40<01:11,  1.14it/s] 69%|██████▉   | 183/264 [02:41<01:08,  1.18it/s] 70%|██████▉   | 184/264 [02:41<01:07,  1.18it/s] 70%|███████   | 185/264 [02:42<01:07,  1.16it/s] 70%|███████   | 186/264 [02:43<01:09,  1.12it/s] 71%|███████   | 187/264 [02:44<01:06,  1.15it/s] 71%|███████   | 188/264 [02:45<01:06,  1.14it/s] 72%|███████▏  | 189/264 [02:46<01:04,  1.16it/s] 72%|███████▏  | 190/264 [02:47<01:02,  1.17it/s] 72%|███████▏  | 191/264 [02:48<01:02,  1.17it/s] 73%|███████▎  | 192/264 [02:49<01:04,  1.12it/s] 73%|███████▎  | 193/264 [02:49<01:02,  1.14it/s] 73%|███████▎  | 194/264 [02:50<01:00,  1.15it/s] 74%|███████▍  | 195/264 [02:51<00:59,  1.16it/s] 74%|███████▍  | 196/264 [02:52<00:58,  1.17it/s] 75%|███████▍  | 197/264 [02:53<00:57,  1.17it/s] 75%|███████▌  | 198/264 [02:54<00:55,  1.20it/s] 75%|███████▌  | 199/264 [02:54<00:54,  1.20it/s] 76%|███████▌  | 200/264 [02:55<00:52,  1.21it/s] 76%|███████▌  | 201/264 [02:56<00:51,  1.22it/s] 77%|███████▋  | 202/264 [02:57<00:52,  1.18it/s] 77%|███████▋  | 203/264 [02:58<00:53,  1.15it/s] 77%|███████▋  | 204/264 [02:59<00:53,  1.12it/s] 78%|███████▊  | 205/264 [03:00<00:54,  1.09it/s] 78%|███████▊  | 206/264 [03:01<00:52,  1.10it/s] 78%|███████▊  | 207/264 [03:01<00:50,  1.13it/s] 79%|███████▉  | 208/264 [03:02<00:49,  1.12it/s] 79%|███████▉  | 209/264 [03:03<00:48,  1.13it/s] 80%|███████▉  | 210/264 [03:04<00:46,  1.16it/s] 80%|███████▉  | 211/264 [03:05<00:44,  1.18it/s] 80%|████████  | 212/264 [03:06<00:45,  1.14it/s] 81%|████████  | 213/264 [03:07<00:44,  1.14it/s] 81%|████████  | 214/264 [03:08<00:42,  1.16it/s] 81%|████████▏ | 215/264 [03:08<00:41,  1.17it/s] 82%|████████▏ | 216/264 [03:09<00:40,  1.18it/s] 82%|████████▏ | 217/264 [03:10<00:40,  1.17it/s] 83%|████████▎ | 218/264 [03:11<00:38,  1.18it/s] 83%|████████▎ | 219/264 [03:12<00:40,  1.12it/s] 83%|████████▎ | 220/264 [03:13<00:39,  1.13it/s] 84%|████████▎ | 221/264 [03:14<00:37,  1.14it/s] 84%|████████▍ | 222/264 [03:14<00:35,  1.17it/s] 84%|████████▍ | 223/264 [03:15<00:35,  1.16it/s] 85%|████████▍ | 224/264 [03:16<00:34,  1.17it/s] 85%|████████▌ | 225/264 [03:17<00:33,  1.16it/s] 86%|████████▌ | 226/264 [03:18<00:32,  1.17it/s] 86%|████████▌ | 227/264 [03:19<00:31,  1.19it/s] 86%|████████▋ | 228/264 [03:20<00:30,  1.18it/s] 87%|████████▋ | 229/264 [03:21<00:31,  1.12it/s] 87%|████████▋ | 230/264 [03:21<00:30,  1.12it/s] 88%|████████▊ | 231/264 [03:22<00:28,  1.15it/s] 88%|████████▊ | 232/264 [03:23<00:27,  1.17it/s] 88%|████████▊ | 233/264 [03:24<00:26,  1.19it/s] 89%|████████▊ | 234/264 [03:25<00:25,  1.19it/s] 89%|████████▉ | 235/264 [03:26<00:23,  1.21it/s] 89%|████████▉ | 236/264 [03:26<00:24,  1.16it/s] 90%|████████▉ | 237/264 [03:27<00:22,  1.19it/s] 90%|█████████ | 238/264 [03:28<00:21,  1.19it/s] 91%|█████████ | 239/264 [03:29<00:20,  1.20it/s] 91%|█████████ | 240/264 [03:30<00:20,  1.17it/s] 91%|█████████▏| 241/264 [03:31<00:19,  1.16it/s] 92%|█████████▏| 242/264 [03:32<00:18,  1.18it/s] 92%|█████████▏| 243/264 [03:32<00:17,  1.19it/s] 92%|█████████▏| 244/264 [03:33<00:16,  1.20it/s] 93%|█████████▎| 245/264 [03:34<00:16,  1.18it/s] 93%|█████████▎| 246/264 [03:35<00:15,  1.14it/s] 94%|█████████▎| 247/264 [03:36<00:14,  1.16it/s] 94%|█████████▍| 248/264 [03:37<00:13,  1.19it/s] 94%|█████████▍| 249/264 [03:37<00:12,  1.19it/s] 95%|█████████▍| 250/264 [03:38<00:11,  1.21it/s] 95%|█████████▌| 251/264 [03:39<00:11,  1.15it/s] 95%|█████████▌| 252/264 [03:40<00:10,  1.09it/s] 96%|█████████▌| 253/264 [03:41<00:10,  1.08it/s] 96%|█████████▌| 254/264 [03:42<00:08,  1.13it/s] 97%|█████████▋| 255/264 [03:43<00:07,  1.15it/s] 97%|█████████▋| 256/264 [03:44<00:06,  1.17it/s] 97%|█████████▋| 257/264 [03:44<00:05,  1.18it/s] 98%|█████████▊| 258/264 [03:45<00:05,  1.14it/s] 98%|█████████▊| 259/264 [03:46<00:04,  1.15it/s] 98%|█████████▊| 260/264 [03:47<00:03,  1.12it/s] 99%|█████████▉| 261/264 [03:48<00:02,  1.16it/s] 99%|█████████▉| 262/264 [03:49<00:01,  1.23it/s]100%|█████████▉| 263/264 [03:49<00:00,  1.27it/s]100%|██████████| 264/264 [03:50<00:00,  1.31it/s]100%|██████████| 264/264 [03:50<00:00,  1.14it/s]Save Model
Save current model ...
[Error] Traceback (most recent call last):
  File "train.py", line 346, in train
    best_model, best_loss, current_model = \
  File "train.py", line 439, in save_model
    model_path = os.path.join(save_dir, current_model)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 328, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 401, in _legacy_save
    pickler.dump(obj)
AttributeError: Can't pickle local object 'train.<locals>.ModelWithLoss'

Can't pickle local object 'train.<locals>.ModelWithLoss'
Step: 1400. Epoch: 5/30. Iteration: 81/264. Cls loss: 677.54340. Reg loss: 0.14615. Total loss: 677.68958
Step 1400: Current Classification Loss:677.543396; Current Regression Loss:0.146150; Current Loss:677.689575;              Average Classification Loss:806.462692; Average Regression Loss:0.093587; Average Loss:806.556277; Current Learning Rate:0.000100.
Save Model
Save current model ...
[Error] Traceback (most recent call last):
  File "train.py", line 346, in train
    best_model, best_loss, current_model = \
  File "train.py", line 439, in save_model
    model_path = os.path.join(save_dir, current_model)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 328, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 401, in _legacy_save
    pickler.dump(obj)
AttributeError: Can't pickle local object 'train.<locals>.ModelWithLoss'

Can't pickle local object 'train.<locals>.ModelWithLoss'
Step: 1500. Epoch: 5/30. Iteration: 181/264. Cls loss: 331.11847. Reg loss: 0.27829. Total loss: 331.39676
Step 1500: Current Classification Loss:331.118469; Current Regression Loss:0.278293; Current Loss:331.396759;              Average Classification Loss:709.829139; Average Regression Loss:0.093168; Average Loss:709.922306; Current Learning Rate:0.000100.

  0%|          | 0/264 [00:00<?, ?it/s]Val. Epoch: 5/30. Classification loss: 259.28405. Regression loss: 0.07069. Total loss: 259.35473
--------------------------------------------After Epoch 5------------------------------------------------
Step 1584: Validation Classification Loss:259.284047; Regression Loss:0.070688; Total Loss:259.354735
----------------------------------------------------------------------------------------------------------
  0%|          | 1/264 [00:01<08:39,  1.98s/it]  1%|          | 2/264 [00:02<07:13,  1.66s/it]  1%|          | 3/264 [00:03<06:05,  1.40s/it]  2%|▏         | 4/264 [00:04<05:27,  1.26s/it]  2%|▏         | 5/264 [00:05<04:53,  1.13s/it]  2%|▏         | 6/264 [00:06<04:28,  1.04s/it]  3%|▎         | 7/264 [00:07<04:10,  1.03it/s]  3%|▎         | 8/264 [00:07<03:57,  1.08it/s]  3%|▎         | 9/264 [00:08<03:53,  1.09it/s]  4%|▍         | 10/264 [00:09<03:54,  1.08it/s]  4%|▍         | 11/264 [00:10<03:52,  1.09it/s]  5%|▍         | 12/264 [00:11<03:51,  1.09it/s]  5%|▍         | 13/264 [00:12<03:51,  1.09it/s]  5%|▌         | 14/264 [00:13<03:47,  1.10it/s]  6%|▌         | 15/264 [00:14<03:42,  1.12it/s]  6%|▌         | 16/264 [00:15<03:41,  1.12it/s]  6%|▋         | 17/264 [00:15<03:36,  1.14it/s]  7%|▋         | 18/264 [00:16<03:31,  1.16it/s]  7%|▋         | 19/264 [00:17<03:33,  1.14it/s]  8%|▊         | 20/264 [00:18<03:30,  1.16it/s]  8%|▊         | 21/264 [00:19<03:30,  1.16it/s]  8%|▊         | 22/264 [00:20<03:25,  1.18it/s]  9%|▊         | 23/264 [00:21<03:29,  1.15it/s]  9%|▉         | 24/264 [00:22<03:38,  1.10it/s]  9%|▉         | 25/264 [00:23<03:42,  1.08it/s] 10%|▉         | 26/264 [00:24<03:44,  1.06it/s] 10%|█         | 27/264 [00:24<03:39,  1.08it/s] 11%|█         | 28/264 [00:25<03:37,  1.09it/s] 11%|█         | 29/264 [00:26<03:30,  1.12it/s] 11%|█▏        | 30/264 [00:27<03:33,  1.10it/s] 12%|█▏        | 31/264 [00:28<03:25,  1.13it/s] 12%|█▏        | 32/264 [00:29<03:24,  1.13it/s] 12%|█▎        | 33/264 [00:30<03:18,  1.17it/s] 13%|█▎        | 34/264 [00:31<03:19,  1.16it/s] 13%|█▎        | 35/264 [00:32<03:23,  1.12it/s] 14%|█▎        | 36/264 [00:32<03:16,  1.16it/s] 14%|█▍        | 37/264 [00:33<03:12,  1.18it/s] 14%|█▍        | 38/264 [00:34<03:18,  1.14it/s] 15%|█▍        | 39/264 [00:35<03:17,  1.14it/s] 15%|█▌        | 40/264 [00:36<03:18,  1.13it/s] 16%|█▌        | 41/264 [00:37<03:10,  1.17it/s] 16%|█▌        | 42/264 [00:37<03:09,  1.17it/s] 16%|█▋        | 43/264 [00:38<03:15,  1.13it/s] 17%|█▋        | 44/264 [00:39<03:10,  1.15it/s] 17%|█▋        | 45/264 [00:40<03:07,  1.17it/s] 17%|█▋        | 46/264 [00:41<03:03,  1.19it/s] 18%|█▊        | 47/264 [00:42<03:08,  1.15it/s] 18%|█▊        | 48/264 [00:43<03:09,  1.14it/s] 19%|█▊        | 49/264 [00:44<03:07,  1.14it/s] 19%|█▉        | 50/264 [00:45<03:08,  1.14it/s] 19%|█▉        | 51/264 [00:45<03:05,  1.15it/s] 20%|█▉        | 52/264 [00:46<03:06,  1.14it/s] 20%|██        | 53/264 [00:47<03:10,  1.11it/s] 20%|██        | 54/264 [00:48<03:12,  1.09it/s] 21%|██        | 55/264 [00:49<03:05,  1.13it/s] 21%|██        | 56/264 [00:50<03:09,  1.09it/s] 22%|██▏       | 57/264 [00:51<03:01,  1.14it/s] 22%|██▏       | 58/264 [00:52<02:57,  1.16it/s] 22%|██▏       | 59/264 [00:52<02:54,  1.17it/s] 23%|██▎       | 60/264 [00:53<02:56,  1.16it/s] 23%|██▎       | 61/264 [00:54<02:53,  1.17it/s] 23%|██▎       | 62/264 [00:55<02:51,  1.18it/s] 24%|██▍       | 63/264 [00:56<02:55,  1.15it/s] 24%|██▍       | 64/264 [00:57<02:56,  1.13it/s] 25%|██▍       | 65/264 [00:58<02:54,  1.14it/s] 25%|██▌       | 66/264 [00:58<02:47,  1.18it/s] 25%|██▌       | 67/264 [01:00<03:00,  1.09it/s] 26%|██▌       | 68/264 [01:00<03:01,  1.08it/s] 26%|██▌       | 69/264 [01:01<02:53,  1.13it/s] 27%|██▋       | 70/264 [01:02<02:48,  1.15it/s] 27%|██▋       | 71/264 [01:03<02:45,  1.17it/s] 27%|██▋       | 72/264 [01:04<02:46,  1.15it/s] 28%|██▊       | 73/264 [01:05<02:42,  1.18it/s] 28%|██▊       | 74/264 [01:05<02:39,  1.19it/s] 28%|██▊       | 75/264 [01:06<02:42,  1.16it/s] 29%|██▉       | 76/264 [01:07<02:41,  1.16it/s] 29%|██▉       | 77/264 [01:08<02:42,  1.15it/s] 30%|██▉       | 78/264 [01:09<02:42,  1.15it/s] 30%|██▉       | 79/264 [01:10<02:37,  1.17it/s] 30%|███       | 80/264 [01:11<02:35,  1.18it/s] 31%|███       | 81/264 [01:11<02:33,  1.19it/s] 31%|███       | 82/264 [01:12<02:31,  1.20it/s] 31%|███▏      | 83/264 [01:13<02:38,  1.14it/s] 32%|███▏      | 84/264 [01:14<02:36,  1.15it/s] 32%|███▏      | 85/264 [01:15<02:38,  1.13it/s] 33%|███▎      | 86/264 [01:16<02:41,  1.10it/s] 33%|███▎      | 87/264 [01:17<02:42,  1.09it/s] 33%|███▎      | 88/264 [01:18<02:36,  1.13it/s] 34%|███▎      | 89/264 [01:19<02:35,  1.13it/s] 34%|███▍      | 90/264 [01:19<02:34,  1.13it/s] 34%|███▍      | 91/264 [01:20<02:29,  1.15it/s] 35%|███▍      | 92/264 [01:21<02:33,  1.12it/s] 35%|███▌      | 93/264 [01:22<02:31,  1.13it/s] 36%|███▌      | 94/264 [01:23<02:28,  1.15it/s] 36%|███▌      | 95/264 [01:24<02:31,  1.11it/s] 36%|███▋      | 96/264 [01:25<02:25,  1.15it/s] 37%|███▋      | 97/264 [01:26<02:28,  1.13it/s] 37%|███▋      | 98/264 [01:27<02:31,  1.09it/s] 38%|███▊      | 99/264 [01:27<02:24,  1.14it/s] 38%|███▊      | 100/264 [01:28<02:26,  1.12it/s] 38%|███▊      | 101/264 [01:29<02:21,  1.16it/s] 39%|███▊      | 102/264 [01:30<02:21,  1.14it/s] 39%|███▉      | 103/264 [01:31<02:21,  1.14it/s] 39%|███▉      | 104/264 [01:32<02:23,  1.12it/s] 40%|███▉      | 105/264 [01:33<02:24,  1.10it/s] 40%|████      | 106/264 [01:34<02:18,  1.14it/s] 41%|████      | 107/264 [01:34<02:15,  1.16it/s] 41%|████      | 108/264 [01:35<02:11,  1.19it/s] 41%|████▏     | 109/264 [01:36<02:11,  1.18it/s] 42%|████▏     | 110/264 [01:37<02:08,  1.20it/s] 42%|████▏     | 111/264 [01:38<02:07,  1.20it/s] 42%|████▏     | 112/264 [01:39<02:06,  1.20it/s] 43%|████▎     | 113/264 [01:39<02:05,  1.21it/s] 43%|████▎     | 114/264 [01:40<02:04,  1.21it/s] 44%|████▎     | 115/264 [01:41<02:03,  1.21it/s] 44%|████▍     | 116/264 [01:42<02:09,  1.14it/s] 44%|████▍     | 117/264 [01:43<02:08,  1.14it/s] 45%|████▍     | 118/264 [01:44<02:11,  1.11it/s] 45%|████▌     | 119/264 [01:45<02:07,  1.14it/s] 45%|████▌     | 120/264 [01:46<02:10,  1.10it/s] 46%|████▌     | 121/264 [01:47<02:07,  1.12it/s] 46%|████▌     | 122/264 [01:47<02:06,  1.12it/s] 47%|████▋     | 123/264 [01:48<02:03,  1.14it/s] 47%|████▋     | 124/264 [01:49<02:01,  1.15it/s] 47%|████▋     | 125/264 [01:50<02:01,  1.14it/s] 48%|████▊     | 126/264 [01:51<02:01,  1.13it/s] 48%|████▊     | 127/264 [01:52<01:57,  1.17it/s] 48%|████▊     | 128/264 [01:52<01:54,  1.19it/s] 49%|████▉     | 129/264 [01:53<01:52,  1.20it/s] 49%|████▉     | 130/264 [01:54<01:50,  1.21it/s] 50%|████▉     | 131/264 [01:55<01:51,  1.19it/s] 50%|█████     | 132/264 [01:56<01:50,  1.20it/s] 50%|█████     | 133/264 [01:57<01:49,  1.20it/s] 51%|█████     | 134/264 [01:57<01:47,  1.21it/s] 51%|█████     | 135/264 [01:58<01:47,  1.20it/s] 52%|█████▏    | 136/264 [01:59<01:49,  1.17it/s] 52%|█████▏    | 137/264 [02:00<01:48,  1.17it/s] 52%|█████▏    | 138/264 [02:01<01:49,  1.15it/s] 53%|█████▎    | 139/264 [02:02<01:46,  1.18it/s] 53%|█████▎    | 140/264 [02:03<01:43,  1.20it/s] 53%|█████▎    | 141/264 [02:03<01:45,  1.16it/s] 54%|█████▍    | 142/264 [02:04<01:44,  1.17it/s] 54%|█████▍    | 143/264 [02:05<01:43,  1.17it/s] 55%|█████▍    | 144/264 [02:06<01:41,  1.18it/s] 55%|█████▍    | 145/264 [02:07<01:39,  1.19it/s] 55%|█████▌    | 146/264 [02:08<01:42,  1.15it/s] 56%|█████▌    | 147/264 [02:09<01:41,  1.16it/s] 56%|█████▌    | 148/264 [02:09<01:37,  1.19it/s] 56%|█████▋    | 149/264 [02:10<01:41,  1.13it/s] 57%|█████▋    | 150/264 [02:11<01:39,  1.14it/s] 57%|█████▋    | 151/264 [02:12<01:38,  1.14it/s] 58%|█████▊    | 152/264 [02:13<01:38,  1.13it/s] 58%|█████▊    | 153/264 [02:14<01:36,  1.14it/s] 58%|█████▊    | 154/264 [02:15<01:37,  1.12it/s] 59%|█████▊    | 155/264 [02:16<01:37,  1.12it/s] 59%|█████▉    | 156/264 [02:17<01:33,  1.15it/s] 59%|█████▉    | 157/264 [02:17<01:31,  1.17it/s] 60%|█████▉    | 158/264 [02:18<01:29,  1.18it/s] 60%|██████    | 159/264 [02:19<01:31,  1.15it/s] 61%|██████    | 160/264 [02:20<01:31,  1.14it/s] 61%|██████    | 161/264 [02:21<01:28,  1.16it/s] 61%|██████▏   | 162/264 [02:22<01:29,  1.14it/s] 62%|██████▏   | 163/264 [02:23<01:25,  1.18it/s] 62%|██████▏   | 164/264 [02:24<01:29,  1.12it/s] 62%|██████▎   | 165/264 [02:24<01:25,  1.15it/s] 63%|██████▎   | 166/264 [02:25<01:22,  1.19it/s] 63%|██████▎   | 167/264 [02:26<01:21,  1.19it/s] 64%|██████▎   | 168/264 [02:27<01:23,  1.15it/s] 64%|██████▍   | 169/264 [02:28<01:23,  1.14it/s] 64%|██████▍   | 170/264 [02:29<01:26,  1.09it/s] 65%|██████▍   | 171/264 [02:30<01:24,  1.10it/s] 65%|██████▌   | 172/264 [02:31<01:22,  1.11it/s] 66%|██████▌   | 173/264 [02:31<01:19,  1.14it/s] 66%|██████▌   | 174/264 [02:32<01:20,  1.12it/s] 66%|██████▋   | 175/264 [02:33<01:17,  1.15it/s] 67%|██████▋   | 176/264 [02:34<01:18,  1.12it/s] 67%|██████▋   | 177/264 [02:35<01:16,  1.14it/s] 67%|██████▋   | 178/264 [02:36<01:13,  1.17it/s] 68%|██████▊   | 179/264 [02:37<01:11,  1.19it/s] 68%|██████▊   | 180/264 [02:37<01:09,  1.20it/s] 69%|██████▊   | 181/264 [02:38<01:08,  1.21it/s] 69%|██████▉   | 182/264 [02:39<01:07,  1.21it/s] 69%|██████▉   | 183/264 [02:40<01:07,  1.20it/s] 70%|██████▉   | 184/264 [02:41<01:05,  1.21it/s] 70%|███████   | 185/264 [02:41<01:04,  1.22it/s] 70%|███████   | 186/264 [02:42<01:04,  1.20it/s] 71%|███████   | 187/264 [02:43<01:03,  1.20it/s] 71%|███████   | 188/264 [02:44<01:03,  1.21it/s] 72%|███████▏  | 189/264 [02:45<01:02,  1.21it/s] 72%|███████▏  | 190/264 [02:46<01:01,  1.20it/s] 72%|███████▏  | 191/264 [02:47<01:03,  1.15it/s] 73%|███████▎  | 192/264 [02:47<01:01,  1.17it/s] 73%|███████▎  | 193/264 [02:48<01:01,  1.15it/s] 73%|███████▎  | 194/264 [02:49<00:59,  1.17it/s] 74%|███████▍  | 195/264 [02:50<00:58,  1.19it/s] 74%|███████▍  | 196/264 [02:51<00:59,  1.15it/s] 75%|███████▍  | 197/264 [02:52<00:57,  1.17it/s] 75%|███████▌  | 198/264 [02:53<00:57,  1.15it/s] 75%|███████▌  | 199/264 [02:53<00:57,  1.14it/s] 76%|███████▌  | 200/264 [02:54<00:56,  1.13it/s] 76%|███████▌  | 201/264 [02:55<00:55,  1.13it/s] 77%|███████▋  | 202/264 [02:56<00:53,  1.17it/s] 77%|███████▋  | 203/264 [02:57<00:54,  1.12it/s] 77%|███████▋  | 204/264 [02:58<00:53,  1.13it/s] 78%|███████▊  | 205/264 [02:59<00:51,  1.15it/s] 78%|███████▊  | 206/264 [03:00<00:52,  1.11it/s] 78%|███████▊  | 207/264 [03:01<00:50,  1.12it/s] 79%|███████▉  | 208/264 [03:01<00:49,  1.13it/s] 79%|███████▉  | 209/264 [03:02<00:48,  1.14it/s] 80%|███████▉  | 210/264 [03:03<00:46,  1.16it/s] 80%|███████▉  | 211/264 [03:04<00:47,  1.12it/s] 80%|████████  | 212/264 [03:05<00:44,  1.16it/s] 81%|████████  | 213/264 [03:06<00:43,  1.17it/s] 81%|████████  | 214/264 [03:07<00:42,  1.17it/s] 81%|████████▏ | 215/264 [03:08<00:43,  1.13it/s] 82%|████████▏ | 216/264 [03:08<00:43,  1.10it/s] 82%|████████▏ | 217/264 [03:09<00:42,  1.11it/s] 83%|████████▎ | 218/264 [03:10<00:41,  1.11it/s] 83%|████████▎ | 219/264 [03:11<00:40,  1.10it/s] 83%|████████▎ | 220/264 [03:12<00:39,  1.10it/s] 84%|████████▎ | 221/264 [03:13<00:38,  1.13it/s] 84%|████████▍ | 222/264 [03:14<00:37,  1.13it/s] 84%|████████▍ | 223/264 [03:15<00:36,  1.12it/s] 85%|████████▍ | 224/264 [03:16<00:36,  1.11it/s] 85%|████████▌ | 225/264 [03:16<00:34,  1.14it/s] 86%|████████▌ | 226/264 [03:17<00:32,  1.16it/s] 86%|████████▌ | 227/264 [03:18<00:31,  1.19it/s] 86%|████████▋ | 228/264 [03:19<00:30,  1.19it/s] 87%|████████▋ | 229/264 [03:20<00:28,  1.21it/s] 87%|████████▋ | 230/264 [03:21<00:29,  1.14it/s] 88%|████████▊ | 231/264 [03:22<00:29,  1.13it/s] 88%|████████▊ | 232/264 [03:22<00:27,  1.16it/s] 88%|████████▊ | 233/264 [03:23<00:27,  1.12it/s] 89%|████████▊ | 234/264 [03:24<00:26,  1.14it/s] 89%|████████▉ | 235/264 [03:25<00:25,  1.13it/s] 89%|████████▉ | 236/264 [03:26<00:24,  1.13it/s] 90%|████████▉ | 237/264 [03:27<00:23,  1.13it/s] 90%|█████████ | 238/264 [03:28<00:23,  1.12it/s] 91%|█████████ | 239/264 [03:29<00:21,  1.15it/s] 91%|█████████ | 240/264 [03:29<00:20,  1.17it/s] 91%|█████████▏| 241/264 [03:30<00:19,  1.16it/s] 92%|█████████▏| 242/264 [03:31<00:19,  1.16it/s] 92%|█████████▏| 243/264 [03:32<00:17,  1.17it/s] 92%|█████████▏| 244/264 [03:33<00:16,  1.19it/s] 93%|█████████▎| 245/264 [03:34<00:16,  1.16it/s] 93%|█████████▎| 246/264 [03:35<00:15,  1.14it/s] 94%|█████████▎| 247/264 [03:35<00:14,  1.15it/s] 94%|█████████▍| 248/264 [03:36<00:13,  1.17it/s] 94%|█████████▍| 249/264 [03:37<00:12,  1.18it/s] 95%|█████████▍| 250/264 [03:38<00:11,  1.17it/s] 95%|█████████▌| 251/264 [03:39<00:10,  1.19it/s] 95%|█████████▌| 252/264 [03:40<00:10,  1.18it/s] 96%|█████████▌| 253/264 [03:41<00:09,  1.13it/s] 96%|█████████▌| 254/264 [03:42<00:09,  1.11it/s] 97%|█████████▋| 255/264 [03:42<00:07,  1.15it/s] 97%|█████████▋| 256/264 [03:43<00:07,  1.12it/s] 97%|█████████▋| 257/264 [03:44<00:06,  1.16it/s] 98%|█████████▊| 258/264 [03:45<00:05,  1.13it/s] 98%|█████████▊| 259/264 [03:46<00:04,  1.16it/s] 98%|█████████▊| 260/264 [03:47<00:03,  1.19it/s] 99%|█████████▉| 261/264 [03:47<00:02,  1.21it/s] 99%|█████████▉| 262/264 [03:48<00:01,  1.27it/s]100%|█████████▉| 263/264 [03:49<00:00,  1.29it/s]100%|██████████| 264/264 [03:50<00:00,  1.33it/s]100%|██████████| 264/264 [03:50<00:00,  1.15it/s]Save Model
Save current model ...
[Error] Traceback (most recent call last):
  File "train.py", line 346, in train
    best_model, best_loss, current_model = \
  File "train.py", line 439, in save_model
    model_path = os.path.join(save_dir, current_model)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 328, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 401, in _legacy_save
    pickler.dump(obj)
AttributeError: Can't pickle local object 'train.<locals>.ModelWithLoss'

Can't pickle local object 'train.<locals>.ModelWithLoss'
Step: 1600. Epoch: 6/30. Iteration: 17/264. Cls loss: 347.23349. Reg loss: 0.14599. Total loss: 347.37949
Step 1600: Current Classification Loss:347.233490; Current Regression Loss:0.145990; Current Loss:347.379486;              Average Classification Loss:419.652369; Average Regression Loss:0.089165; Average Loss:419.741530; Current Learning Rate:0.000100.
Save Model
Save current model ...
[Error] Traceback (most recent call last):
  File "train.py", line 346, in train
    best_model, best_loss, current_model = \
  File "train.py", line 439, in save_model
    model_path = os.path.join(save_dir, current_model)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 328, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 401, in _legacy_save
    pickler.dump(obj)
AttributeError: Can't pickle local object 'train.<locals>.ModelWithLoss'

Can't pickle local object 'train.<locals>.ModelWithLoss'
Step: 1700. Epoch: 6/30. Iteration: 117/264. Cls loss: 288.62158. Reg loss: 0.11020. Total loss: 288.73178
Step 1700: Current Classification Loss:288.621582; Current Regression Loss:0.110205; Current Loss:288.731781;              Average Classification Loss:402.735799; Average Regression Loss:0.091698; Average Loss:402.827496; Current Learning Rate:0.000100.
Save Model
Save current model ...
[Error] Traceback (most recent call last):
  File "train.py", line 346, in train
    best_model, best_loss, current_model = \
  File "train.py", line 439, in save_model
    model_path = os.path.join(save_dir, current_model)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 328, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 401, in _legacy_save
    pickler.dump(obj)
AttributeError: Can't pickle local object 'train.<locals>.ModelWithLoss'

Can't pickle local object 'train.<locals>.ModelWithLoss'
Step: 1800. Epoch: 6/30. Iteration: 217/264. Cls loss: 423.51035. Reg loss: 0.06867. Total loss: 423.57901
Step 1800: Current Classification Loss:423.510345; Current Regression Loss:0.068669; Current Loss:423.579010;              Average Classification Loss:369.822492; Average Regression Loss:0.086628; Average Loss:369.909119; Current Learning Rate:0.000100.

  0%|          | 0/264 [00:00<?, ?it/s]Val. Epoch: 6/30. Classification loss: 145.97673. Regression loss: 0.06946. Total loss: 146.04619
--------------------------------------------After Epoch 6------------------------------------------------
Step 1848: Validation Classification Loss:145.976731; Regression Loss:0.069459; Total Loss:146.046190
----------------------------------------------------------------------------------------------------------
  0%|          | 1/264 [00:02<09:16,  2.11s/it]  1%|          | 2/264 [00:03<07:43,  1.77s/it]  1%|          | 3/264 [00:04<06:35,  1.52s/it]  2%|▏         | 4/264 [00:04<05:51,  1.35s/it]  2%|▏         | 5/264 [00:05<05:12,  1.21s/it]  2%|▏         | 6/264 [00:06<04:52,  1.13s/it]  3%|▎         | 7/264 [00:07<04:27,  1.04s/it]  3%|▎         | 8/264 [00:08<04:08,  1.03it/s]  3%|▎         | 9/264 [00:09<03:55,  1.08it/s]  4%|▍         | 10/264 [00:10<03:45,  1.12it/s]  4%|▍         | 11/264 [00:10<03:39,  1.15it/s]  5%|▍         | 12/264 [00:11<03:35,  1.17it/s]  5%|▍         | 13/264 [00:12<03:30,  1.19it/s]  5%|▌         | 14/264 [00:13<03:27,  1.21it/s]  6%|▌         | 15/264 [00:14<03:24,  1.22it/s]  6%|▌         | 16/264 [00:14<03:23,  1.22it/s]  6%|▋         | 17/264 [00:15<03:22,  1.22it/s]  7%|▋         | 18/264 [00:16<03:20,  1.22it/s]  7%|▋         | 19/264 [00:17<03:19,  1.23it/s]  8%|▊         | 20/264 [00:18<03:18,  1.23it/s]  8%|▊         | 21/264 [00:19<03:21,  1.20it/s]  8%|▊         | 22/264 [00:19<03:20,  1.21it/s]  9%|▊         | 23/264 [00:20<03:18,  1.21it/s]  9%|▉         | 24/264 [00:21<03:17,  1.22it/s]  9%|▉         | 25/264 [00:22<03:15,  1.22it/s] 10%|▉         | 26/264 [00:23<03:14,  1.23it/s] 10%|█         | 27/264 [00:24<03:20,  1.18it/s] 11%|█         | 28/264 [00:24<03:23,  1.16it/s] 11%|█         | 29/264 [00:25<03:25,  1.14it/s] 11%|█▏        | 30/264 [00:26<03:24,  1.15it/s] 12%|█▏        | 31/264 [00:27<03:18,  1.18it/s] 12%|█▏        | 32/264 [00:28<03:17,  1.17it/s] 12%|█▎        | 33/264 [00:29<03:13,  1.20it/s] 13%|█▎        | 34/264 [00:29<03:11,  1.20it/s] 13%|█▎        | 35/264 [00:30<03:16,  1.16it/s] 14%|█▎        | 36/264 [00:31<03:17,  1.16it/s] 14%|█▍        | 37/264 [00:32<03:22,  1.12it/s] 14%|█▍        | 38/264 [00:33<03:18,  1.14it/s] 15%|█▍        | 39/264 [00:34<03:14,  1.15it/s] 15%|█▌        | 40/264 [00:35<03:09,  1.18it/s] 16%|█▌        | 41/264 [00:36<03:07,  1.19it/s] 16%|█▌        | 42/264 [00:36<03:03,  1.21it/s] 16%|█▋        | 43/264 [00:37<03:06,  1.19it/s] 17%|█▋        | 44/264 [00:38<03:03,  1.20it/s] 17%|█▋        | 45/264 [00:39<03:01,  1.21it/s] 17%|█▋        | 46/264 [00:40<03:00,  1.21it/s] 18%|█▊        | 47/264 [00:41<03:06,  1.16it/s] 18%|█▊        | 48/264 [00:41<03:03,  1.18it/s] 19%|█▊        | 49/264 [00:42<03:00,  1.19it/s] 19%|█▉        | 50/264 [00:43<02:57,  1.20it/s] 19%|█▉        | 51/264 [00:44<02:56,  1.21it/s] 20%|█▉        | 52/264 [00:45<02:55,  1.21it/s] 20%|██        | 53/264 [00:46<02:53,  1.22it/s] 20%|██        | 54/264 [00:47<03:08,  1.11it/s] 21%|██        | 55/264 [00:47<03:01,  1.15it/s] 21%|██        | 56/264 [00:48<02:57,  1.17it/s] 22%|██▏       | 57/264 [00:49<03:03,  1.13it/s] 22%|██▏       | 58/264 [00:50<02:55,  1.17it/s] 22%|██▏       | 59/264 [00:51<03:01,  1.13it/s] 23%|██▎       | 60/264 [00:52<02:56,  1.16it/s] 23%|██▎       | 61/264 [00:53<02:56,  1.15it/s] 23%|██▎       | 62/264 [00:53<02:52,  1.17it/s] 24%|██▍       | 63/264 [00:54<02:48,  1.19it/s] 24%|██▍       | 64/264 [00:55<02:47,  1.20it/s] 25%|██▍       | 65/264 [00:56<02:55,  1.13it/s] 25%|██▌       | 66/264 [00:57<02:49,  1.17it/s] 25%|██▌       | 67/264 [00:58<02:49,  1.16it/s] 26%|██▌       | 68/264 [00:59<02:47,  1.17it/s] 26%|██▌       | 69/264 [00:59<02:46,  1.17it/s] 27%|██▋       | 70/264 [01:00<02:47,  1.16it/s] 27%|██▋       | 71/264 [01:01<02:48,  1.15it/s] 27%|██▋       | 72/264 [01:02<02:51,  1.12it/s] 28%|██▊       | 73/264 [01:03<02:45,  1.15it/s] 28%|██▊       | 74/264 [01:04<02:47,  1.13it/s] 28%|██▊       | 75/264 [01:05<02:44,  1.15it/s] 29%|██▉       | 76/264 [01:06<02:42,  1.16it/s] 29%|██▉       | 77/264 [01:06<02:39,  1.17it/s] 30%|██▉       | 78/264 [01:07<02:37,  1.18it/s] 30%|██▉       | 79/264 [01:08<02:35,  1.19it/s] 30%|███       | 80/264 [01:09<02:34,  1.19it/s] 31%|███       | 81/264 [01:10<02:31,  1.21it/s] 31%|███       | 82/264 [01:10<02:29,  1.22it/s] 31%|███▏      | 83/264 [01:11<02:27,  1.22it/s] 32%|███▏      | 84/264 [01:12<02:27,  1.22it/s] 32%|███▏      | 85/264 [01:13<02:26,  1.22it/s] 33%|███▎      | 86/264 [01:14<02:25,  1.22it/s] 33%|███▎      | 87/264 [01:15<02:26,  1.21it/s] 33%|███▎      | 88/264 [01:16<02:30,  1.17it/s] 34%|███▎      | 89/264 [01:16<02:34,  1.14it/s] 34%|███▍      | 90/264 [01:17<02:30,  1.15it/s] 34%|███▍      | 91/264 [01:18<02:28,  1.17it/s] 35%|███▍      | 92/264 [01:19<02:25,  1.18it/s] 35%|███▌      | 93/264 [01:20<02:27,  1.16it/s] 36%|███▌      | 94/264 [01:21<02:24,  1.18it/s] 36%|███▌      | 95/264 [01:21<02:21,  1.20it/s] 36%|███▋      | 96/264 [01:22<02:22,  1.18it/s] 37%|███▋      | 97/264 [01:23<02:27,  1.13it/s] 37%|███▋      | 98/264 [01:24<02:24,  1.15it/s] 38%|███▊      | 99/264 [01:25<02:26,  1.12it/s] 38%|███▊      | 100/264 [01:26<02:21,  1.16it/s] 38%|███▊      | 101/264 [01:27<02:20,  1.16it/s] 39%|███▊      | 102/264 [01:28<02:17,  1.18it/s] 39%|███▉      | 103/264 [01:28<02:14,  1.20it/s] 39%|███▉      | 104/264 [01:29<02:13,  1.20it/s] 40%|███▉      | 105/264 [01:30<02:11,  1.21it/s] 40%|████      | 106/264 [01:31<02:14,  1.18it/s] 41%|████      | 107/264 [01:32<02:08,  1.22it/s] 41%|████      | 108/264 [01:33<02:15,  1.15it/s] 41%|████▏     | 109/264 [01:33<02:11,  1.18it/s] 42%|████▏     | 110/264 [01:34<02:10,  1.18it/s] 42%|████▏     | 111/264 [01:35<02:07,  1.20it/s] 42%|████▏     | 112/264 [01:36<02:05,  1.21it/s] 43%|████▎     | 113/264 [01:37<02:03,  1.22it/s] 43%|████▎     | 114/264 [01:38<02:03,  1.21it/s] 44%|████▎     | 115/264 [01:38<02:02,  1.22it/s] 44%|████▍     | 116/264 [01:39<02:02,  1.21it/s] 44%|████▍     | 117/264 [01:40<02:06,  1.16it/s] 45%|████▍     | 118/264 [01:41<02:06,  1.15it/s] 45%|████▌     | 119/264 [01:42<02:07,  1.13it/s] 45%|████▌     | 120/264 [01:43<02:09,  1.11it/s] 46%|████▌     | 121/264 [01:44<02:04,  1.15it/s] 46%|████▌     | 122/264 [01:45<02:01,  1.17it/s] 47%|████▋     | 123/264 [01:45<01:57,  1.20it/s] 47%|████▋     | 124/264 [01:46<01:56,  1.20it/s] 47%|████▋     | 125/264 [01:47<01:55,  1.20it/s] 48%|████▊     | 126/264 [01:48<01:56,  1.19it/s] 48%|████▊     | 127/264 [01:49<01:54,  1.19it/s] 48%|████▊     | 128/264 [01:50<01:55,  1.18it/s] 49%|████▉     | 129/264 [01:50<01:57,  1.15it/s] 49%|████▉     | 130/264 [01:51<01:54,  1.17it/s] 50%|████▉     | 131/264 [01:52<01:53,  1.17it/s] 50%|█████     | 132/264 [01:53<01:55,  1.14it/s] 50%|█████     | 133/264 [01:54<01:55,  1.13it/s] 51%|█████     | 134/264 [01:55<01:54,  1.14it/s] 51%|█████     | 135/264 [01:56<01:54,  1.12it/s] 52%|█████▏    | 136/264 [01:57<01:51,  1.15it/s] 52%|█████▏    | 137/264 [01:57<01:51,  1.14it/s] 52%|█████▏    | 138/264 [01:58<01:49,  1.16it/s] 53%|█████▎    | 139/264 [01:59<01:45,  1.19it/s] 53%|█████▎    | 140/264 [02:00<01:43,  1.20it/s] 53%|█████▎    | 141/264 [02:01<01:41,  1.21it/s] 54%|█████▍    | 142/264 [02:02<01:43,  1.18it/s] 54%|█████▍    | 143/264 [02:02<01:41,  1.19it/s] 55%|█████▍    | 144/264 [02:03<01:40,  1.19it/s] 55%|█████▍    | 145/264 [02:04<01:38,  1.21it/s] 55%|█████▌    | 146/264 [02:05<01:37,  1.21it/s] 56%|█████▌    | 147/264 [02:06<01:35,  1.22it/s] 56%|█████▌    | 148/264 [02:06<01:34,  1.22it/s] 56%|█████▋    | 149/264 [02:07<01:34,  1.22it/s] 57%|█████▋    | 150/264 [02:08<01:35,  1.20it/s] 57%|█████▋    | 151/264 [02:09<01:34,  1.20it/s] 58%|█████▊    | 152/264 [02:10<01:36,  1.16it/s] 58%|█████▊    | 153/264 [02:11<01:36,  1.15it/s] 58%|█████▊    | 154/264 [02:12<01:34,  1.16it/s] 59%|█████▊    | 155/264 [02:12<01:32,  1.18it/s] 59%|█████▉    | 156/264 [02:13<01:33,  1.15it/s] 59%|█████▉    | 157/264 [02:14<01:33,  1.15it/s] 60%|█████▉    | 158/264 [02:15<01:31,  1.15it/s] 60%|██████    | 159/264 [02:16<01:32,  1.14it/s] 61%|██████    | 160/264 [02:17<01:32,  1.12it/s] 61%|██████    | 161/264 [02:18<01:29,  1.16it/s] 61%|██████▏   | 162/264 [02:19<01:28,  1.15it/s] 62%|██████▏   | 163/264 [02:19<01:25,  1.18it/s] 62%|██████▏   | 164/264 [02:20<01:26,  1.16it/s] 62%|██████▎   | 165/264 [02:21<01:28,  1.12it/s] 63%|██████▎   | 166/264 [02:22<01:30,  1.09it/s] 63%|██████▎   | 167/264 [02:23<01:31,  1.06it/s] 64%|██████▎   | 168/264 [02:24<01:26,  1.11it/s] 64%|██████▍   | 169/264 [02:25<01:26,  1.10it/s] 64%|██████▍   | 170/264 [02:26<01:22,  1.13it/s] 65%|██████▍   | 171/264 [02:27<01:20,  1.15it/s] 65%|██████▌   | 172/264 [02:28<01:18,  1.17it/s] 66%|██████▌   | 173/264 [02:28<01:16,  1.19it/s] 66%|██████▌   | 174/264 [02:29<01:19,  1.13it/s] 66%|██████▋   | 175/264 [02:30<01:18,  1.14it/s] 67%|██████▋   | 176/264 [02:31<01:15,  1.16it/s] 67%|██████▋   | 177/264 [02:32<01:15,  1.16it/s] 67%|██████▋   | 178/264 [02:33<01:15,  1.14it/s] 68%|██████▊   | 179/264 [02:34<01:15,  1.13it/s] 68%|██████▊   | 180/264 [02:34<01:12,  1.16it/s] 69%|██████▊   | 181/264 [02:35<01:10,  1.18it/s] 69%|██████▉   | 182/264 [02:36<01:08,  1.20it/s] 69%|██████▉   | 183/264 [02:37<01:07,  1.21it/s] 70%|██████▉   | 184/264 [02:38<01:06,  1.21it/s] 70%|███████   | 185/264 [02:39<01:05,  1.21it/s] 70%|███████   | 186/264 [02:39<01:05,  1.19it/s] 71%|███████   | 187/264 [02:40<01:04,  1.19it/s] 71%|███████   | 188/264 [02:41<01:05,  1.16it/s] 72%|███████▏  | 189/264 [02:42<01:05,  1.15it/s] 72%|███████▏  | 190/264 [02:43<01:05,  1.14it/s] 72%|███████▏  | 191/264 [02:44<01:03,  1.15it/s] 73%|███████▎  | 192/264 [02:45<01:04,  1.12it/s] 73%|███████▎  | 193/264 [02:46<01:01,  1.15it/s] 73%|███████▎  | 194/264 [02:46<01:00,  1.15it/s] 74%|███████▍  | 195/264 [02:47<00:59,  1.16it/s] 74%|███████▍  | 196/264 [02:48<00:59,  1.15it/s] 75%|███████▍  | 197/264 [02:49<00:58,  1.15it/s] 75%|███████▌  | 198/264 [02:50<00:56,  1.17it/s] 75%|███████▌  | 199/264 [02:51<00:55,  1.17it/s] 76%|███████▌  | 200/264 [02:52<00:53,  1.19it/s] 76%|███████▌  | 201/264 [02:53<00:55,  1.14it/s] 77%|███████▋  | 202/264 [02:53<00:52,  1.17it/s] 77%|███████▋  | 203/264 [02:54<00:53,  1.14it/s] 77%|███████▋  | 204/264 [02:55<00:53,  1.12it/s] 78%|███████▊  | 205/264 [02:56<00:52,  1.13it/s] 78%|███████▊  | 206/264 [02:57<00:50,  1.15it/s] 78%|███████▊  | 207/264 [02:58<00:48,  1.17it/s] 79%|███████▉  | 208/264 [02:59<00:49,  1.12it/s] 79%|███████▉  | 209/264 [03:00<00:49,  1.12it/s] 80%|███████▉  | 210/264 [03:00<00:48,  1.12it/s] 80%|███████▉  | 211/264 [03:01<00:47,  1.11it/s] 80%|████████  | 212/264 [03:02<00:46,  1.13it/s] 81%|████████  | 213/264 [03:03<00:44,  1.15it/s] 81%|████████  | 214/264 [03:04<00:43,  1.16it/s] 81%|████████▏ | 215/264 [03:05<00:41,  1.17it/s] 82%|████████▏ | 216/264 [03:06<00:40,  1.18it/s] 82%|████████▏ | 217/264 [03:06<00:39,  1.19it/s] 83%|████████▎ | 218/264 [03:07<00:38,  1.20it/s] 83%|████████▎ | 219/264 [03:08<00:40,  1.11it/s] 83%|████████▎ | 220/264 [03:09<00:38,  1.15it/s] 84%|████████▎ | 221/264 [03:10<00:38,  1.12it/s] 84%|████████▍ | 222/264 [03:11<00:37,  1.13it/s] 84%|████████▍ | 223/264 [03:12<00:36,  1.12it/s] 85%|████████▍ | 224/264 [03:13<00:35,  1.12it/s] 85%|████████▌ | 225/264 [03:14<00:34,  1.14it/s] 86%|████████▌ | 226/264 [03:14<00:32,  1.17it/s] 86%|████████▌ | 227/264 [03:15<00:31,  1.19it/s] 86%|████████▋ | 228/264 [03:16<00:29,  1.20it/s] 87%|████████▋ | 229/264 [03:17<00:28,  1.21it/s] 87%|████████▋ | 230/264 [03:18<00:28,  1.20it/s] 88%|████████▊ | 231/264 [03:18<00:27,  1.20it/s] 88%|████████▊ | 232/264 [03:19<00:27,  1.16it/s] 88%|████████▊ | 233/264 [03:20<00:26,  1.16it/s] 89%|████████▊ | 234/264 [03:21<00:25,  1.18it/s] 89%|████████▉ | 235/264 [03:22<00:24,  1.19it/s] 89%|████████▉ | 236/264 [03:23<00:23,  1.20it/s] 90%|████████▉ | 237/264 [03:24<00:22,  1.21it/s] 90%|█████████ | 238/264 [03:25<00:23,  1.10it/s] 91%|█████████ | 239/264 [03:25<00:21,  1.15it/s] 91%|█████████ | 240/264 [03:26<00:21,  1.12it/s] 91%|█████████▏| 241/264 [03:27<00:20,  1.11it/s] 92%|█████████▏| 242/264 [03:28<00:19,  1.15it/s] 92%|█████████▏| 243/264 [03:29<00:18,  1.14it/s] 92%|█████████▏| 244/264 [03:30<00:17,  1.13it/s] 93%|█████████▎| 245/264 [03:31<00:16,  1.17it/s] 93%|█████████▎| 246/264 [03:32<00:15,  1.14it/s] 94%|█████████▎| 247/264 [03:32<00:14,  1.15it/s] 94%|█████████▍| 248/264 [03:33<00:13,  1.17it/s] 94%|█████████▍| 249/264 [03:34<00:12,  1.19it/s] 95%|█████████▍| 250/264 [03:35<00:12,  1.16it/s] 95%|█████████▌| 251/264 [03:36<00:11,  1.16it/s] 95%|█████████▌| 252/264 [03:37<00:10,  1.15it/s] 96%|█████████▌| 253/264 [03:38<00:09,  1.15it/s] 96%|█████████▌| 254/264 [03:38<00:08,  1.17it/s] 97%|█████████▋| 255/264 [03:39<00:07,  1.19it/s] 97%|█████████▋| 256/264 [03:40<00:07,  1.14it/s] 97%|█████████▋| 257/264 [03:41<00:05,  1.17it/s] 98%|█████████▊| 258/264 [03:42<00:05,  1.19it/s] 98%|█████████▊| 259/264 [03:43<00:04,  1.14it/s] 98%|█████████▊| 260/264 [03:44<00:03,  1.13it/s] 99%|█████████▉| 261/264 [03:44<00:02,  1.20it/s] 99%|█████████▉| 262/264 [03:45<00:01,  1.27it/s]100%|█████████▉| 263/264 [03:46<00:00,  1.30it/s]100%|██████████| 264/264 [03:46<00:00,  1.33it/s]100%|██████████| 264/264 [03:47<00:00,  1.16it/s]Save Model
Save current model ...
[Error] Traceback (most recent call last):
  File "train.py", line 346, in train
    best_model, best_loss, current_model = \
  File "train.py", line 439, in save_model
    model_path = os.path.join(save_dir, current_model)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 328, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 401, in _legacy_save
    pickler.dump(obj)
AttributeError: Can't pickle local object 'train.<locals>.ModelWithLoss'

Can't pickle local object 'train.<locals>.ModelWithLoss'
Step: 1900. Epoch: 7/30. Iteration: 53/264. Cls loss: 270.93475. Reg loss: 0.08461. Total loss: 271.01935
Step 1900: Current Classification Loss:270.934753; Current Regression Loss:0.084608; Current Loss:271.019348;              Average Classification Loss:246.456768; Average Regression Loss:0.073468; Average Loss:246.530237; Current Learning Rate:0.000100.
Save Model
Save current model ...
[Error] Traceback (most recent call last):
  File "train.py", line 346, in train
    best_model, best_loss, current_model = \
  File "train.py", line 439, in save_model
    model_path = os.path.join(save_dir, current_model)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 328, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 401, in _legacy_save
    pickler.dump(obj)
AttributeError: Can't pickle local object 'train.<locals>.ModelWithLoss'

Can't pickle local object 'train.<locals>.ModelWithLoss'
Step: 2000. Epoch: 7/30. Iteration: 153/264. Cls loss: 213.85474. Reg loss: 0.06536. Total loss: 213.92010
Step 2000: Current Classification Loss:213.854736; Current Regression Loss:0.065362; Current Loss:213.920105;              Average Classification Loss:242.972554; Average Regression Loss:0.070221; Average Loss:243.042775; Current Learning Rate:0.000100.
Save Model
Save current model ...
[Error] Traceback (most recent call last):
  File "train.py", line 346, in train
    best_model, best_loss, current_model = \
  File "train.py", line 439, in save_model
    model_path = os.path.join(save_dir, current_model)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 328, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 401, in _legacy_save
    pickler.dump(obj)
AttributeError: Can't pickle local object 'train.<locals>.ModelWithLoss'

Can't pickle local object 'train.<locals>.ModelWithLoss'
Step: 2100. Epoch: 7/30. Iteration: 253/264. Cls loss: 196.40396. Reg loss: 0.03090. Total loss: 196.43486
Step 2100: Current Classification Loss:196.403961; Current Regression Loss:0.030895; Current Loss:196.434860;              Average Classification Loss:217.882332; Average Regression Loss:0.071763; Average Loss:217.954094; Current Learning Rate:0.000100.

  0%|          | 0/264 [00:00<?, ?it/s]Val. Epoch: 7/30. Classification loss: 91.52243. Regression loss: 0.07111. Total loss: 91.59354
--------------------------------------------After Epoch 7------------------------------------------------
Step 2112: Validation Classification Loss:91.522434; Regression Loss:0.071108; Total Loss:91.593542
----------------------------------------------------------------------------------------------------------
  0%|          | 1/264 [00:01<07:53,  1.80s/it]  1%|          | 2/264 [00:02<06:46,  1.55s/it]  1%|          | 3/264 [00:03<05:56,  1.37s/it]  2%|▏         | 4/264 [00:04<05:16,  1.22s/it]  2%|▏         | 5/264 [00:05<04:54,  1.14s/it]  2%|▏         | 6/264 [00:06<04:37,  1.08s/it]  3%|▎         | 7/264 [00:07<04:24,  1.03s/it]  3%|▎         | 8/264 [00:08<04:18,  1.01s/it]  3%|▎         | 9/264 [00:09<04:02,  1.05it/s]  4%|▍         | 10/264 [00:10<03:54,  1.08it/s]  4%|▍         | 11/264 [00:10<03:52,  1.09it/s]  5%|▍         | 12/264 [00:11<03:49,  1.10it/s]  5%|▍         | 13/264 [00:12<03:44,  1.12it/s]  5%|▌         | 14/264 [00:13<03:36,  1.15it/s]  6%|▌         | 15/264 [00:14<03:31,  1.17it/s]  6%|▌         | 16/264 [00:15<03:36,  1.15it/s]  6%|▋         | 17/264 [00:16<03:37,  1.13it/s]  7%|▋         | 18/264 [00:16<03:31,  1.17it/s]  7%|▋         | 19/264 [00:17<03:33,  1.15it/s]  8%|▊         | 20/264 [00:18<03:38,  1.12it/s]  8%|▊         | 21/264 [00:19<03:32,  1.14it/s]  8%|▊         | 22/264 [00:20<03:28,  1.16it/s]  9%|▊         | 23/264 [00:21<03:25,  1.17it/s]  9%|▉         | 24/264 [00:22<03:20,  1.20it/s]  9%|▉         | 25/264 [00:22<03:19,  1.20it/s] 10%|▉         | 26/264 [00:23<03:19,  1.19it/s] 10%|█         | 27/264 [00:24<03:17,  1.20it/s] 11%|█         | 28/264 [00:25<03:16,  1.20it/s] 11%|█         | 29/264 [00:26<03:14,  1.21it/s] 11%|█▏        | 30/264 [00:27<03:11,  1.22it/s] 12%|█▏        | 31/264 [00:27<03:10,  1.22it/s] 12%|█▏        | 32/264 [00:28<03:12,  1.20it/s] 12%|█▎        | 33/264 [00:29<03:20,  1.15it/s] 13%|█▎        | 34/264 [00:30<03:17,  1.16it/s] 13%|█▎        | 35/264 [00:31<03:15,  1.17it/s] 14%|█▎        | 36/264 [00:32<03:14,  1.17it/s] 14%|█▍        | 37/264 [00:32<03:11,  1.18it/s] 14%|█▍        | 38/264 [00:33<03:12,  1.18it/s] 15%|█▍        | 39/264 [00:34<03:08,  1.19it/s] 15%|█▌        | 40/264 [00:35<03:15,  1.15it/s] 16%|█▌        | 41/264 [00:36<03:11,  1.17it/s] 16%|█▌        | 42/264 [00:37<03:15,  1.14it/s] 16%|█▋        | 43/264 [00:38<03:19,  1.11it/s] 17%|█▋        | 44/264 [00:39<03:18,  1.11it/s] 17%|█▋        | 45/264 [00:40<03:19,  1.10it/s] 17%|█▋        | 46/264 [00:40<03:11,  1.14it/s] 18%|█▊        | 47/264 [00:41<03:12,  1.13it/s] 18%|█▊        | 48/264 [00:42<03:13,  1.12it/s] 19%|█▊        | 49/264 [00:43<03:10,  1.13it/s] 19%|█▉        | 50/264 [00:44<03:08,  1.14it/s] 19%|█▉        | 51/264 [00:45<03:01,  1.17it/s] 20%|█▉        | 52/264 [00:46<03:05,  1.14it/s] 20%|██        | 53/264 [00:47<03:06,  1.13it/s] 20%|██        | 54/264 [00:48<03:09,  1.11it/s] 21%|██        | 55/264 [00:48<03:05,  1.12it/s] 21%|██        | 56/264 [00:49<03:01,  1.14it/s] 22%|██▏       | 57/264 [00:50<03:01,  1.14it/s] 22%|██▏       | 58/264 [00:51<03:04,  1.11it/s] 22%|██▏       | 59/264 [00:52<03:03,  1.12it/s] 23%|██▎       | 60/264 [00:53<02:56,  1.16it/s] 23%|██▎       | 61/264 [00:54<02:55,  1.16it/s] 23%|██▎       | 62/264 [00:54<02:50,  1.18it/s] 24%|██▍       | 63/264 [00:55<02:49,  1.19it/s] 24%|██▍       | 64/264 [00:56<02:46,  1.20it/s] 25%|██▍       | 65/264 [00:57<02:55,  1.13it/s] 25%|██▌       | 66/264 [00:58<02:50,  1.16it/s] 25%|██▌       | 67/264 [00:59<02:45,  1.19it/s] 26%|██▌       | 68/264 [01:00<02:43,  1.20it/s] 26%|██▌       | 69/264 [01:00<02:42,  1.20it/s] 27%|██▋       | 70/264 [01:01<02:38,  1.22it/s] 27%|██▋       | 71/264 [01:02<02:39,  1.21it/s] 27%|██▋       | 72/264 [01:03<02:38,  1.21it/s] 28%|██▊       | 73/264 [01:04<02:37,  1.21it/s] 28%|██▊       | 74/264 [01:05<02:50,  1.12it/s] 28%|██▊       | 75/264 [01:05<02:43,  1.16it/s] 29%|██▉       | 76/264 [01:06<02:43,  1.15it/s] 29%|██▉       | 77/264 [01:07<02:46,  1.12it/s] 30%|██▉       | 78/264 [01:08<02:41,  1.15it/s] 30%|██▉       | 79/264 [01:09<02:44,  1.12it/s] 30%|███       | 80/264 [01:10<02:46,  1.10it/s] 31%|███       | 81/264 [01:11<02:40,  1.14it/s] 31%|███       | 82/264 [01:12<02:35,  1.17it/s] 31%|███▏      | 83/264 [01:13<02:40,  1.13it/s] 32%|███▏      | 84/264 [01:13<02:38,  1.14it/s] 32%|███▏      | 85/264 [01:14<02:34,  1.16it/s] 33%|███▎      | 86/264 [01:15<02:33,  1.16it/s] 33%|███▎      | 87/264 [01:16<02:36,  1.13it/s] 33%|███▎      | 88/264 [01:17<02:35,  1.13it/s] 34%|███▎      | 89/264 [01:18<02:35,  1.12it/s] 34%|███▍      | 90/264 [01:19<02:34,  1.12it/s] 34%|███▍      | 91/264 [01:20<02:32,  1.14it/s] 35%|███▍      | 92/264 [01:21<02:33,  1.12it/s] 35%|███▌      | 93/264 [01:21<02:31,  1.13it/s] 36%|███▌      | 94/264 [01:22<02:33,  1.11it/s] 36%|███▌      | 95/264 [01:23<02:32,  1.11it/s] 36%|███▋      | 96/264 [01:24<02:33,  1.10it/s] 37%|███▋      | 97/264 [01:25<02:31,  1.10it/s] 37%|███▋      | 98/264 [01:26<02:34,  1.07it/s] 38%|███▊      | 99/264 [01:27<02:27,  1.12it/s] 38%|███▊      | 100/264 [01:28<02:23,  1.15it/s] 38%|███▊      | 101/264 [01:29<02:20,  1.16it/s] 39%|███▊      | 102/264 [01:29<02:17,  1.18it/s] 39%|███▉      | 103/264 [01:30<02:15,  1.18it/s] 39%|███▉      | 104/264 [01:31<02:19,  1.15it/s] 40%|███▉      | 105/264 [01:32<02:18,  1.15it/s] 40%|████      | 106/264 [01:33<02:13,  1.18it/s] 41%|████      | 107/264 [01:34<02:12,  1.18it/s] 41%|████      | 108/264 [01:34<02:11,  1.19it/s] 41%|████▏     | 109/264 [01:35<02:11,  1.18it/s] 42%|████▏     | 110/264 [01:36<02:09,  1.19it/s] 42%|████▏     | 111/264 [01:37<02:07,  1.20it/s] 42%|████▏     | 112/264 [01:38<02:06,  1.20it/s] 43%|████▎     | 113/264 [01:39<02:05,  1.20it/s] 43%|████▎     | 114/264 [01:39<02:04,  1.20it/s] 44%|████▎     | 115/264 [01:40<02:03,  1.21it/s] 44%|████▍     | 116/264 [01:41<02:02,  1.21it/s] 44%|████▍     | 117/264 [01:42<02:01,  1.21it/s] 45%|████▍     | 118/264 [01:43<02:00,  1.21it/s] 45%|████▌     | 119/264 [01:44<01:59,  1.21it/s] 45%|████▌     | 120/264 [01:44<02:00,  1.20it/s] 46%|████▌     | 121/264 [01:45<01:58,  1.20it/s] 46%|████▌     | 122/264 [01:46<01:58,  1.20it/s] 47%|████▋     | 123/264 [01:47<01:59,  1.18it/s] 47%|████▋     | 124/264 [01:48<01:55,  1.21it/s] 47%|████▋     | 125/264 [01:49<01:55,  1.20it/s] 48%|████▊     | 126/264 [01:49<01:54,  1.21it/s] 48%|████▊     | 127/264 [01:50<01:54,  1.20it/s] 48%|████▊     | 128/264 [01:51<01:52,  1.21it/s] 49%|████▉     | 129/264 [01:52<01:51,  1.21it/s] 49%|████▉     | 130/264 [01:53<01:56,  1.15it/s] 50%|████▉     | 131/264 [01:54<01:59,  1.11it/s] 50%|█████     | 132/264 [01:55<01:54,  1.15it/s] 50%|█████     | 133/264 [01:56<01:56,  1.13it/s] 51%|█████     | 134/264 [01:56<01:52,  1.15it/s] 51%|█████     | 135/264 [01:57<01:50,  1.17it/s] 52%|█████▏    | 136/264 [01:58<01:49,  1.17it/s] 52%|█████▏    | 137/264 [01:59<01:47,  1.19it/s] 52%|█████▏    | 138/264 [02:00<01:47,  1.17it/s] 53%|█████▎    | 139/264 [02:01<01:50,  1.13it/s] 53%|█████▎    | 140/264 [02:01<01:46,  1.16it/s] 53%|█████▎    | 141/264 [02:02<01:48,  1.13it/s] 54%|█████▍    | 142/264 [02:03<01:50,  1.10it/s] 54%|█████▍    | 143/264 [02:04<01:46,  1.14it/s] 55%|█████▍    | 144/264 [02:05<01:45,  1.14it/s] 55%|█████▍    | 145/264 [02:06<01:45,  1.12it/s] 55%|█████▌    | 146/264 [02:07<01:42,  1.15it/s] 56%|█████▌    | 147/264 [02:08<01:39,  1.17it/s] 56%|█████▌    | 148/264 [02:08<01:37,  1.19it/s] 56%|█████▋    | 149/264 [02:09<01:40,  1.15it/s] 57%|█████▋    | 150/264 [02:10<01:36,  1.18it/s] 57%|█████▋    | 151/264 [02:11<01:35,  1.19it/s] 58%|█████▊    | 152/264 [02:12<01:35,  1.17it/s] 58%|█████▊    | 153/264 [02:13<01:38,  1.12it/s] 58%|█████▊    | 154/264 [02:14<01:39,  1.11it/s] 59%|█████▊    | 155/264 [02:15<01:38,  1.11it/s] 59%|█████▉    | 156/264 [02:16<01:36,  1.12it/s] 59%|█████▉    | 157/264 [02:16<01:33,  1.15it/s] 60%|█████▉    | 158/264 [02:17<01:30,  1.17it/s] 60%|██████    | 159/264 [02:18<01:28,  1.19it/s] 61%|██████    | 160/264 [02:19<01:26,  1.20it/s] 61%|██████    | 161/264 [02:20<01:26,  1.20it/s] 61%|██████▏   | 162/264 [02:20<01:24,  1.20it/s] 62%|██████▏   | 163/264 [02:21<01:23,  1.21it/s] 62%|██████▏   | 164/264 [02:22<01:27,  1.15it/s] 62%|██████▎   | 165/264 [02:23<01:23,  1.18it/s] 63%|██████▎   | 166/264 [02:24<01:22,  1.19it/s] 63%|██████▎   | 167/264 [02:25<01:20,  1.20it/s] 64%|██████▎   | 168/264 [02:26<01:19,  1.21it/s] 64%|██████▍   | 169/264 [02:26<01:18,  1.22it/s] 64%|██████▍   | 170/264 [02:27<01:16,  1.22it/s] 65%|██████▍   | 171/264 [02:28<01:19,  1.17it/s] 65%|██████▌   | 172/264 [02:29<01:21,  1.13it/s] 66%|██████▌   | 173/264 [02:30<01:18,  1.17it/s] 66%|██████▌   | 174/264 [02:31<01:18,  1.15it/s] 66%|██████▋   | 175/264 [02:32<01:16,  1.16it/s] 67%|██████▋   | 176/264 [02:32<01:16,  1.15it/s] 67%|██████▋   | 177/264 [02:33<01:16,  1.14it/s] 67%|██████▋   | 178/264 [02:34<01:13,  1.16it/s] 68%|██████▊   | 179/264 [02:35<01:11,  1.20it/s] 68%|██████▊   | 180/264 [02:36<01:10,  1.19it/s] 69%|██████▊   | 181/264 [02:37<01:08,  1.21it/s] 69%|██████▉   | 182/264 [02:37<01:07,  1.22it/s] 69%|██████▉   | 183/264 [02:38<01:06,  1.22it/s] 70%|██████▉   | 184/264 [02:39<01:08,  1.17it/s] 70%|███████   | 185/264 [02:40<01:11,  1.10it/s] 70%|███████   | 186/264 [02:41<01:09,  1.12it/s] 71%|███████   | 187/264 [02:42<01:07,  1.14it/s] 71%|███████   | 188/264 [02:43<01:06,  1.14it/s] 72%|███████▏  | 189/264 [02:44<01:07,  1.11it/s] 72%|███████▏  | 190/264 [02:45<01:05,  1.14it/s] 72%|███████▏  | 191/264 [02:45<01:03,  1.15it/s] 73%|███████▎  | 192/264 [02:46<01:00,  1.19it/s] 73%|███████▎  | 193/264 [02:47<01:02,  1.14it/s] 73%|███████▎  | 194/264 [02:48<01:00,  1.15it/s] 74%|███████▍  | 195/264 [02:49<00:59,  1.17it/s] 74%|███████▍  | 196/264 [02:50<00:59,  1.13it/s] 75%|███████▍  | 197/264 [02:51<01:00,  1.11it/s] 75%|███████▌  | 198/264 [02:52<00:59,  1.11it/s] 75%|███████▌  | 199/264 [02:52<00:58,  1.10it/s] 76%|███████▌  | 200/264 [02:53<00:57,  1.12it/s] 76%|███████▌  | 201/264 [02:54<00:54,  1.16it/s] 77%|███████▋  | 202/264 [02:55<00:52,  1.18it/s] 77%|███████▋  | 203/264 [02:56<00:51,  1.19it/s] 77%|███████▋  | 204/264 [02:57<00:49,  1.21it/s] 78%|███████▊  | 205/264 [02:57<00:48,  1.21it/s] 78%|███████▊  | 206/264 [02:58<00:48,  1.21it/s] 78%|███████▊  | 207/264 [02:59<00:47,  1.21it/s] 79%|███████▉  | 208/264 [03:00<00:47,  1.19it/s] 79%|███████▉  | 209/264 [03:01<00:45,  1.20it/s] 80%|███████▉  | 210/264 [03:02<00:44,  1.21it/s] 80%|███████▉  | 211/264 [03:02<00:43,  1.22it/s] 80%|████████  | 212/264 [03:03<00:42,  1.22it/s] 81%|████████  | 213/264 [03:04<00:41,  1.23it/s] 81%|████████  | 214/264 [03:05<00:40,  1.23it/s] 81%|████████▏ | 215/264 [03:06<00:41,  1.17it/s] 82%|████████▏ | 216/264 [03:07<00:42,  1.14it/s] 82%|████████▏ | 217/264 [03:08<00:40,  1.16it/s] 83%|████████▎ | 218/264 [03:08<00:39,  1.18it/s] 83%|████████▎ | 219/264 [03:09<00:38,  1.16it/s] 83%|████████▎ | 220/264 [03:10<00:38,  1.13it/s] 84%|████████▎ | 221/264 [03:11<00:37,  1.15it/s] 84%|████████▍ | 222/264 [03:12<00:35,  1.17it/s] 84%|████████▍ | 223/264 [03:13<00:35,  1.17it/s] 85%|████████▍ | 224/264 [03:13<00:33,  1.18it/s] 85%|████████▌ | 225/264 [03:14<00:34,  1.14it/s] 86%|████████▌ | 226/264 [03:15<00:32,  1.17it/s] 86%|████████▌ | 227/264 [03:16<00:31,  1.19it/s] 86%|████████▋ | 228/264 [03:17<00:30,  1.19it/s] 87%|████████▋ | 229/264 [03:18<00:28,  1.21it/s] 87%|████████▋ | 230/264 [03:19<00:28,  1.20it/s] 88%|████████▊ | 231/264 [03:19<00:27,  1.20it/s] 88%|████████▊ | 232/264 [03:20<00:26,  1.20it/s] 88%|████████▊ | 233/264 [03:21<00:26,  1.15it/s] 89%|████████▊ | 234/264 [03:22<00:26,  1.13it/s] 89%|████████▉ | 235/264 [03:23<00:24,  1.16it/s] 89%|████████▉ | 236/264 [03:24<00:23,  1.19it/s] 90%|████████▉ | 237/264 [03:25<00:22,  1.19it/s] 90%|█████████ | 238/264 [03:25<00:22,  1.15it/s] 91%|█████████ | 239/264 [03:26<00:21,  1.16it/s] 91%|█████████ | 240/264 [03:27<00:20,  1.15it/s] 91%|█████████▏| 241/264 [03:28<00:20,  1.11it/s] 92%|█████████▏| 242/264 [03:29<00:19,  1.12it/s] 92%|█████████▏| 243/264 [03:30<00:18,  1.16it/s] 92%|█████████▏| 244/264 [03:31<00:17,  1.13it/s] 93%|█████████▎| 245/264 [03:32<00:17,  1.11it/s] 93%|█████████▎| 246/264 [03:33<00:16,  1.10it/s] 94%|█████████▎| 247/264 [03:33<00:15,  1.12it/s] 94%|█████████▍| 248/264 [03:34<00:14,  1.13it/s] 94%|█████████▍| 249/264 [03:35<00:13,  1.13it/s] 95%|█████████▍| 250/264 [03:36<00:12,  1.13it/s] 95%|█████████▌| 251/264 [03:37<00:11,  1.15it/s] 95%|█████████▌| 252/264 [03:38<00:10,  1.16it/s] 96%|█████████▌| 253/264 [03:39<00:09,  1.17it/s] 96%|█████████▌| 254/264 [03:39<00:08,  1.18it/s] 97%|█████████▋| 255/264 [03:40<00:07,  1.16it/s] 97%|█████████▋| 256/264 [03:41<00:06,  1.19it/s] 97%|█████████▋| 257/264 [03:42<00:05,  1.21it/s] 98%|█████████▊| 258/264 [03:43<00:05,  1.16it/s] 98%|█████████▊| 259/264 [03:44<00:04,  1.18it/s] 98%|█████████▊| 260/264 [03:44<00:03,  1.20it/s] 99%|█████████▉| 261/264 [03:45<00:02,  1.24it/s] 99%|█████████▉| 262/264 [03:46<00:01,  1.29it/s]100%|█████████▉| 263/264 [03:47<00:00,  1.31it/s]100%|██████████| 264/264 [03:47<00:00,  1.35it/s]100%|██████████| 264/264 [03:47<00:00,  1.16it/s]Save Model
Save current model ...
[Error] Traceback (most recent call last):
  File "train.py", line 346, in train
    best_model, best_loss, current_model = \
  File "train.py", line 439, in save_model
    model_path = os.path.join(save_dir, current_model)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 328, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 401, in _legacy_save
    pickler.dump(obj)
AttributeError: Can't pickle local object 'train.<locals>.ModelWithLoss'

Can't pickle local object 'train.<locals>.ModelWithLoss'
Step: 2200. Epoch: 8/30. Iteration: 89/264. Cls loss: 141.12778. Reg loss: 0.08853. Total loss: 141.21631
Step 2200: Current Classification Loss:141.127777; Current Regression Loss:0.088528; Current Loss:141.216309;              Average Classification Loss:169.941704; Average Regression Loss:0.069785; Average Loss:170.011489; Current Learning Rate:0.000100.
Save Model
Save current model ...
[Error] Traceback (most recent call last):
  File "train.py", line 346, in train
    best_model, best_loss, current_model = \
  File "train.py", line 439, in save_model
    model_path = os.path.join(save_dir, current_model)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 328, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 401, in _legacy_save
    pickler.dump(obj)
AttributeError: Can't pickle local object 'train.<locals>.ModelWithLoss'

Can't pickle local object 'train.<locals>.ModelWithLoss'
Step: 2300. Epoch: 8/30. Iteration: 189/264. Cls loss: 102.57770. Reg loss: 0.06138. Total loss: 102.63908
Step 2300: Current Classification Loss:102.577698; Current Regression Loss:0.061384; Current Loss:102.639084;              Average Classification Loss:155.227531; Average Regression Loss:0.068091; Average Loss:155.295623; Current Learning Rate:0.000100.

  0%|          | 0/264 [00:00<?, ?it/s]Val. Epoch: 8/30. Classification loss: 59.69906. Regression loss: 0.07699. Total loss: 59.77605
--------------------------------------------After Epoch 8------------------------------------------------
Step 2376: Validation Classification Loss:59.699059; Regression Loss:0.076991; Total Loss:59.776050
----------------------------------------------------------------------------------------------------------
  0%|          | 1/264 [00:02<10:06,  2.31s/it]  1%|          | 2/264 [00:03<08:06,  1.86s/it]  1%|          | 3/264 [00:04<06:51,  1.58s/it]  2%|▏         | 4/264 [00:04<06:00,  1.38s/it]  2%|▏         | 5/264 [00:05<05:20,  1.24s/it]  2%|▏         | 6/264 [00:06<04:52,  1.13s/it]  3%|▎         | 7/264 [00:07<04:29,  1.05s/it]  3%|▎         | 8/264 [00:08<04:10,  1.02it/s]  3%|▎         | 9/264 [00:09<04:04,  1.04it/s]  4%|▍         | 10/264 [00:10<03:59,  1.06it/s]  4%|▍         | 11/264 [00:11<03:56,  1.07it/s]  5%|▍         | 12/264 [00:12<03:54,  1.08it/s]  5%|▍         | 13/264 [00:12<03:48,  1.10it/s]  5%|▌         | 14/264 [00:13<03:46,  1.10it/s]  6%|▌         | 15/264 [00:14<03:40,  1.13it/s]  6%|▌         | 16/264 [00:15<03:34,  1.16it/s]  6%|▋         | 17/264 [00:16<03:31,  1.17it/s]  7%|▋         | 18/264 [00:17<03:27,  1.18it/s]  7%|▋         | 19/264 [00:17<03:24,  1.20it/s]  8%|▊         | 20/264 [00:18<03:22,  1.20it/s]  8%|▊         | 21/264 [00:19<03:24,  1.19it/s]  8%|▊         | 22/264 [00:20<03:21,  1.20it/s]  9%|▊         | 23/264 [00:21<03:28,  1.16it/s]  9%|▉         | 24/264 [00:22<03:33,  1.13it/s]  9%|▉         | 25/264 [00:23<03:31,  1.13it/s] 10%|▉         | 26/264 [00:24<03:31,  1.12it/s] 10%|█         | 27/264 [00:24<03:25,  1.15it/s] 11%|█         | 28/264 [00:25<03:19,  1.19it/s] 11%|█         | 29/264 [00:26<03:16,  1.20it/s] 11%|█▏        | 30/264 [00:27<03:23,  1.15it/s] 12%|█▏        | 31/264 [00:28<03:26,  1.13it/s] 12%|█▏        | 32/264 [00:29<03:31,  1.10it/s] 12%|█▎        | 33/264 [00:30<03:22,  1.14it/s] 13%|█▎        | 34/264 [00:31<03:19,  1.15it/s] 13%|█▎        | 35/264 [00:31<03:16,  1.17it/s] 14%|█▎        | 36/264 [00:32<03:13,  1.18it/s] 14%|█▍        | 37/264 [00:33<03:10,  1.19it/s] 14%|█▍        | 38/264 [00:34<03:07,  1.20it/s] 15%|█▍        | 39/264 [00:35<03:07,  1.20it/s] 15%|█▌        | 40/264 [00:35<03:05,  1.21it/s] 16%|█▌        | 41/264 [00:36<03:04,  1.21it/s] 16%|█▌        | 42/264 [00:37<03:11,  1.16it/s] 16%|█▋        | 43/264 [00:38<03:08,  1.18it/s] 17%|█▋        | 44/264 [00:39<03:10,  1.16it/s] 17%|█▋        | 45/264 [00:40<03:08,  1.16it/s] 17%|█▋        | 46/264 [00:41<03:13,  1.13it/s] 18%|█▊        | 47/264 [00:42<03:13,  1.12it/s] 18%|█▊        | 48/264 [00:43<03:08,  1.14it/s] 19%|█▊        | 49/264 [00:43<03:04,  1.16it/s] 19%|█▉        | 50/264 [00:44<03:05,  1.15it/s] 19%|█▉        | 51/264 [00:45<03:07,  1.14it/s] 20%|█▉        | 52/264 [00:46<03:03,  1.16it/s] 20%|██        | 53/264 [00:47<03:05,  1.14it/s] 20%|██        | 54/264 [00:48<03:03,  1.15it/s] 21%|██        | 55/264 [00:49<02:58,  1.17it/s] 21%|██        | 56/264 [00:49<02:53,  1.20it/s] 22%|██▏       | 57/264 [00:50<03:00,  1.15it/s] 22%|██▏       | 58/264 [00:51<02:56,  1.17it/s] 22%|██▏       | 59/264 [00:52<02:57,  1.15it/s] 23%|██▎       | 60/264 [00:53<02:56,  1.16it/s] 23%|██▎       | 61/264 [00:54<02:58,  1.13it/s] 23%|██▎       | 62/264 [00:55<02:58,  1.13it/s] 24%|██▍       | 63/264 [00:55<02:52,  1.16it/s] 24%|██▍       | 64/264 [00:56<02:57,  1.13it/s] 25%|██▍       | 65/264 [00:57<02:59,  1.11it/s] 25%|██▌       | 66/264 [00:58<02:52,  1.14it/s] 25%|██▌       | 67/264 [00:59<02:50,  1.15it/s] 26%|██▌       | 68/264 [01:00<02:47,  1.17it/s] 26%|██▌       | 69/264 [01:01<02:43,  1.19it/s] 27%|██▋       | 70/264 [01:02<02:49,  1.15it/s] 27%|██▋       | 71/264 [01:02<02:49,  1.14it/s] 27%|██▋       | 72/264 [01:03<02:49,  1.13it/s] 28%|██▊       | 73/264 [01:04<02:49,  1.13it/s] 28%|██▊       | 74/264 [01:05<02:46,  1.14it/s] 28%|██▊       | 75/264 [01:06<02:48,  1.12it/s] 29%|██▉       | 76/264 [01:07<02:48,  1.12it/s] 29%|██▉       | 77/264 [01:08<02:43,  1.14it/s] 30%|██▉       | 78/264 [01:09<02:38,  1.17it/s] 30%|██▉       | 79/264 [01:09<02:36,  1.19it/s] 30%|███       | 80/264 [01:10<02:35,  1.18it/s] 31%|███       | 81/264 [01:11<02:32,  1.20it/s] 31%|███       | 82/264 [01:12<02:38,  1.15it/s] 31%|███▏      | 83/264 [01:13<02:38,  1.14it/s] 32%|███▏      | 84/264 [01:14<02:37,  1.14it/s] 32%|███▏      | 85/264 [01:15<02:33,  1.16it/s] 33%|███▎      | 86/264 [01:15<02:30,  1.18it/s] 33%|███▎      | 87/264 [01:16<02:38,  1.11it/s] 33%|███▎      | 88/264 [01:17<02:32,  1.16it/s] 34%|███▎      | 89/264 [01:18<02:28,  1.18it/s] 34%|███▍      | 90/264 [01:19<02:27,  1.18it/s] 34%|███▍      | 91/264 [01:20<02:24,  1.20it/s] 35%|███▍      | 92/264 [01:21<02:23,  1.20it/s] 35%|███▌      | 93/264 [01:21<02:21,  1.21it/s] 36%|███▌      | 94/264 [01:22<02:20,  1.21it/s] 36%|███▌      | 95/264 [01:23<02:19,  1.21it/s] 36%|███▋      | 96/264 [01:24<02:20,  1.20it/s] 37%|███▋      | 97/264 [01:25<02:23,  1.17it/s] 37%|███▋      | 98/264 [01:26<02:23,  1.16it/s] 38%|███▊      | 99/264 [01:27<02:26,  1.13it/s] 38%|███▊      | 100/264 [01:27<02:23,  1.15it/s] 38%|███▊      | 101/264 [01:28<02:21,  1.15it/s] 39%|███▊      | 102/264 [01:29<02:22,  1.14it/s] 39%|███▉      | 103/264 [01:30<02:16,  1.18it/s] 39%|███▉      | 104/264 [01:31<02:13,  1.20it/s] 40%|███▉      | 105/264 [01:32<02:11,  1.21it/s] 40%|████      | 106/264 [01:33<02:17,  1.15it/s] 41%|████      | 107/264 [01:33<02:18,  1.13it/s] 41%|████      | 108/264 [01:34<02:14,  1.16it/s] 41%|████▏     | 109/264 [01:35<02:13,  1.16it/s] 42%|████▏     | 110/264 [01:36<02:16,  1.13it/s] 42%|████▏     | 111/264 [01:37<02:13,  1.15it/s] 42%|████▏     | 112/264 [01:38<02:10,  1.16it/s] 43%|████▎     | 113/264 [01:39<02:06,  1.19it/s] 43%|████▎     | 114/264 [01:39<02:05,  1.20it/s] 44%|████▎     | 115/264 [01:40<02:03,  1.20it/s] 44%|████▍     | 116/264 [01:41<02:03,  1.20it/s] 44%|████▍     | 117/264 [01:42<02:02,  1.20it/s] 45%|████▍     | 118/264 [01:43<02:01,  1.20it/s] 45%|████▌     | 119/264 [01:43<01:59,  1.21it/s] 45%|████▌     | 120/264 [01:44<02:06,  1.14it/s] 46%|████▌     | 121/264 [01:45<02:02,  1.17it/s] 46%|████▌     | 122/264 [01:46<01:59,  1.18it/s] 47%|████▋     | 123/264 [01:47<02:04,  1.13it/s] 47%|████▋     | 124/264 [01:48<02:05,  1.11it/s] 47%|████▋     | 125/264 [01:49<02:00,  1.16it/s] 48%|████▊     | 126/264 [01:50<02:01,  1.14it/s] 48%|████▊     | 127/264 [01:51<01:57,  1.16it/s] 48%|████▊     | 128/264 [01:51<01:53,  1.20it/s] 49%|████▉     | 129/264 [01:52<01:51,  1.21it/s] 49%|████▉     | 130/264 [01:53<01:49,  1.22it/s] 50%|████▉     | 131/264 [01:54<01:50,  1.20it/s] 50%|█████     | 132/264 [01:55<01:51,  1.18it/s] 50%|█████     | 133/264 [01:55<01:49,  1.20it/s] 51%|█████     | 134/264 [01:56<01:48,  1.20it/s] 51%|█████     | 135/264 [01:57<01:46,  1.21it/s] 52%|█████▏    | 136/264 [01:58<01:47,  1.19it/s] 52%|█████▏    | 137/264 [01:59<01:49,  1.16it/s] 52%|█████▏    | 138/264 [02:00<01:48,  1.16it/s] 53%|█████▎    | 139/264 [02:01<01:45,  1.18it/s] 53%|█████▎    | 140/264 [02:02<01:48,  1.14it/s] 53%|█████▎    | 141/264 [02:02<01:46,  1.16it/s] 54%|█████▍    | 142/264 [02:03<01:49,  1.11it/s] 54%|█████▍    | 143/264 [02:04<01:45,  1.15it/s] 55%|█████▍    | 144/264 [02:05<01:45,  1.14it/s] 55%|█████▍    | 145/264 [02:06<01:45,  1.13it/s] 55%|█████▌    | 146/264 [02:07<01:43,  1.14it/s] 56%|█████▌    | 147/264 [02:08<01:44,  1.12it/s] 56%|█████▌    | 148/264 [02:09<01:40,  1.16it/s] 56%|█████▋    | 149/264 [02:09<01:40,  1.15it/s] 57%|█████▋    | 150/264 [02:10<01:41,  1.13it/s] 57%|█████▋    | 151/264 [02:11<01:41,  1.12it/s] 58%|█████▊    | 152/264 [02:12<01:39,  1.13it/s] 58%|█████▊    | 153/264 [02:13<01:36,  1.15it/s] 58%|█████▊    | 154/264 [02:14<01:34,  1.17it/s] 59%|█████▊    | 155/264 [02:15<01:32,  1.18it/s] 59%|█████▉    | 156/264 [02:15<01:31,  1.18it/s] 59%|█████▉    | 157/264 [02:16<01:29,  1.19it/s] 60%|█████▉    | 158/264 [02:17<01:32,  1.15it/s] 60%|██████    | 159/264 [02:18<01:30,  1.17it/s] 61%|██████    | 160/264 [02:19<01:33,  1.11it/s] 61%|██████    | 161/264 [02:20<01:31,  1.12it/s] 61%|██████▏   | 162/264 [02:21<01:29,  1.14it/s] 62%|██████▏   | 163/264 [02:22<01:30,  1.12it/s] 62%|██████▏   | 164/264 [02:23<01:29,  1.12it/s] 62%|██████▎   | 165/264 [02:23<01:25,  1.16it/s] 63%|██████▎   | 166/264 [02:24<01:23,  1.17it/s] 63%|██████▎   | 167/264 [02:25<01:21,  1.19it/s] 64%|██████▎   | 168/264 [02:26<01:21,  1.18it/s] 64%|██████▍   | 169/264 [02:27<01:23,  1.13it/s] 64%|██████▍   | 170/264 [02:28<01:22,  1.14it/s] 65%|██████▍   | 171/264 [02:28<01:19,  1.17it/s] 65%|██████▌   | 172/264 [02:29<01:18,  1.18it/s] 66%|██████▌   | 173/264 [02:30<01:16,  1.18it/s] 66%|██████▌   | 174/264 [02:31<01:16,  1.18it/s] 66%|██████▋   | 175/264 [02:32<01:15,  1.18it/s] 67%|██████▋   | 176/264 [02:33<01:14,  1.19it/s] 67%|██████▋   | 177/264 [02:34<01:14,  1.17it/s] 67%|██████▋   | 178/264 [02:34<01:14,  1.16it/s] 68%|██████▊   | 179/264 [02:35<01:13,  1.15it/s] 68%|██████▊   | 180/264 [02:36<01:13,  1.15it/s] 69%|██████▊   | 181/264 [02:37<01:10,  1.17it/s] 69%|██████▉   | 182/264 [02:38<01:09,  1.18it/s] 69%|██████▉   | 183/264 [02:39<01:07,  1.20it/s] 70%|██████▉   | 184/264 [02:40<01:06,  1.19it/s] 70%|███████   | 185/264 [02:40<01:05,  1.21it/s] 70%|███████   | 186/264 [02:41<01:06,  1.18it/s] 71%|███████   | 187/264 [02:42<01:06,  1.17it/s] 71%|███████   | 188/264 [02:43<01:03,  1.19it/s] 72%|███████▏  | 189/264 [02:44<01:03,  1.18it/s] 72%|███████▏  | 190/264 [02:45<01:01,  1.20it/s] 72%|███████▏  | 191/264 [02:46<01:03,  1.15it/s] 73%|███████▎  | 192/264 [02:46<01:00,  1.18it/s] 73%|███████▎  | 193/264 [02:47<00:59,  1.20it/s] 73%|███████▎  | 194/264 [02:48<00:58,  1.20it/s] 74%|███████▍  | 195/264 [02:49<00:57,  1.21it/s] 74%|███████▍  | 196/264 [02:50<00:55,  1.22it/s] 75%|███████▍  | 197/264 [02:50<00:56,  1.19it/s] 75%|███████▌  | 198/264 [02:51<00:54,  1.20it/s] 75%|███████▌  | 199/264 [02:52<00:53,  1.21it/s] 76%|███████▌  | 200/264 [02:53<00:52,  1.22it/s] 76%|███████▌  | 201/264 [02:54<00:51,  1.23it/s] 77%|███████▋  | 202/264 [02:54<00:50,  1.23it/s] 77%|███████▋  | 203/264 [02:55<00:49,  1.23it/s] 77%|███████▋  | 204/264 [02:56<00:48,  1.23it/s] 78%|███████▊  | 205/264 [02:57<00:48,  1.22it/s] 78%|███████▊  | 206/264 [02:58<00:47,  1.22it/s] 78%|███████▊  | 207/264 [02:59<00:46,  1.23it/s] 79%|███████▉  | 208/264 [02:59<00:46,  1.21it/s] 79%|███████▉  | 209/264 [03:00<00:45,  1.22it/s] 80%|███████▉  | 210/264 [03:01<00:44,  1.23it/s] 80%|███████▉  | 211/264 [03:02<00:43,  1.22it/s] 80%|████████  | 212/264 [03:03<00:42,  1.22it/s] 81%|████████  | 213/264 [03:04<00:42,  1.21it/s] 81%|████████  | 214/264 [03:04<00:41,  1.22it/s] 81%|████████▏ | 215/264 [03:05<00:40,  1.22it/s] 82%|████████▏ | 216/264 [03:06<00:39,  1.22it/s] 82%|████████▏ | 217/264 [03:07<00:38,  1.22it/s] 83%|████████▎ | 218/264 [03:08<00:37,  1.23it/s] 83%|████████▎ | 219/264 [03:08<00:37,  1.20it/s] 83%|████████▎ | 220/264 [03:09<00:37,  1.16it/s] 84%|████████▎ | 221/264 [03:10<00:36,  1.19it/s] 84%|████████▍ | 222/264 [03:11<00:35,  1.20it/s] 84%|████████▍ | 223/264 [03:12<00:35,  1.15it/s] 85%|████████▍ | 224/264 [03:13<00:34,  1.17it/s] 85%|████████▌ | 225/264 [03:14<00:33,  1.18it/s] 86%|████████▌ | 226/264 [03:14<00:31,  1.19it/s] 86%|████████▌ | 227/264 [03:15<00:30,  1.21it/s] 86%|████████▋ | 228/264 [03:16<00:29,  1.21it/s] 87%|████████▋ | 229/264 [03:17<00:28,  1.21it/s] 87%|████████▋ | 230/264 [03:18<00:30,  1.11it/s] 88%|████████▊ | 231/264 [03:19<00:28,  1.16it/s] 88%|████████▊ | 232/264 [03:20<00:27,  1.17it/s] 88%|████████▊ | 233/264 [03:21<00:27,  1.13it/s] 89%|████████▊ | 234/264 [03:21<00:25,  1.16it/s] 89%|████████▉ | 235/264 [03:22<00:24,  1.18it/s] 89%|████████▉ | 236/264 [03:23<00:23,  1.19it/s] 90%|████████▉ | 237/264 [03:24<00:22,  1.20it/s] 90%|█████████ | 238/264 [03:25<00:21,  1.21it/s] 91%|█████████ | 239/264 [03:25<00:20,  1.21it/s] 91%|█████████ | 240/264 [03:26<00:21,  1.14it/s] 91%|█████████▏| 241/264 [03:27<00:20,  1.14it/s] 92%|█████████▏| 242/264 [03:28<00:18,  1.17it/s] 92%|█████████▏| 243/264 [03:29<00:18,  1.14it/s] 92%|█████████▏| 244/264 [03:30<00:17,  1.12it/s] 93%|█████████▎| 245/264 [03:31<00:17,  1.11it/s] 93%|█████████▎| 246/264 [03:32<00:16,  1.12it/s] 94%|█████████▎| 247/264 [03:33<00:14,  1.14it/s] 94%|█████████▍| 248/264 [03:33<00:14,  1.14it/s] 94%|█████████▍| 249/264 [03:34<00:13,  1.15it/s] 95%|█████████▍| 250/264 [03:35<00:12,  1.16it/s] 95%|█████████▌| 251/264 [03:36<00:10,  1.19it/s] 95%|█████████▌| 252/264 [03:37<00:10,  1.19it/s] 96%|█████████▌| 253/264 [03:38<00:09,  1.20it/s] 96%|█████████▌| 254/264 [03:38<00:08,  1.19it/s] 97%|█████████▋| 255/264 [03:39<00:07,  1.20it/s] 97%|█████████▋| 256/264 [03:40<00:06,  1.15it/s] 97%|█████████▋| 257/264 [03:41<00:06,  1.16it/s] 98%|█████████▊| 258/264 [03:42<00:05,  1.19it/s] 98%|█████████▊| 259/264 [03:43<00:04,  1.20it/s] 98%|█████████▊| 260/264 [03:44<00:03,  1.14it/s] 99%|█████████▉| 261/264 [03:44<00:02,  1.21it/s] 99%|█████████▉| 262/264 [03:45<00:01,  1.26it/s]100%|█████████▉| 263/264 [03:46<00:00,  1.30it/s]100%|██████████| 264/264 [03:47<00:00,  1.33it/s]100%|██████████| 264/264 [03:47<00:00,  1.16it/s]Save Model
Save current model ...
[Error] Traceback (most recent call last):
  File "train.py", line 346, in train
    best_model, best_loss, current_model = \
  File "train.py", line 439, in save_model
    model_path = os.path.join(save_dir, current_model)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 328, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 401, in _legacy_save
    pickler.dump(obj)
AttributeError: Can't pickle local object 'train.<locals>.ModelWithLoss'

Can't pickle local object 'train.<locals>.ModelWithLoss'
Step: 2400. Epoch: 9/30. Iteration: 25/264. Cls loss: 77.90865. Reg loss: 0.09346. Total loss: 78.00211
Step 2400: Current Classification Loss:77.908646; Current Regression Loss:0.093460; Current Loss:78.002106;              Average Classification Loss:111.818299; Average Regression Loss:0.064210; Average Loss:111.882509; Current Learning Rate:0.000100.
Save Model
Save current model ...
[Error] Traceback (most recent call last):
  File "train.py", line 346, in train
    best_model, best_loss, current_model = \
  File "train.py", line 439, in save_model
    model_path = os.path.join(save_dir, current_model)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 328, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 401, in _legacy_save
    pickler.dump(obj)
AttributeError: Can't pickle local object 'train.<locals>.ModelWithLoss'

Can't pickle local object 'train.<locals>.ModelWithLoss'
Step: 2500. Epoch: 9/30. Iteration: 125/264. Cls loss: 152.14604. Reg loss: 0.03983. Total loss: 152.18587
Step 2500: Current Classification Loss:152.146042; Current Regression Loss:0.039831; Current Loss:152.185867;              Average Classification Loss:108.639433; Average Regression Loss:0.063483; Average Loss:108.702916; Current Learning Rate:0.000100.
Save Model
Save current model ...
[Error] Traceback (most recent call last):
  File "train.py", line 346, in train
    best_model, best_loss, current_model = \
  File "train.py", line 439, in save_model
    model_path = os.path.join(save_dir, current_model)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 328, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 401, in _legacy_save
    pickler.dump(obj)
AttributeError: Can't pickle local object 'train.<locals>.ModelWithLoss'

Can't pickle local object 'train.<locals>.ModelWithLoss'
Step: 2600. Epoch: 9/30. Iteration: 225/264. Cls loss: 121.02219. Reg loss: 0.03011. Total loss: 121.05231
Step 2600: Current Classification Loss:121.022194; Current Regression Loss:0.030110; Current Loss:121.052307;              Average Classification Loss:103.882610; Average Regression Loss:0.063587; Average Loss:103.946197; Current Learning Rate:0.000100.

  0%|          | 0/264 [00:00<?, ?it/s]Val. Epoch: 9/30. Classification loss: 43.40164. Regression loss: 0.06995. Total loss: 43.47160
--------------------------------------------After Epoch 9------------------------------------------------
Step 2640: Validation Classification Loss:43.401644; Regression Loss:0.069952; Total Loss:43.471596
----------------------------------------------------------------------------------------------------------
  0%|          | 1/264 [00:01<08:27,  1.93s/it]  1%|          | 2/264 [00:02<07:02,  1.61s/it]  1%|          | 3/264 [00:03<06:04,  1.40s/it]  2%|▏         | 4/264 [00:04<05:23,  1.24s/it]  2%|▏         | 5/264 [00:05<05:01,  1.16s/it]  2%|▏         | 6/264 [00:06<04:36,  1.07s/it]  3%|▎         | 7/264 [00:07<04:25,  1.03s/it]  3%|▎         | 8/264 [00:08<04:17,  1.01s/it]  3%|▎         | 9/264 [00:09<04:04,  1.04it/s]  4%|▍         | 10/264 [00:10<04:02,  1.05it/s]  4%|▍         | 11/264 [00:10<03:55,  1.08it/s]  5%|▍         | 12/264 [00:11<03:50,  1.09it/s]  5%|▍         | 13/264 [00:12<03:41,  1.13it/s]  5%|▌         | 14/264 [00:13<03:46,  1.10it/s]  6%|▌         | 15/264 [00:14<03:45,  1.10it/s]  6%|▌         | 16/264 [00:15<03:37,  1.14it/s]  6%|▋         | 17/264 [00:16<03:29,  1.18it/s]  7%|▋         | 18/264 [00:16<03:28,  1.18it/s]  7%|▋         | 19/264 [00:17<03:25,  1.19it/s]  8%|▊         | 20/264 [00:18<03:23,  1.20it/s]  8%|▊         | 21/264 [00:19<03:26,  1.18it/s]  8%|▊         | 22/264 [00:20<03:21,  1.20it/s]  9%|▊         | 23/264 [00:21<03:19,  1.21it/s]  9%|▉         | 24/264 [00:21<03:18,  1.21it/s]  9%|▉         | 25/264 [00:22<03:18,  1.20it/s] 10%|▉         | 26/264 [00:23<03:19,  1.20it/s] 10%|█         | 27/264 [00:24<03:26,  1.15it/s] 11%|█         | 28/264 [00:25<03:25,  1.15it/s] 11%|█         | 29/264 [00:26<03:28,  1.13it/s] 11%|█▏        | 30/264 [00:27<03:26,  1.13it/s] 12%|█▏        | 31/264 [00:28<03:22,  1.15it/s] 12%|█▏        | 32/264 [00:28<03:20,  1.16it/s] 12%|█▎        | 33/264 [00:29<03:16,  1.18it/s] 13%|█▎        | 34/264 [00:30<03:14,  1.18it/s] 13%|█▎        | 35/264 [00:31<03:12,  1.19it/s] 14%|█▎        | 36/264 [00:32<03:10,  1.20it/s] 14%|█▍        | 37/264 [00:33<03:14,  1.17it/s] 14%|█▍        | 38/264 [00:33<03:09,  1.19it/s] 15%|█▍        | 39/264 [00:34<03:06,  1.21it/s] 15%|█▌        | 40/264 [00:35<03:04,  1.21it/s] 16%|█▌        | 41/264 [00:36<03:03,  1.22it/s] 16%|█▌        | 42/264 [00:37<03:03,  1.21it/s] 16%|█▋        | 43/264 [00:38<03:11,  1.16it/s] 17%|█▋        | 44/264 [00:39<03:09,  1.16it/s] 17%|█▋        | 45/264 [00:39<03:04,  1.19it/s] 17%|█▋        | 46/264 [00:40<03:10,  1.14it/s] 18%|█▊        | 47/264 [00:41<03:06,  1.16it/s] 18%|█▊        | 48/264 [00:42<03:02,  1.19it/s] 19%|█▊        | 49/264 [00:43<02:59,  1.20it/s] 19%|█▉        | 50/264 [00:44<02:56,  1.21it/s] 19%|█▉        | 51/264 [00:44<02:58,  1.20it/s] 20%|█▉        | 52/264 [00:45<03:00,  1.17it/s] 20%|██        | 53/264 [00:46<02:57,  1.19it/s] 20%|██        | 54/264 [00:47<02:59,  1.17it/s] 21%|██        | 55/264 [00:48<02:56,  1.18it/s] 21%|██        | 56/264 [00:49<02:54,  1.19it/s] 22%|██▏       | 57/264 [00:49<02:51,  1.21it/s] 22%|██▏       | 58/264 [00:50<02:53,  1.19it/s] 22%|██▏       | 59/264 [00:51<02:59,  1.14it/s] 23%|██▎       | 60/264 [00:52<03:01,  1.12it/s] 23%|██▎       | 61/264 [00:53<02:54,  1.16it/s] 23%|██▎       | 62/264 [00:54<02:52,  1.17it/s] 24%|██▍       | 63/264 [00:55<02:54,  1.15it/s] 24%|██▍       | 64/264 [00:56<02:49,  1.18it/s] 25%|██▍       | 65/264 [00:56<02:49,  1.18it/s] 25%|██▌       | 66/264 [00:57<02:48,  1.18it/s] 25%|██▌       | 67/264 [00:58<02:46,  1.18it/s] 26%|██▌       | 68/264 [00:59<02:45,  1.18it/s] 26%|██▌       | 69/264 [01:00<02:42,  1.20it/s] 27%|██▋       | 70/264 [01:01<02:40,  1.21it/s] 27%|██▋       | 71/264 [01:01<02:46,  1.16it/s] 27%|██▋       | 72/264 [01:02<02:44,  1.17it/s] 28%|██▊       | 73/264 [01:03<02:45,  1.15it/s] 28%|██▊       | 74/264 [01:04<02:46,  1.14it/s] 28%|██▊       | 75/264 [01:05<02:41,  1.17it/s] 29%|██▉       | 76/264 [01:06<02:41,  1.16it/s] 29%|██▉       | 77/264 [01:07<02:39,  1.18it/s] 30%|██▉       | 78/264 [01:07<02:36,  1.19it/s] 30%|██▉       | 79/264 [01:08<02:35,  1.19it/s] 30%|███       | 80/264 [01:09<02:32,  1.20it/s] 31%|███       | 81/264 [01:10<02:33,  1.20it/s] 31%|███       | 82/264 [01:11<02:31,  1.20it/s] 31%|███▏      | 83/264 [01:12<02:30,  1.21it/s] 32%|███▏      | 84/264 [01:12<02:35,  1.16it/s] 32%|███▏      | 85/264 [01:13<02:35,  1.15it/s] 33%|███▎      | 86/264 [01:14<02:31,  1.17it/s] 33%|███▎      | 87/264 [01:15<02:29,  1.18it/s] 33%|███▎      | 88/264 [01:16<02:26,  1.20it/s] 34%|███▎      | 89/264 [01:17<02:25,  1.20it/s] 34%|███▍      | 90/264 [01:17<02:24,  1.20it/s] 34%|███▍      | 91/264 [01:18<02:27,  1.18it/s] 35%|███▍      | 92/264 [01:19<02:25,  1.18it/s] 35%|███▌      | 93/264 [01:20<02:21,  1.21it/s] 36%|███▌      | 94/264 [01:21<02:25,  1.17it/s] 36%|███▌      | 95/264 [01:22<02:21,  1.19it/s] 36%|███▋      | 96/264 [01:23<02:21,  1.19it/s] 37%|███▋      | 97/264 [01:23<02:19,  1.20it/s] 37%|███▋      | 98/264 [01:24<02:20,  1.18it/s] 38%|███▊      | 99/264 [01:25<02:17,  1.20it/s] 38%|███▊      | 100/264 [01:26<02:21,  1.16it/s] 38%|███▊      | 101/264 [01:27<02:22,  1.15it/s] 39%|███▊      | 102/264 [01:28<02:22,  1.14it/s] 39%|███▉      | 103/264 [01:29<02:18,  1.16it/s] 39%|███▉      | 104/264 [01:29<02:19,  1.15it/s] 40%|███▉      | 105/264 [01:30<02:15,  1.17it/s] 40%|████      | 106/264 [01:31<02:13,  1.19it/s] 41%|████      | 107/264 [01:32<02:11,  1.20it/s] 41%|████      | 108/264 [01:33<02:10,  1.20it/s] 41%|████▏     | 109/264 [01:34<02:11,  1.18it/s] 42%|████▏     | 110/264 [01:34<02:09,  1.19it/s] 42%|████▏     | 111/264 [01:35<02:13,  1.14it/s] 42%|████▏     | 112/264 [01:36<02:11,  1.16it/s] 43%|████▎     | 113/264 [01:37<02:09,  1.17it/s] 43%|████▎     | 114/264 [01:38<02:05,  1.20it/s] 44%|████▎     | 115/264 [01:39<02:03,  1.20it/s] 44%|████▍     | 116/264 [01:39<02:01,  1.22it/s] 44%|████▍     | 117/264 [01:40<02:00,  1.22it/s] 45%|████▍     | 118/264 [01:41<01:59,  1.22it/s] 45%|████▌     | 119/264 [01:42<01:58,  1.23it/s] 45%|████▌     | 120/264 [01:43<01:58,  1.22it/s] 46%|████▌     | 121/264 [01:44<01:56,  1.23it/s] 46%|████▌     | 122/264 [01:44<01:55,  1.23it/s] 47%|████▋     | 123/264 [01:45<01:54,  1.23it/s] 47%|████▋     | 124/264 [01:46<01:53,  1.23it/s] 47%|████▋     | 125/264 [01:47<01:53,  1.23it/s] 48%|████▊     | 126/264 [01:48<01:54,  1.21it/s] 48%|████▊     | 127/264 [01:48<01:52,  1.21it/s] 48%|████▊     | 128/264 [01:49<01:51,  1.22it/s] 49%|████▉     | 129/264 [01:50<01:50,  1.22it/s] 49%|████▉     | 130/264 [01:51<01:56,  1.15it/s] 50%|████▉     | 131/264 [01:52<01:55,  1.15it/s] 50%|█████     | 132/264 [01:53<01:51,  1.18it/s] 50%|█████     | 133/264 [01:54<01:49,  1.20it/s] 51%|█████     | 134/264 [01:54<01:48,  1.20it/s] 51%|█████     | 135/264 [01:55<01:46,  1.21it/s] 52%|█████▏    | 136/264 [01:56<01:50,  1.16it/s] 52%|█████▏    | 137/264 [01:57<01:48,  1.17it/s] 52%|█████▏    | 138/264 [01:58<01:49,  1.15it/s] 53%|█████▎    | 139/264 [01:59<01:48,  1.15it/s] 53%|█████▎    | 140/264 [02:00<01:50,  1.12it/s] 53%|█████▎    | 141/264 [02:00<01:46,  1.16it/s] 54%|█████▍    | 142/264 [02:02<01:51,  1.10it/s] 54%|█████▍    | 143/264 [02:02<01:45,  1.15it/s] 55%|█████▍    | 144/264 [02:03<01:43,  1.16it/s] 55%|█████▍    | 145/264 [02:04<01:40,  1.18it/s] 55%|█████▌    | 146/264 [02:05<01:38,  1.20it/s] 56%|█████▌    | 147/264 [02:06<01:37,  1.20it/s] 56%|█████▌    | 148/264 [02:06<01:36,  1.21it/s] 56%|█████▋    | 149/264 [02:07<01:34,  1.21it/s] 57%|█████▋    | 150/264 [02:08<01:33,  1.22it/s] 57%|█████▋    | 151/264 [02:09<01:37,  1.16it/s] 58%|█████▊    | 152/264 [02:10<01:34,  1.18it/s] 58%|█████▊    | 153/264 [02:11<01:34,  1.18it/s] 58%|█████▊    | 154/264 [02:11<01:31,  1.20it/s] 59%|█████▊    | 155/264 [02:12<01:36,  1.13it/s] 59%|█████▉    | 156/264 [02:13<01:32,  1.16it/s] 59%|█████▉    | 157/264 [02:14<01:30,  1.18it/s] 60%|█████▉    | 158/264 [02:15<01:28,  1.20it/s] 60%|██████    | 159/264 [02:16<01:27,  1.20it/s] 61%|██████    | 160/264 [02:17<01:26,  1.20it/s] 61%|██████    | 161/264 [02:17<01:26,  1.20it/s] 61%|██████▏   | 162/264 [02:18<01:24,  1.21it/s] 62%|██████▏   | 163/264 [02:19<01:27,  1.15it/s] 62%|██████▏   | 164/264 [02:20<01:26,  1.16it/s] 62%|██████▎   | 165/264 [02:21<01:24,  1.17it/s] 63%|██████▎   | 166/264 [02:22<01:22,  1.19it/s] 63%|██████▎   | 167/264 [02:23<01:24,  1.15it/s] 64%|██████▎   | 168/264 [02:23<01:21,  1.18it/s] 64%|██████▍   | 169/264 [02:24<01:18,  1.21it/s] 64%|██████▍   | 170/264 [02:25<01:21,  1.16it/s] 65%|██████▍   | 171/264 [02:26<01:18,  1.18it/s] 65%|██████▌   | 172/264 [02:27<01:16,  1.20it/s] 66%|██████▌   | 173/264 [02:28<01:19,  1.15it/s] 66%|██████▌   | 174/264 [02:29<01:17,  1.16it/s] 66%|██████▋   | 175/264 [02:29<01:18,  1.13it/s] 67%|██████▋   | 176/264 [02:30<01:15,  1.17it/s] 67%|██████▋   | 177/264 [02:31<01:13,  1.18it/s] 67%|██████▋   | 178/264 [02:32<01:14,  1.15it/s] 68%|██████▊   | 179/264 [02:33<01:12,  1.17it/s] 68%|██████▊   | 180/264 [02:34<01:11,  1.18it/s] 69%|██████▊   | 181/264 [02:34<01:09,  1.20it/s] 69%|██████▉   | 182/264 [02:35<01:12,  1.14it/s] 69%|██████▉   | 183/264 [02:36<01:11,  1.13it/s] 70%|██████▉   | 184/264 [02:37<01:11,  1.12it/s] 70%|███████   | 185/264 [02:38<01:09,  1.14it/s] 70%|███████   | 186/264 [02:39<01:10,  1.11it/s] 71%|███████   | 187/264 [02:40<01:06,  1.15it/s] 71%|███████   | 188/264 [02:41<01:05,  1.17it/s] 72%|███████▏  | 189/264 [02:41<01:03,  1.18it/s] 72%|███████▏  | 190/264 [02:42<01:06,  1.12it/s] 72%|███████▏  | 191/264 [02:43<01:03,  1.15it/s] 73%|███████▎  | 192/264 [02:44<01:04,  1.12it/s] 73%|███████▎  | 193/264 [02:45<01:03,  1.12it/s] 73%|███████▎  | 194/264 [02:46<01:00,  1.15it/s] 74%|███████▍  | 195/264 [02:47<01:01,  1.12it/s] 74%|███████▍  | 196/264 [02:48<00:58,  1.16it/s] 75%|███████▍  | 197/264 [02:49<00:59,  1.12it/s] 75%|███████▌  | 198/264 [02:49<00:56,  1.16it/s] 75%|███████▌  | 199/264 [02:50<00:55,  1.18it/s] 76%|███████▌  | 200/264 [02:51<00:53,  1.19it/s] 76%|███████▌  | 201/264 [02:52<00:53,  1.18it/s] 77%|███████▋  | 202/264 [02:53<00:53,  1.16it/s] 77%|███████▋  | 203/264 [02:54<00:53,  1.14it/s] 77%|███████▋  | 204/264 [02:55<00:51,  1.17it/s] 78%|███████▊  | 205/264 [02:55<00:49,  1.19it/s] 78%|███████▊  | 206/264 [02:56<00:48,  1.20it/s] 78%|███████▊  | 207/264 [02:57<00:49,  1.16it/s] 79%|███████▉  | 208/264 [02:58<00:50,  1.12it/s] 79%|███████▉  | 209/264 [02:59<00:47,  1.16it/s] 80%|███████▉  | 210/264 [03:00<00:47,  1.14it/s] 80%|███████▉  | 211/264 [03:01<00:45,  1.16it/s] 80%|████████  | 212/264 [03:01<00:44,  1.18it/s] 81%|████████  | 213/264 [03:02<00:43,  1.16it/s] 81%|████████  | 214/264 [03:03<00:44,  1.13it/s] 81%|████████▏ | 215/264 [03:04<00:43,  1.12it/s] 82%|████████▏ | 216/264 [03:05<00:41,  1.15it/s] 82%|████████▏ | 217/264 [03:06<00:39,  1.18it/s] 83%|████████▎ | 218/264 [03:07<00:39,  1.17it/s] 83%|████████▎ | 219/264 [03:07<00:38,  1.18it/s] 83%|████████▎ | 220/264 [03:08<00:36,  1.19it/s] 84%|████████▎ | 221/264 [03:09<00:35,  1.20it/s] 84%|████████▍ | 222/264 [03:10<00:35,  1.19it/s] 84%|████████▍ | 223/264 [03:11<00:35,  1.15it/s] 85%|████████▍ | 224/264 [03:12<00:35,  1.13it/s] 85%|████████▌ | 225/264 [03:13<00:33,  1.16it/s] 86%|████████▌ | 226/264 [03:13<00:32,  1.17it/s] 86%|████████▌ | 227/264 [03:14<00:31,  1.16it/s] 86%|████████▋ | 228/264 [03:15<00:30,  1.18it/s] 87%|████████▋ | 229/264 [03:16<00:30,  1.15it/s] 87%|████████▋ | 230/264 [03:17<00:29,  1.16it/s] 88%|████████▊ | 231/264 [03:18<00:27,  1.18it/s] 88%|████████▊ | 232/264 [03:19<00:27,  1.16it/s] 88%|████████▊ | 233/264 [03:19<00:26,  1.17it/s] 89%|████████▊ | 234/264 [03:20<00:25,  1.19it/s] 89%|████████▉ | 235/264 [03:21<00:24,  1.20it/s] 89%|████████▉ | 236/264 [03:22<00:23,  1.20it/s] 90%|████████▉ | 237/264 [03:23<00:22,  1.21it/s] 90%|█████████ | 238/264 [03:24<00:21,  1.21it/s] 91%|█████████ | 239/264 [03:25<00:21,  1.15it/s] 91%|█████████ | 240/264 [03:25<00:20,  1.16it/s] 91%|█████████▏| 241/264 [03:26<00:20,  1.13it/s] 92%|█████████▏| 242/264 [03:27<00:19,  1.15it/s] 92%|█████████▏| 243/264 [03:28<00:17,  1.18it/s] 92%|█████████▏| 244/264 [03:29<00:16,  1.20it/s] 93%|█████████▎| 245/264 [03:30<00:15,  1.20it/s] 93%|█████████▎| 246/264 [03:31<00:15,  1.15it/s] 94%|█████████▎| 247/264 [03:31<00:14,  1.15it/s] 94%|█████████▍| 248/264 [03:32<00:14,  1.13it/s] 94%|█████████▍| 249/264 [03:33<00:13,  1.13it/s] 95%|█████████▍| 250/264 [03:34<00:12,  1.15it/s] 95%|█████████▌| 251/264 [03:35<00:11,  1.17it/s] 95%|█████████▌| 252/264 [03:36<00:10,  1.12it/s] 96%|█████████▌| 253/264 [03:37<00:09,  1.13it/s] 96%|█████████▌| 254/264 [03:38<00:08,  1.13it/s] 97%|█████████▋| 255/264 [03:38<00:07,  1.16it/s] 97%|█████████▋| 256/264 [03:39<00:07,  1.13it/s] 97%|█████████▋| 257/264 [03:40<00:06,  1.15it/s] 98%|█████████▊| 258/264 [03:41<00:05,  1.12it/s] 98%|█████████▊| 259/264 [03:42<00:04,  1.13it/s] 98%|█████████▊| 260/264 [03:43<00:03,  1.14it/s] 99%|█████████▉| 261/264 [03:44<00:02,  1.21it/s] 99%|█████████▉| 262/264 [03:44<00:01,  1.27it/s]100%|█████████▉| 263/264 [03:45<00:00,  1.30it/s]100%|██████████| 264/264 [03:46<00:00,  1.34it/s]100%|██████████| 264/264 [03:46<00:00,  1.17it/s]Save Model
Save current model ...
[Error] Traceback (most recent call last):
  File "train.py", line 346, in train
    best_model, best_loss, current_model = \
  File "train.py", line 439, in save_model
    model_path = os.path.join(save_dir, current_model)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 328, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 401, in _legacy_save
    pickler.dump(obj)
AttributeError: Can't pickle local object 'train.<locals>.ModelWithLoss'

Can't pickle local object 'train.<locals>.ModelWithLoss'
Step: 2700. Epoch: 10/30. Iteration: 61/264. Cls loss: 97.59959. Reg loss: 0.01675. Total loss: 97.61634
Step 2700: Current Classification Loss:97.599594; Current Regression Loss:0.016750; Current Loss:97.616341;              Average Classification Loss:79.384043; Average Regression Loss:0.057232; Average Loss:79.441275; Current Learning Rate:0.000100.
Save Model
Save current model ...
[Error] Traceback (most recent call last):
  File "train.py", line 346, in train
    best_model, best_loss, current_model = \
  File "train.py", line 439, in save_model
    model_path = os.path.join(save_dir, current_model)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 328, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 401, in _legacy_save
    pickler.dump(obj)
AttributeError: Can't pickle local object 'train.<locals>.ModelWithLoss'

Can't pickle local object 'train.<locals>.ModelWithLoss'
Step: 2800. Epoch: 10/30. Iteration: 161/264. Cls loss: 64.96510. Reg loss: 0.08204. Total loss: 65.04713
Step 2800: Current Classification Loss:64.965096; Current Regression Loss:0.082036; Current Loss:65.047134;              Average Classification Loss:74.966578; Average Regression Loss:0.060423; Average Loss:75.027001; Current Learning Rate:0.000100.
Save Model
Save current model ...
[Error] Traceback (most recent call last):
  File "train.py", line 346, in train
    best_model, best_loss, current_model = \
  File "train.py", line 439, in save_model
    model_path = os.path.join(save_dir, current_model)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 328, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 401, in _legacy_save
    pickler.dump(obj)
AttributeError: Can't pickle local object 'train.<locals>.ModelWithLoss'

Can't pickle local object 'train.<locals>.ModelWithLoss'
Step: 2900. Epoch: 10/30. Iteration: 261/264. Cls loss: 76.61156. Reg loss: 0.05069. Total loss: 76.66226
Step 2900: Current Classification Loss:76.611565; Current Regression Loss:0.050694; Current Loss:76.662262;              Average Classification Loss:70.587738; Average Regression Loss:0.061197; Average Loss:70.648936; Current Learning Rate:0.000100.

  0%|          | 0/264 [00:00<?, ?it/s]Val. Epoch: 10/30. Classification loss: 31.10932. Regression loss: 0.07039. Total loss: 31.17970
--------------------------------------------After Epoch 10------------------------------------------------
Step 2904: Validation Classification Loss:31.109317; Regression Loss:0.070387; Total Loss:31.179704
----------------------------------------------------------------------------------------------------------
  0%|          | 1/264 [00:02<08:46,  2.00s/it]  1%|          | 2/264 [00:02<07:20,  1.68s/it]  1%|          | 3/264 [00:03<06:22,  1.47s/it]  2%|▏         | 4/264 [00:04<05:37,  1.30s/it]  2%|▏         | 5/264 [00:05<05:12,  1.21s/it]  2%|▏         | 6/264 [00:06<04:50,  1.12s/it]  3%|▎         | 7/264 [00:07<04:31,  1.05s/it]  3%|▎         | 8/264 [00:08<04:17,  1.01s/it]  3%|▎         | 9/264 [00:09<04:01,  1.05it/s]  4%|▍         | 10/264 [00:10<03:59,  1.06it/s]  4%|▍         | 11/264 [00:11<03:54,  1.08it/s]  5%|▍         | 12/264 [00:11<03:45,  1.12it/s]  5%|▍         | 13/264 [00:12<03:42,  1.13it/s]  5%|▌         | 14/264 [00:13<03:40,  1.14it/s]  6%|▌         | 15/264 [00:14<03:32,  1.17it/s]  6%|▌         | 16/264 [00:15<03:28,  1.19it/s]  6%|▋         | 17/264 [00:16<03:26,  1.20it/s]  7%|▋         | 18/264 [00:16<03:23,  1.21it/s]  7%|▋         | 19/264 [00:17<03:22,  1.21it/s]  8%|▊         | 20/264 [00:18<03:19,  1.22it/s]  8%|▊         | 21/264 [00:19<03:22,  1.20it/s]  8%|▊         | 22/264 [00:20<03:20,  1.21it/s]  9%|▊         | 23/264 [00:21<03:18,  1.21it/s]  9%|▉         | 24/264 [00:21<03:17,  1.22it/s]  9%|▉         | 25/264 [00:22<03:16,  1.21it/s] 10%|▉         | 26/264 [00:23<03:24,  1.17it/s] 10%|█         | 27/264 [00:24<03:25,  1.15it/s] 11%|█         | 28/264 [00:25<03:28,  1.13it/s] 11%|█         | 29/264 [00:26<03:21,  1.17it/s] 11%|█▏        | 30/264 [00:27<03:17,  1.19it/s] 12%|█▏        | 31/264 [00:27<03:15,  1.19it/s] 12%|█▏        | 32/264 [00:28<03:17,  1.18it/s] 12%|█▎        | 33/264 [00:29<03:13,  1.19it/s] 13%|█▎        | 34/264 [00:30<03:13,  1.19it/s] 13%|█▎        | 35/264 [00:31<03:11,  1.20it/s] 14%|█▎        | 36/264 [00:32<03:09,  1.21it/s] 14%|█▍        | 37/264 [00:32<03:15,  1.16it/s] 14%|█▍        | 38/264 [00:33<03:19,  1.14it/s] 15%|█▍        | 39/264 [00:34<03:13,  1.16it/s] 15%|█▌        | 40/264 [00:35<03:16,  1.14it/s] 16%|█▌        | 41/264 [00:36<03:16,  1.13it/s] 16%|█▌        | 42/264 [00:37<03:16,  1.13it/s] 16%|█▋        | 43/264 [00:38<03:15,  1.13it/s] 17%|█▋        | 44/264 [00:39<03:09,  1.16it/s] 17%|█▋        | 45/264 [00:39<03:04,  1.19it/s] 17%|█▋        | 46/264 [00:40<03:07,  1.17it/s] 18%|█▊        | 47/264 [00:41<03:10,  1.14it/s] 18%|█▊        | 48/264 [00:42<03:12,  1.12it/s] 19%|█▊        | 49/264 [00:43<03:05,  1.16it/s] 19%|█▉        | 50/264 [00:44<03:09,  1.13it/s] 19%|█▉        | 51/264 [00:45<03:03,  1.16it/s] 20%|█▉        | 52/264 [00:45<02:58,  1.19it/s] 20%|██        | 53/264 [00:46<02:55,  1.20it/s] 20%|██        | 54/264 [00:47<02:57,  1.19it/s] 21%|██        | 55/264 [00:48<02:55,  1.19it/s] 21%|██        | 56/264 [00:49<03:00,  1.15it/s] 22%|██▏       | 57/264 [00:50<02:57,  1.17it/s] 22%|██▏       | 58/264 [00:51<02:57,  1.16it/s] 22%|██▏       | 59/264 [00:52<02:56,  1.16it/s] 23%|██▎       | 60/264 [00:52<02:54,  1.17it/s] 23%|██▎       | 61/264 [00:53<02:50,  1.19it/s] 23%|██▎       | 62/264 [00:54<02:49,  1.19it/s] 24%|██▍       | 63/264 [00:55<02:53,  1.16it/s] 24%|██▍       | 64/264 [00:56<02:55,  1.14it/s] 25%|██▍       | 65/264 [00:57<02:55,  1.14it/s] 25%|██▌       | 66/264 [00:58<02:51,  1.15it/s] 25%|██▌       | 67/264 [00:58<02:48,  1.17it/s] 26%|██▌       | 68/264 [00:59<02:48,  1.17it/s] 26%|██▌       | 69/264 [01:00<02:52,  1.13it/s] 27%|██▋       | 70/264 [01:01<02:45,  1.18it/s] 27%|██▋       | 71/264 [01:02<02:47,  1.16it/s] 27%|██▋       | 72/264 [01:03<02:44,  1.17it/s] 28%|██▊       | 73/264 [01:04<02:42,  1.17it/s] 28%|██▊       | 74/264 [01:04<02:39,  1.19it/s] 28%|██▊       | 75/264 [01:05<02:39,  1.19it/s] 29%|██▉       | 76/264 [01:06<02:43,  1.15it/s] 29%|██▉       | 77/264 [01:07<02:44,  1.13it/s] 30%|██▉       | 78/264 [01:08<02:44,  1.13it/s] 30%|██▉       | 79/264 [01:09<02:39,  1.16it/s] 30%|███       | 80/264 [01:10<02:37,  1.17it/s] 31%|███       | 81/264 [01:10<02:35,  1.18it/s] 31%|███       | 82/264 [01:11<02:32,  1.20it/s] 31%|███▏      | 83/264 [01:12<02:30,  1.20it/s] 32%|███▏      | 84/264 [01:13<02:28,  1.21it/s] 32%|███▏      | 85/264 [01:14<02:26,  1.22it/s] 33%|███▎      | 86/264 [01:14<02:24,  1.23it/s] 33%|███▎      | 87/264 [01:15<02:26,  1.21it/s] 33%|███▎      | 88/264 [01:16<02:24,  1.22it/s] 34%|███▎      | 89/264 [01:17<02:30,  1.16it/s] 34%|███▍      | 90/264 [01:18<02:26,  1.19it/s] 34%|███▍      | 91/264 [01:19<02:23,  1.20it/s] 35%|███▍      | 92/264 [01:19<02:22,  1.21it/s] 35%|███▌      | 93/264 [01:20<02:21,  1.21it/s] 36%|███▌      | 94/264 [01:21<02:21,  1.20it/s] 36%|███▌      | 95/264 [01:22<02:23,  1.17it/s] 36%|███▋      | 96/264 [01:23<02:23,  1.17it/s] 37%|███▋      | 97/264 [01:24<02:22,  1.17it/s] 37%|███▋      | 98/264 [01:25<02:23,  1.16it/s] 38%|███▊      | 99/264 [01:25<02:20,  1.18it/s] 38%|███▊      | 100/264 [01:26<02:18,  1.19it/s] 38%|███▊      | 101/264 [01:27<02:17,  1.19it/s] 39%|███▊      | 102/264 [01:28<02:18,  1.17it/s] 39%|███▉      | 103/264 [01:29<02:16,  1.18it/s] 39%|███▉      | 104/264 [01:30<02:13,  1.20it/s] 40%|███▉      | 105/264 [01:30<02:12,  1.20it/s] 40%|████      | 106/264 [01:31<02:10,  1.21it/s] 41%|████      | 107/264 [01:32<02:09,  1.21it/s] 41%|████      | 108/264 [01:33<02:13,  1.16it/s] 41%|████▏     | 109/264 [01:34<02:20,  1.11it/s] 42%|████▏     | 110/264 [01:35<02:15,  1.14it/s] 42%|████▏     | 111/264 [01:36<02:11,  1.17it/s] 42%|████▏     | 112/264 [01:37<02:09,  1.18it/s] 43%|████▎     | 113/264 [01:37<02:06,  1.19it/s] 43%|████▎     | 114/264 [01:38<02:05,  1.20it/s] 44%|████▎     | 115/264 [01:39<02:08,  1.16it/s] 44%|████▍     | 116/264 [01:40<02:07,  1.16it/s] 44%|████▍     | 117/264 [01:41<02:08,  1.14it/s] 45%|████▍     | 118/264 [01:42<02:03,  1.18it/s] 45%|████▌     | 119/264 [01:43<02:04,  1.16it/s] 45%|████▌     | 120/264 [01:43<02:08,  1.12it/s] 46%|████▌     | 121/264 [01:44<02:03,  1.16it/s] 46%|████▌     | 122/264 [01:45<02:05,  1.13it/s] 47%|████▋     | 123/264 [01:46<02:02,  1.15it/s] 47%|████▋     | 124/264 [01:47<02:04,  1.13it/s] 47%|████▋     | 125/264 [01:48<02:05,  1.11it/s] 48%|████▊     | 126/264 [01:49<02:01,  1.14it/s] 48%|████▊     | 127/264 [01:50<01:57,  1.17it/s] 48%|████▊     | 128/264 [01:50<01:57,  1.16it/s] 49%|████▉     | 129/264 [01:51<01:57,  1.15it/s] 49%|████▉     | 130/264 [01:52<01:59,  1.12it/s] 50%|████▉     | 131/264 [01:53<02:00,  1.10it/s] 50%|█████     | 132/264 [01:54<01:55,  1.14it/s] 50%|█████     | 133/264 [01:55<01:57,  1.12it/s] 51%|█████     | 134/264 [01:56<01:53,  1.15it/s] 51%|█████     | 135/264 [01:57<01:50,  1.17it/s] 52%|█████▏    | 136/264 [01:57<01:48,  1.19it/s] 52%|█████▏    | 137/264 [01:58<01:45,  1.20it/s] 52%|█████▏    | 138/264 [01:59<01:44,  1.21it/s] 53%|█████▎    | 139/264 [02:00<01:42,  1.22it/s] 53%|█████▎    | 140/264 [02:01<01:46,  1.16it/s] 53%|█████▎    | 141/264 [02:02<01:43,  1.18it/s] 54%|█████▍    | 142/264 [02:03<01:47,  1.13it/s] 54%|█████▍    | 143/264 [02:03<01:42,  1.18it/s] 55%|█████▍    | 144/264 [02:04<01:45,  1.13it/s] 55%|█████▍    | 145/264 [02:05<01:46,  1.11it/s] 55%|█████▌    | 146/264 [02:06<01:47,  1.10it/s] 56%|█████▌    | 147/264 [02:07<01:42,  1.14it/s] 56%|█████▌    | 148/264 [02:08<01:42,  1.13it/s] 56%|█████▋    | 149/264 [02:09<01:39,  1.16it/s] 57%|█████▋    | 150/264 [02:10<01:40,  1.14it/s] 57%|█████▋    | 151/264 [02:10<01:38,  1.15it/s] 58%|█████▊    | 152/264 [02:11<01:35,  1.18it/s] 58%|█████▊    | 153/264 [02:12<01:33,  1.19it/s] 58%|█████▊    | 154/264 [02:13<01:31,  1.21it/s] 59%|█████▊    | 155/264 [02:14<01:30,  1.21it/s] 59%|█████▉    | 156/264 [02:15<01:29,  1.21it/s] 59%|█████▉    | 157/264 [02:15<01:28,  1.21it/s] 60%|█████▉    | 158/264 [02:16<01:26,  1.22it/s] 60%|██████    | 159/264 [02:17<01:31,  1.15it/s] 61%|██████    | 160/264 [02:18<01:28,  1.18it/s] 61%|██████    | 161/264 [02:19<01:26,  1.20it/s] 61%|██████▏   | 162/264 [02:20<01:27,  1.16it/s] 62%|██████▏   | 163/264 [02:20<01:25,  1.17it/s] 62%|██████▏   | 164/264 [02:21<01:25,  1.17it/s] 62%|██████▎   | 165/264 [02:22<01:23,  1.18it/s] 63%|██████▎   | 166/264 [02:23<01:21,  1.20it/s] 63%|██████▎   | 167/264 [02:24<01:22,  1.18it/s] 64%|██████▎   | 168/264 [02:25<01:21,  1.18it/s] 64%|██████▍   | 169/264 [02:26<01:21,  1.16it/s] 64%|██████▍   | 170/264 [02:27<01:22,  1.14it/s] 65%|██████▍   | 171/264 [02:27<01:21,  1.15it/s] 65%|██████▌   | 172/264 [02:28<01:20,  1.14it/s] 66%|██████▌   | 173/264 [02:29<01:18,  1.16it/s] 66%|██████▌   | 174/264 [02:30<01:17,  1.16it/s] 66%|██████▋   | 175/264 [02:31<01:16,  1.16it/s] 67%|██████▋   | 176/264 [02:32<01:13,  1.20it/s] 67%|██████▋   | 177/264 [02:32<01:11,  1.21it/s] 67%|██████▋   | 178/264 [02:33<01:11,  1.21it/s] 68%|██████▊   | 179/264 [02:34<01:12,  1.18it/s] 68%|██████▊   | 180/264 [02:35<01:10,  1.19it/s] 69%|██████▊   | 181/264 [02:36<01:09,  1.19it/s] 69%|██████▉   | 182/264 [02:37<01:08,  1.20it/s] 69%|██████▉   | 183/264 [02:38<01:09,  1.17it/s] 70%|██████▉   | 184/264 [02:38<01:08,  1.17it/s] 70%|███████   | 185/264 [02:39<01:07,  1.17it/s] 70%|███████   | 186/264 [02:40<01:06,  1.17it/s] 71%|███████   | 187/264 [02:41<01:04,  1.19it/s] 71%|███████   | 188/264 [02:42<01:03,  1.20it/s] 72%|███████▏  | 189/264 [02:43<01:01,  1.21it/s] 72%|███████▏  | 190/264 [02:43<01:00,  1.22it/s] 72%|███████▏  | 191/264 [02:44<00:59,  1.22it/s] 73%|███████▎  | 192/264 [02:45<00:59,  1.22it/s] 73%|███████▎  | 193/264 [02:46<01:00,  1.17it/s] 73%|███████▎  | 194/264 [02:47<00:58,  1.20it/s] 74%|███████▍  | 195/264 [02:47<00:56,  1.22it/s] 74%|███████▍  | 196/264 [02:48<00:55,  1.22it/s] 75%|███████▍  | 197/264 [02:49<00:57,  1.16it/s] 75%|███████▌  | 198/264 [02:50<00:58,  1.13it/s] 75%|███████▌  | 199/264 [02:51<00:57,  1.13it/s] 76%|███████▌  | 200/264 [02:52<00:57,  1.12it/s] 76%|███████▌  | 201/264 [02:53<00:55,  1.14it/s] 77%|███████▋  | 202/264 [02:54<00:54,  1.14it/s] 77%|███████▋  | 203/264 [02:55<00:53,  1.13it/s] 77%|███████▋  | 204/264 [02:55<00:53,  1.13it/s] 78%|███████▊  | 205/264 [02:56<00:51,  1.15it/s] 78%|███████▊  | 206/264 [02:57<00:50,  1.16it/s] 78%|███████▊  | 207/264 [02:58<00:48,  1.17it/s] 79%|███████▉  | 208/264 [02:59<00:47,  1.18it/s] 79%|███████▉  | 209/264 [03:00<00:46,  1.19it/s] 80%|███████▉  | 210/264 [03:00<00:45,  1.19it/s] 80%|███████▉  | 211/264 [03:01<00:44,  1.20it/s] 80%|████████  | 212/264 [03:02<00:43,  1.20it/s] 81%|████████  | 213/264 [03:03<00:42,  1.20it/s] 81%|████████  | 214/264 [03:04<00:41,  1.20it/s] 81%|████████▏ | 215/264 [03:05<00:40,  1.20it/s] 82%|████████▏ | 216/264 [03:05<00:39,  1.20it/s] 82%|████████▏ | 217/264 [03:06<00:38,  1.21it/s] 83%|████████▎ | 218/264 [03:07<00:39,  1.15it/s] 83%|████████▎ | 219/264 [03:08<00:40,  1.12it/s] 83%|████████▎ | 220/264 [03:09<00:38,  1.15it/s] 84%|████████▎ | 221/264 [03:10<00:37,  1.15it/s] 84%|████████▍ | 222/264 [03:11<00:35,  1.18it/s] 84%|████████▍ | 223/264 [03:12<00:34,  1.19it/s] 85%|████████▍ | 224/264 [03:12<00:33,  1.19it/s] 85%|████████▌ | 225/264 [03:13<00:33,  1.15it/s] 86%|████████▌ | 226/264 [03:14<00:33,  1.14it/s] 86%|████████▌ | 227/264 [03:15<00:32,  1.12it/s] 86%|████████▋ | 228/264 [03:16<00:31,  1.16it/s] 87%|████████▋ | 229/264 [03:17<00:29,  1.18it/s] 87%|████████▋ | 230/264 [03:18<00:28,  1.17it/s] 88%|████████▊ | 231/264 [03:18<00:27,  1.19it/s] 88%|████████▊ | 232/264 [03:19<00:26,  1.20it/s] 88%|████████▊ | 233/264 [03:20<00:26,  1.15it/s] 89%|████████▊ | 234/264 [03:21<00:26,  1.14it/s] 89%|████████▉ | 235/264 [03:22<00:25,  1.15it/s] 89%|████████▉ | 236/264 [03:23<00:23,  1.18it/s] 90%|████████▉ | 237/264 [03:24<00:22,  1.19it/s] 90%|█████████ | 238/264 [03:24<00:22,  1.16it/s] 91%|█████████ | 239/264 [03:25<00:21,  1.15it/s] 91%|█████████ | 240/264 [03:26<00:20,  1.15it/s] 91%|█████████▏| 241/264 [03:27<00:20,  1.14it/s] 92%|█████████▏| 242/264 [03:28<00:18,  1.17it/s] 92%|█████████▏| 243/264 [03:29<00:17,  1.19it/s] 92%|█████████▏| 244/264 [03:30<00:16,  1.21it/s] 93%|█████████▎| 245/264 [03:30<00:15,  1.21it/s] 93%|█████████▎| 246/264 [03:31<00:14,  1.21it/s] 94%|█████████▎| 247/264 [03:32<00:14,  1.17it/s] 94%|█████████▍| 248/264 [03:33<00:13,  1.15it/s] 94%|█████████▍| 249/264 [03:34<00:12,  1.18it/s] 95%|█████████▍| 250/264 [03:35<00:11,  1.18it/s] 95%|█████████▌| 251/264 [03:35<00:11,  1.18it/s] 95%|█████████▌| 252/264 [03:36<00:10,  1.14it/s] 96%|█████████▌| 253/264 [03:37<00:09,  1.16it/s] 96%|█████████▌| 254/264 [03:38<00:08,  1.15it/s] 97%|█████████▋| 255/264 [03:39<00:07,  1.17it/s] 97%|█████████▋| 256/264 [03:40<00:06,  1.16it/s] 97%|█████████▋| 257/264 [03:41<00:05,  1.18it/s] 98%|█████████▊| 258/264 [03:42<00:05,  1.16it/s] 98%|█████████▊| 259/264 [03:42<00:04,  1.15it/s] 98%|█████████▊| 260/264 [03:43<00:03,  1.16it/s] 99%|█████████▉| 261/264 [03:44<00:02,  1.22it/s] 99%|█████████▉| 262/264 [03:45<00:01,  1.28it/s]100%|█████████▉| 263/264 [03:45<00:00,  1.31it/s]100%|██████████| 264/264 [03:46<00:00,  1.35it/s]100%|██████████| 264/264 [03:46<00:00,  1.16it/s]Save Model
Save current model ...
[Error] Traceback (most recent call last):
  File "train.py", line 346, in train
    best_model, best_loss, current_model = \
  File "train.py", line 439, in save_model
    model_path = os.path.join(save_dir, current_model)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 328, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 401, in _legacy_save
    pickler.dump(obj)
AttributeError: Can't pickle local object 'train.<locals>.ModelWithLoss'

Can't pickle local object 'train.<locals>.ModelWithLoss'
Step: 3000. Epoch: 11/30. Iteration: 97/264. Cls loss: 42.01285. Reg loss: 0.07013. Total loss: 42.08298
Step 3000: Current Classification Loss:42.012848; Current Regression Loss:0.070129; Current Loss:42.082977;              Average Classification Loss:60.292791; Average Regression Loss:0.057651; Average Loss:60.350442; Current Learning Rate:0.000100.
Save Model
Save current model ...
[Error] Traceback (most recent call last):
  File "train.py", line 346, in train
    best_model, best_loss, current_model = \
  File "train.py", line 439, in save_model
    model_path = os.path.join(save_dir, current_model)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 328, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 401, in _legacy_save
    pickler.dump(obj)
AttributeError: Can't pickle local object 'train.<locals>.ModelWithLoss'

Can't pickle local object 'train.<locals>.ModelWithLoss'
Step: 3100. Epoch: 11/30. Iteration: 197/264. Cls loss: 64.77587. Reg loss: 0.03276. Total loss: 64.80863
Step 3100: Current Classification Loss:64.775871; Current Regression Loss:0.032759; Current Loss:64.808632;              Average Classification Loss:54.196251; Average Regression Loss:0.060280; Average Loss:54.256531; Current Learning Rate:0.000100.

  0%|          | 0/264 [00:00<?, ?it/s]Val. Epoch: 11/30. Classification loss: 24.00884. Regression loss: 0.06942. Total loss: 24.07827
--------------------------------------------After Epoch 11------------------------------------------------
Step 3168: Validation Classification Loss:24.008844; Regression Loss:0.069421; Total Loss:24.078265
----------------------------------------------------------------------------------------------------------
  0%|          | 1/264 [00:02<09:19,  2.13s/it]  1%|          | 2/264 [00:03<07:42,  1.77s/it]  1%|          | 3/264 [00:04<06:37,  1.52s/it]  2%|▏         | 4/264 [00:04<05:48,  1.34s/it]  2%|▏         | 5/264 [00:05<05:17,  1.23s/it]  2%|▏         | 6/264 [00:06<04:54,  1.14s/it]  3%|▎         | 7/264 [00:07<04:34,  1.07s/it]  3%|▎         | 8/264 [00:08<04:20,  1.02s/it]  3%|▎         | 9/264 [00:09<04:09,  1.02it/s]  4%|▍         | 10/264 [00:10<04:06,  1.03it/s]  4%|▍         | 11/264 [00:11<03:51,  1.09it/s]  5%|▍         | 12/264 [00:12<03:51,  1.09it/s]  5%|▍         | 13/264 [00:13<03:47,  1.10it/s]  5%|▌         | 14/264 [00:13<03:42,  1.13it/s]  6%|▌         | 15/264 [00:14<03:34,  1.16it/s]  6%|▌         | 16/264 [00:15<03:32,  1.17it/s]  6%|▋         | 17/264 [00:16<03:28,  1.19it/s]  7%|▋         | 18/264 [00:17<03:25,  1.20it/s]  7%|▋         | 19/264 [00:17<03:23,  1.20it/s]  8%|▊         | 20/264 [00:18<03:25,  1.19it/s]  8%|▊         | 21/264 [00:19<03:33,  1.14it/s]  8%|▊         | 22/264 [00:20<03:28,  1.16it/s]  9%|▊         | 23/264 [00:21<03:30,  1.14it/s]  9%|▉         | 24/264 [00:22<03:25,  1.17it/s]  9%|▉         | 25/264 [00:23<03:21,  1.19it/s] 10%|▉         | 26/264 [00:23<03:18,  1.20it/s] 10%|█         | 27/264 [00:24<03:15,  1.21it/s] 11%|█         | 28/264 [00:25<03:15,  1.21it/s] 11%|█         | 29/264 [00:26<03:23,  1.16it/s] 11%|█▏        | 30/264 [00:27<03:18,  1.18it/s] 12%|█▏        | 31/264 [00:28<03:15,  1.19it/s] 12%|█▏        | 32/264 [00:29<03:17,  1.18it/s] 12%|█▎        | 33/264 [00:29<03:13,  1.19it/s] 13%|█▎        | 34/264 [00:30<03:10,  1.21it/s] 13%|█▎        | 35/264 [00:31<03:10,  1.20it/s] 14%|█▎        | 36/264 [00:32<03:11,  1.19it/s] 14%|█▍        | 37/264 [00:33<03:08,  1.20it/s] 14%|█▍        | 38/264 [00:34<03:07,  1.21it/s] 15%|█▍        | 39/264 [00:34<03:05,  1.21it/s] 15%|█▌        | 40/264 [00:35<03:04,  1.22it/s] 16%|█▌        | 41/264 [00:36<03:02,  1.22it/s] 16%|█▌        | 42/264 [00:37<03:03,  1.21it/s] 16%|█▋        | 43/264 [00:38<03:04,  1.20it/s] 17%|█▋        | 44/264 [00:39<03:11,  1.15it/s] 17%|█▋        | 45/264 [00:40<03:13,  1.13it/s] 17%|█▋        | 46/264 [00:40<03:17,  1.10it/s] 18%|█▊        | 47/264 [00:41<03:10,  1.14it/s] 18%|█▊        | 48/264 [00:42<03:05,  1.17it/s] 19%|█▊        | 49/264 [00:43<03:03,  1.17it/s] 19%|█▉        | 50/264 [00:44<03:00,  1.18it/s] 19%|█▉        | 51/264 [00:45<02:58,  1.19it/s] 20%|█▉        | 52/264 [00:46<03:04,  1.15it/s] 20%|██        | 53/264 [00:46<03:05,  1.14it/s] 20%|██        | 54/264 [00:47<03:02,  1.15it/s] 21%|██        | 55/264 [00:48<03:06,  1.12it/s] 21%|██        | 56/264 [00:49<02:59,  1.16it/s] 22%|██▏       | 57/264 [00:50<03:00,  1.15it/s] 22%|██▏       | 58/264 [00:51<02:58,  1.15it/s] 22%|██▏       | 59/264 [00:52<02:58,  1.15it/s] 23%|██▎       | 60/264 [00:53<02:57,  1.15it/s] 23%|██▎       | 61/264 [00:53<02:54,  1.16it/s] 23%|██▎       | 62/264 [00:54<02:51,  1.18it/s] 24%|██▍       | 63/264 [00:55<02:50,  1.18it/s] 24%|██▍       | 64/264 [00:56<02:49,  1.18it/s] 25%|██▍       | 65/264 [00:57<02:48,  1.18it/s] 25%|██▌       | 66/264 [00:58<02:47,  1.18it/s] 25%|██▌       | 67/264 [00:58<02:45,  1.19it/s] 26%|██▌       | 68/264 [00:59<02:43,  1.20it/s] 26%|██▌       | 69/264 [01:00<02:41,  1.21it/s] 27%|██▋       | 70/264 [01:01<02:39,  1.22it/s] 27%|██▋       | 71/264 [01:02<02:38,  1.22it/s] 27%|██▋       | 72/264 [01:02<02:37,  1.22it/s] 28%|██▊       | 73/264 [01:03<02:35,  1.23it/s] 28%|██▊       | 74/264 [01:04<02:34,  1.23it/s] 28%|██▊       | 75/264 [01:05<02:33,  1.23it/s] 29%|██▉       | 76/264 [01:06<02:35,  1.21it/s] 29%|██▉       | 77/264 [01:07<02:33,  1.22it/s] 30%|██▉       | 78/264 [01:08<02:39,  1.17it/s] 30%|██▉       | 79/264 [01:08<02:39,  1.16it/s] 30%|███       | 80/264 [01:09<02:39,  1.16it/s] 31%|███       | 81/264 [01:10<02:38,  1.15it/s] 31%|███       | 82/264 [01:11<02:39,  1.14it/s] 31%|███▏      | 83/264 [01:12<02:40,  1.13it/s] 32%|███▏      | 84/264 [01:13<02:44,  1.10it/s] 32%|███▏      | 85/264 [01:14<02:40,  1.11it/s] 33%|███▎      | 86/264 [01:15<02:35,  1.15it/s] 33%|███▎      | 87/264 [01:15<02:32,  1.16it/s] 33%|███▎      | 88/264 [01:16<02:34,  1.14it/s] 34%|███▎      | 89/264 [01:17<02:28,  1.18it/s] 34%|███▍      | 90/264 [01:18<02:32,  1.14it/s] 34%|███▍      | 91/264 [01:19<02:34,  1.12it/s] 35%|███▍      | 92/264 [01:20<02:28,  1.16it/s] 35%|███▌      | 93/264 [01:21<02:24,  1.19it/s] 36%|███▌      | 94/264 [01:22<02:28,  1.15it/s] 36%|███▌      | 95/264 [01:22<02:28,  1.14it/s] 36%|███▋      | 96/264 [01:23<02:24,  1.16it/s] 37%|███▋      | 97/264 [01:24<02:26,  1.14it/s] 37%|███▋      | 98/264 [01:25<02:26,  1.14it/s] 38%|███▊      | 99/264 [01:26<02:26,  1.13it/s] 38%|███▊      | 100/264 [01:27<02:23,  1.14it/s] 38%|███▊      | 101/264 [01:28<02:24,  1.13it/s] 39%|███▊      | 102/264 [01:29<02:24,  1.12it/s] 39%|███▉      | 103/264 [01:30<02:24,  1.11it/s] 39%|███▉      | 104/264 [01:30<02:24,  1.11it/s] 40%|███▉      | 105/264 [01:31<02:24,  1.10it/s] 40%|████      | 106/264 [01:32<02:19,  1.14it/s] 41%|████      | 107/264 [01:33<02:18,  1.13it/s] 41%|████      | 108/264 [01:34<02:14,  1.16it/s] 41%|████▏     | 109/264 [01:35<02:13,  1.16it/s] 42%|████▏     | 110/264 [01:36<02:10,  1.18it/s] 42%|████▏     | 111/264 [01:36<02:07,  1.20it/s] 42%|████▏     | 112/264 [01:37<02:06,  1.20it/s] 43%|████▎     | 113/264 [01:38<02:04,  1.21it/s] 43%|████▎     | 114/264 [01:39<02:03,  1.21it/s] 44%|████▎     | 115/264 [01:40<02:02,  1.22it/s] 44%|████▍     | 116/264 [01:40<02:01,  1.22it/s] 44%|████▍     | 117/264 [01:41<02:00,  1.22it/s] 45%|████▍     | 118/264 [01:42<01:59,  1.22it/s] 45%|████▌     | 119/264 [01:43<01:58,  1.22it/s] 45%|████▌     | 120/264 [01:44<02:07,  1.13it/s] 46%|████▌     | 121/264 [01:45<02:02,  1.17it/s] 46%|████▌     | 122/264 [01:46<01:58,  1.20it/s] 47%|████▋     | 123/264 [01:46<01:58,  1.19it/s] 47%|████▋     | 124/264 [01:47<02:01,  1.16it/s] 47%|████▋     | 125/264 [01:48<02:02,  1.14it/s] 48%|████▊     | 126/264 [01:49<01:58,  1.17it/s] 48%|████▊     | 127/264 [01:50<02:00,  1.14it/s] 48%|████▊     | 128/264 [01:51<01:59,  1.14it/s] 49%|████▉     | 129/264 [01:52<01:55,  1.17it/s] 49%|████▉     | 130/264 [01:52<01:53,  1.18it/s] 50%|████▉     | 131/264 [01:53<01:52,  1.18it/s] 50%|█████     | 132/264 [01:54<01:50,  1.20it/s] 50%|█████     | 133/264 [01:55<01:48,  1.20it/s] 51%|█████     | 134/264 [01:56<01:52,  1.15it/s] 51%|█████     | 135/264 [01:57<01:51,  1.15it/s] 52%|█████▏    | 136/264 [01:58<01:48,  1.18it/s] 52%|█████▏    | 137/264 [01:58<01:45,  1.20it/s] 52%|█████▏    | 138/264 [01:59<01:45,  1.19it/s] 53%|█████▎    | 139/264 [02:00<01:48,  1.15it/s] 53%|█████▎    | 140/264 [02:01<01:47,  1.15it/s] 53%|█████▎    | 141/264 [02:02<01:46,  1.15it/s] 54%|█████▍    | 142/264 [02:03<01:50,  1.11it/s] 54%|█████▍    | 143/264 [02:04<01:45,  1.14it/s] 55%|█████▍    | 144/264 [02:04<01:42,  1.17it/s] 55%|█████▍    | 145/264 [02:05<01:39,  1.19it/s] 55%|█████▌    | 146/264 [02:06<01:37,  1.21it/s] 56%|█████▌    | 147/264 [02:07<01:36,  1.21it/s] 56%|█████▌    | 148/264 [02:08<01:35,  1.22it/s] 56%|█████▋    | 149/264 [02:09<01:34,  1.22it/s] 57%|█████▋    | 150/264 [02:09<01:33,  1.22it/s] 57%|█████▋    | 151/264 [02:10<01:32,  1.22it/s] 58%|█████▊    | 152/264 [02:11<01:31,  1.22it/s] 58%|█████▊    | 153/264 [02:12<01:32,  1.20it/s] 58%|█████▊    | 154/264 [02:13<01:33,  1.17it/s] 59%|█████▊    | 155/264 [02:14<01:34,  1.15it/s] 59%|█████▉    | 156/264 [02:15<01:35,  1.14it/s] 59%|█████▉    | 157/264 [02:15<01:34,  1.13it/s] 60%|█████▉    | 158/264 [02:16<01:32,  1.15it/s] 60%|██████    | 159/264 [02:17<01:30,  1.17it/s] 61%|██████    | 160/264 [02:18<01:28,  1.18it/s] 61%|██████    | 161/264 [02:19<01:27,  1.18it/s] 61%|██████▏   | 162/264 [02:20<01:26,  1.18it/s] 62%|██████▏   | 163/264 [02:20<01:25,  1.18it/s] 62%|██████▏   | 164/264 [02:21<01:25,  1.17it/s] 62%|██████▎   | 165/264 [02:22<01:25,  1.16it/s] 63%|██████▎   | 166/264 [02:23<01:25,  1.14it/s] 63%|██████▎   | 167/264 [02:24<01:24,  1.15it/s] 64%|██████▎   | 168/264 [02:25<01:23,  1.15it/s] 64%|██████▍   | 169/264 [02:26<01:20,  1.18it/s] 64%|██████▍   | 170/264 [02:26<01:18,  1.20it/s] 65%|██████▍   | 171/264 [02:27<01:17,  1.20it/s] 65%|██████▌   | 172/264 [02:28<01:16,  1.20it/s] 66%|██████▌   | 173/264 [02:29<01:15,  1.21it/s] 66%|██████▌   | 174/264 [02:30<01:14,  1.21it/s] 66%|██████▋   | 175/264 [02:31<01:14,  1.19it/s] 67%|██████▋   | 176/264 [02:31<01:13,  1.20it/s] 67%|██████▋   | 177/264 [02:32<01:12,  1.21it/s] 67%|██████▋   | 178/264 [02:33<01:13,  1.17it/s] 68%|██████▊   | 179/264 [02:34<01:11,  1.19it/s] 68%|██████▊   | 180/264 [02:35<01:12,  1.16it/s] 69%|██████▊   | 181/264 [02:36<01:11,  1.16it/s] 69%|██████▉   | 182/264 [02:37<01:09,  1.19it/s] 69%|██████▉   | 183/264 [02:37<01:07,  1.20it/s] 70%|██████▉   | 184/264 [02:38<01:08,  1.17it/s] 70%|███████   | 185/264 [02:39<01:07,  1.18it/s] 70%|███████   | 186/264 [02:40<01:06,  1.17it/s] 71%|███████   | 187/264 [02:41<01:07,  1.15it/s] 71%|███████   | 188/264 [02:42<01:05,  1.17it/s] 72%|███████▏  | 189/264 [02:43<01:05,  1.14it/s] 72%|███████▏  | 190/264 [02:43<01:03,  1.17it/s] 72%|███████▏  | 191/264 [02:44<01:02,  1.17it/s] 73%|███████▎  | 192/264 [02:45<00:59,  1.20it/s] 73%|███████▎  | 193/264 [02:46<00:58,  1.21it/s] 73%|███████▎  | 194/264 [02:47<00:57,  1.21it/s] 74%|███████▍  | 195/264 [02:48<00:57,  1.20it/s] 74%|███████▍  | 196/264 [02:48<00:56,  1.21it/s] 75%|███████▍  | 197/264 [02:49<00:56,  1.19it/s] 75%|███████▌  | 198/264 [02:50<00:54,  1.20it/s] 75%|███████▌  | 199/264 [02:51<00:53,  1.22it/s] 76%|███████▌  | 200/264 [02:52<00:52,  1.23it/s] 76%|███████▌  | 201/264 [02:52<00:51,  1.23it/s] 77%|███████▋  | 202/264 [02:53<00:51,  1.21it/s] 77%|███████▋  | 203/264 [02:54<00:53,  1.15it/s] 77%|███████▋  | 204/264 [02:55<00:52,  1.14it/s] 78%|███████▊  | 205/264 [02:56<00:51,  1.14it/s] 78%|███████▊  | 206/264 [02:57<00:52,  1.10it/s] 78%|███████▊  | 207/264 [02:58<00:50,  1.14it/s] 79%|███████▉  | 208/264 [02:59<00:48,  1.15it/s] 79%|███████▉  | 209/264 [03:00<00:46,  1.17it/s] 80%|███████▉  | 210/264 [03:00<00:45,  1.17it/s] 80%|███████▉  | 211/264 [03:01<00:44,  1.19it/s] 80%|████████  | 212/264 [03:02<00:45,  1.15it/s] 81%|████████  | 213/264 [03:03<00:42,  1.19it/s] 81%|████████  | 214/264 [03:04<00:43,  1.16it/s] 81%|████████▏ | 215/264 [03:05<00:42,  1.16it/s] 82%|████████▏ | 216/264 [03:05<00:40,  1.18it/s] 82%|████████▏ | 217/264 [03:06<00:39,  1.20it/s] 83%|████████▎ | 218/264 [03:07<00:38,  1.21it/s] 83%|████████▎ | 219/264 [03:08<00:37,  1.21it/s] 83%|████████▎ | 220/264 [03:09<00:37,  1.18it/s] 84%|████████▎ | 221/264 [03:10<00:37,  1.15it/s] 84%|████████▍ | 222/264 [03:11<00:35,  1.17it/s] 84%|████████▍ | 223/264 [03:11<00:35,  1.15it/s] 85%|████████▍ | 224/264 [03:12<00:34,  1.17it/s] 85%|████████▌ | 225/264 [03:13<00:32,  1.19it/s] 86%|████████▌ | 226/264 [03:14<00:31,  1.20it/s] 86%|████████▌ | 227/264 [03:15<00:30,  1.21it/s] 86%|████████▋ | 228/264 [03:16<00:29,  1.21it/s] 87%|████████▋ | 229/264 [03:16<00:28,  1.21it/s] 87%|████████▋ | 230/264 [03:17<00:28,  1.20it/s] 88%|████████▊ | 231/264 [03:18<00:27,  1.22it/s] 88%|████████▊ | 232/264 [03:19<00:27,  1.16it/s] 88%|████████▊ | 233/264 [03:20<00:25,  1.19it/s] 89%|████████▊ | 234/264 [03:21<00:26,  1.15it/s] 89%|████████▉ | 235/264 [03:22<00:25,  1.16it/s] 89%|████████▉ | 236/264 [03:22<00:23,  1.18it/s] 90%|████████▉ | 237/264 [03:23<00:22,  1.18it/s] 90%|█████████ | 238/264 [03:24<00:21,  1.19it/s] 91%|█████████ | 239/264 [03:25<00:20,  1.20it/s] 91%|█████████ | 240/264 [03:26<00:20,  1.17it/s] 91%|█████████▏| 241/264 [03:27<00:20,  1.12it/s] 92%|█████████▏| 242/264 [03:28<00:19,  1.11it/s] 92%|█████████▏| 243/264 [03:28<00:18,  1.15it/s] 92%|█████████▏| 244/264 [03:29<00:17,  1.17it/s] 93%|█████████▎| 245/264 [03:30<00:16,  1.12it/s] 93%|█████████▎| 246/264 [03:31<00:15,  1.13it/s] 94%|█████████▎| 247/264 [03:32<00:14,  1.16it/s] 94%|█████████▍| 248/264 [03:33<00:13,  1.17it/s] 94%|█████████▍| 249/264 [03:34<00:13,  1.15it/s] 95%|█████████▍| 250/264 [03:34<00:12,  1.16it/s] 95%|█████████▌| 251/264 [03:35<00:11,  1.13it/s] 95%|█████████▌| 252/264 [03:36<00:10,  1.14it/s] 96%|█████████▌| 253/264 [03:37<00:09,  1.13it/s] 96%|█████████▌| 254/264 [03:38<00:08,  1.13it/s] 97%|█████████▋| 255/264 [03:39<00:07,  1.17it/s] 97%|█████████▋| 256/264 [03:40<00:06,  1.18it/s] 97%|█████████▋| 257/264 [03:41<00:06,  1.14it/s] 98%|█████████▊| 258/264 [03:41<00:05,  1.14it/s] 98%|█████████▊| 259/264 [03:42<00:04,  1.17it/s] 98%|█████████▊| 260/264 [03:43<00:03,  1.15it/s] 99%|█████████▉| 261/264 [03:44<00:02,  1.21it/s] 99%|█████████▉| 262/264 [03:45<00:01,  1.26it/s]100%|█████████▉| 263/264 [03:45<00:00,  1.30it/s]100%|██████████| 264/264 [03:46<00:00,  1.33it/s]100%|██████████| 264/264 [03:46<00:00,  1.16it/s]Save Model
Save current model ...
[Error] Traceback (most recent call last):
  File "train.py", line 346, in train
    best_model, best_loss, current_model = \
  File "train.py", line 439, in save_model
    model_path = os.path.join(save_dir, current_model)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 328, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 401, in _legacy_save
    pickler.dump(obj)
AttributeError: Can't pickle local object 'train.<locals>.ModelWithLoss'

Can't pickle local object 'train.<locals>.ModelWithLoss'
Step: 3200. Epoch: 12/30. Iteration: 33/264. Cls loss: 49.92409. Reg loss: 0.07583. Total loss: 49.99992
Step 3200: Current Classification Loss:49.924091; Current Regression Loss:0.075828; Current Loss:49.999920;              Average Classification Loss:43.589392; Average Regression Loss:0.065739; Average Loss:43.655131; Current Learning Rate:0.000100.
Save Model
Save current model ...
[Error] Traceback (most recent call last):
  File "train.py", line 346, in train
    best_model, best_loss, current_model = \
  File "train.py", line 439, in save_model
    model_path = os.path.join(save_dir, current_model)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 328, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 401, in _legacy_save
    pickler.dump(obj)
AttributeError: Can't pickle local object 'train.<locals>.ModelWithLoss'

Can't pickle local object 'train.<locals>.ModelWithLoss'
Step: 3300. Epoch: 12/30. Iteration: 133/264. Cls loss: 31.42739. Reg loss: 0.05343. Total loss: 31.48082
Step 3300: Current Classification Loss:31.427391; Current Regression Loss:0.053428; Current Loss:31.480820;              Average Classification Loss:42.748179; Average Regression Loss:0.059045; Average Loss:42.807224; Current Learning Rate:0.000100.
Save Model
Save current model ...
[Error] Traceback (most recent call last):
  File "train.py", line 346, in train
    best_model, best_loss, current_model = \
  File "train.py", line 439, in save_model
    model_path = os.path.join(save_dir, current_model)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 328, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 401, in _legacy_save
    pickler.dump(obj)
AttributeError: Can't pickle local object 'train.<locals>.ModelWithLoss'

Can't pickle local object 'train.<locals>.ModelWithLoss'
Step: 3400. Epoch: 12/30. Iteration: 233/264. Cls loss: 31.38929. Reg loss: 0.06047. Total loss: 31.44976
Step 3400: Current Classification Loss:31.389294; Current Regression Loss:0.060469; Current Loss:31.449762;              Average Classification Loss:42.190339; Average Regression Loss:0.055875; Average Loss:42.246213; Current Learning Rate:0.000100.

  0%|          | 0/264 [00:00<?, ?it/s]Val. Epoch: 12/30. Classification loss: 18.58618. Regression loss: 0.06941. Total loss: 18.65559
--------------------------------------------After Epoch 12------------------------------------------------
Step 3432: Validation Classification Loss:18.586180; Regression Loss:0.069409; Total Loss:18.655589
----------------------------------------------------------------------------------------------------------
  0%|          | 1/264 [00:01<08:35,  1.96s/it]  1%|          | 2/264 [00:02<07:16,  1.67s/it]  1%|          | 3/264 [00:03<06:17,  1.45s/it]  2%|▏         | 4/264 [00:04<05:35,  1.29s/it]  2%|▏         | 5/264 [00:05<05:09,  1.19s/it]  2%|▏         | 6/264 [00:06<04:48,  1.12s/it]  3%|▎         | 7/264 [00:07<04:26,  1.04s/it]  3%|▎         | 8/264 [00:08<04:08,  1.03it/s]  3%|▎         | 9/264 [00:09<04:05,  1.04it/s]  4%|▍         | 10/264 [00:10<04:00,  1.06it/s]  4%|▍         | 11/264 [00:11<03:56,  1.07it/s]  5%|▍         | 12/264 [00:11<03:44,  1.12it/s]  5%|▍         | 13/264 [00:12<03:38,  1.15it/s]  5%|▌         | 14/264 [00:13<03:32,  1.18it/s]  6%|▌         | 15/264 [00:14<03:28,  1.19it/s]  6%|▌         | 16/264 [00:15<03:26,  1.20it/s]  6%|▋         | 17/264 [00:15<03:24,  1.21it/s]  7%|▋         | 18/264 [00:16<03:32,  1.16it/s]  7%|▋         | 19/264 [00:17<03:35,  1.14it/s]  8%|▊         | 20/264 [00:18<03:35,  1.13it/s]  8%|▊         | 21/264 [00:19<03:30,  1.16it/s]  8%|▊         | 22/264 [00:20<03:31,  1.15it/s]  9%|▊         | 23/264 [00:21<03:28,  1.16it/s]  9%|▉         | 24/264 [00:22<03:31,  1.14it/s]  9%|▉         | 25/264 [00:23<03:33,  1.12it/s] 10%|▉         | 26/264 [00:23<03:25,  1.16it/s] 10%|█         | 27/264 [00:24<03:29,  1.13it/s] 11%|█         | 28/264 [00:25<03:28,  1.13it/s] 11%|█         | 29/264 [00:26<03:19,  1.18it/s] 11%|█▏        | 30/264 [00:27<03:17,  1.18it/s] 12%|█▏        | 31/264 [00:28<03:14,  1.20it/s] 12%|█▏        | 32/264 [00:29<03:23,  1.14it/s] 12%|█▎        | 33/264 [00:29<03:19,  1.16it/s] 13%|█▎        | 34/264 [00:30<03:13,  1.19it/s] 13%|█▎        | 35/264 [00:31<03:11,  1.20it/s] 14%|█▎        | 36/264 [00:32<03:08,  1.21it/s] 14%|█▍        | 37/264 [00:33<03:08,  1.21it/s] 14%|█▍        | 38/264 [00:34<03:06,  1.21it/s] 15%|█▍        | 39/264 [00:34<03:06,  1.21it/s] 15%|█▌        | 40/264 [00:35<03:10,  1.18it/s] 16%|█▌        | 41/264 [00:36<03:10,  1.17it/s] 16%|█▌        | 42/264 [00:37<03:13,  1.15it/s] 16%|█▋        | 43/264 [00:38<03:07,  1.18it/s] 17%|█▋        | 44/264 [00:39<03:04,  1.19it/s] 17%|█▋        | 45/264 [00:40<03:08,  1.16it/s] 17%|█▋        | 46/264 [00:40<03:04,  1.18it/s] 18%|█▊        | 47/264 [00:41<03:07,  1.16it/s] 18%|█▊        | 48/264 [00:42<03:09,  1.14it/s] 19%|█▊        | 49/264 [00:43<03:05,  1.16it/s] 19%|█▉        | 50/264 [00:44<03:06,  1.15it/s] 19%|█▉        | 51/264 [00:45<03:00,  1.18it/s] 20%|█▉        | 52/264 [00:46<02:56,  1.20it/s] 20%|██        | 53/264 [00:46<02:54,  1.21it/s] 20%|██        | 54/264 [00:47<03:01,  1.16it/s] 21%|██        | 55/264 [00:48<03:04,  1.13it/s] 21%|██        | 56/264 [00:49<02:59,  1.16it/s] 22%|██▏       | 57/264 [00:50<03:00,  1.15it/s] 22%|██▏       | 58/264 [00:51<02:59,  1.15it/s] 22%|██▏       | 59/264 [00:52<02:56,  1.16it/s] 23%|██▎       | 60/264 [00:52<02:54,  1.17it/s] 23%|██▎       | 61/264 [00:53<02:51,  1.18it/s] 23%|██▎       | 62/264 [00:54<02:49,  1.19it/s] 24%|██▍       | 63/264 [00:55<02:49,  1.19it/s] 24%|██▍       | 64/264 [00:56<02:47,  1.19it/s] 25%|██▍       | 65/264 [00:57<02:46,  1.20it/s] 25%|██▌       | 66/264 [00:57<02:46,  1.19it/s] 25%|██▌       | 67/264 [00:58<02:44,  1.20it/s] 26%|██▌       | 68/264 [00:59<02:49,  1.15it/s] 26%|██▌       | 69/264 [01:00<02:50,  1.14it/s] 27%|██▋       | 70/264 [01:01<02:46,  1.17it/s] 27%|██▋       | 71/264 [01:02<02:42,  1.19it/s] 27%|██▋       | 72/264 [01:03<02:40,  1.20it/s] 28%|██▊       | 73/264 [01:03<02:38,  1.21it/s] 28%|██▊       | 74/264 [01:04<02:36,  1.21it/s] 28%|██▊       | 75/264 [01:05<02:42,  1.16it/s] 29%|██▉       | 76/264 [01:06<02:42,  1.15it/s] 29%|██▉       | 77/264 [01:07<02:39,  1.18it/s] 30%|██▉       | 78/264 [01:08<02:44,  1.13it/s] 30%|██▉       | 79/264 [01:09<02:39,  1.16it/s] 30%|███       | 80/264 [01:09<02:35,  1.18it/s] 31%|███       | 81/264 [01:10<02:39,  1.15it/s] 31%|███       | 82/264 [01:11<02:39,  1.14it/s] 31%|███▏      | 83/264 [01:12<02:36,  1.15it/s] 32%|███▏      | 84/264 [01:13<02:38,  1.13it/s] 32%|███▏      | 85/264 [01:14<02:39,  1.12it/s] 33%|███▎      | 86/264 [01:15<02:34,  1.15it/s] 33%|███▎      | 87/264 [01:16<02:32,  1.16it/s] 33%|███▎      | 88/264 [01:16<02:28,  1.18it/s] 34%|███▎      | 89/264 [01:17<02:30,  1.16it/s] 34%|███▍      | 90/264 [01:18<02:31,  1.15it/s] 34%|███▍      | 91/264 [01:19<02:27,  1.17it/s] 35%|███▍      | 92/264 [01:20<02:28,  1.16it/s] 35%|███▌      | 93/264 [01:21<02:30,  1.13it/s] 36%|███▌      | 94/264 [01:22<02:27,  1.15it/s] 36%|███▌      | 95/264 [01:22<02:23,  1.18it/s] 36%|███▋      | 96/264 [01:23<02:25,  1.15it/s] 37%|███▋      | 97/264 [01:24<02:22,  1.17it/s] 37%|███▋      | 98/264 [01:25<02:19,  1.19it/s] 38%|███▊      | 99/264 [01:26<02:23,  1.15it/s] 38%|███▊      | 100/264 [01:27<02:18,  1.18it/s] 38%|███▊      | 101/264 [01:28<02:16,  1.19it/s] 39%|███▊      | 102/264 [01:28<02:14,  1.20it/s] 39%|███▉      | 103/264 [01:29<02:17,  1.17it/s] 39%|███▉      | 104/264 [01:30<02:14,  1.19it/s] 40%|███▉      | 105/264 [01:31<02:12,  1.20it/s] 40%|████      | 106/264 [01:32<02:10,  1.21it/s] 41%|████      | 107/264 [01:33<02:09,  1.21it/s] 41%|████      | 108/264 [01:33<02:09,  1.21it/s] 41%|████▏     | 109/264 [01:34<02:07,  1.21it/s] 42%|████▏     | 110/264 [01:35<02:06,  1.21it/s] 42%|████▏     | 111/264 [01:36<02:09,  1.18it/s] 42%|████▏     | 112/264 [01:37<02:07,  1.19it/s] 43%|████▎     | 113/264 [01:38<02:10,  1.16it/s] 43%|████▎     | 114/264 [01:38<02:07,  1.18it/s] 44%|████▎     | 115/264 [01:39<02:09,  1.15it/s] 44%|████▍     | 116/264 [01:40<02:04,  1.18it/s] 44%|████▍     | 117/264 [01:41<02:03,  1.19it/s] 45%|████▍     | 118/264 [01:42<02:01,  1.20it/s] 45%|████▌     | 119/264 [01:43<01:59,  1.21it/s] 45%|████▌     | 120/264 [01:43<01:58,  1.22it/s] 46%|████▌     | 121/264 [01:44<01:57,  1.22it/s] 46%|████▌     | 122/264 [01:45<01:56,  1.22it/s] 47%|████▋     | 123/264 [01:46<01:55,  1.22it/s] 47%|████▋     | 124/264 [01:47<01:54,  1.22it/s] 47%|████▋     | 125/264 [01:48<01:57,  1.18it/s] 48%|████▊     | 126/264 [01:48<01:58,  1.16it/s] 48%|████▊     | 127/264 [01:49<01:59,  1.15it/s] 48%|████▊     | 128/264 [01:50<01:58,  1.15it/s] 49%|████▉     | 129/264 [01:51<02:00,  1.12it/s] 49%|████▉     | 130/264 [01:52<02:01,  1.11it/s] 50%|████▉     | 131/264 [01:53<01:56,  1.14it/s] 50%|█████     | 132/264 [01:54<01:56,  1.13it/s] 50%|█████     | 133/264 [01:55<01:55,  1.14it/s] 51%|█████     | 134/264 [01:56<01:52,  1.16it/s] 51%|█████     | 135/264 [01:56<01:51,  1.16it/s] 52%|█████▏    | 136/264 [01:57<01:53,  1.13it/s] 52%|█████▏    | 137/264 [01:58<01:48,  1.17it/s] 52%|█████▏    | 138/264 [01:59<01:45,  1.19it/s] 53%|█████▎    | 139/264 [02:00<01:44,  1.19it/s] 53%|█████▎    | 140/264 [02:01<01:43,  1.20it/s] 53%|█████▎    | 141/264 [02:01<01:41,  1.21it/s] 54%|█████▍    | 142/264 [02:02<01:39,  1.22it/s] 54%|█████▍    | 143/264 [02:03<01:39,  1.22it/s] 55%|█████▍    | 144/264 [02:04<01:38,  1.22it/s] 55%|█████▍    | 145/264 [02:05<01:42,  1.16it/s] 55%|█████▌    | 146/264 [02:06<01:40,  1.17it/s] 56%|█████▌    | 147/264 [02:06<01:38,  1.18it/s] 56%|█████▌    | 148/264 [02:07<01:36,  1.20it/s] 56%|█████▋    | 149/264 [02:08<01:34,  1.21it/s] 57%|█████▋    | 150/264 [02:09<01:33,  1.21it/s] 57%|█████▋    | 151/264 [02:10<01:32,  1.22it/s] 58%|█████▊    | 152/264 [02:11<01:31,  1.22it/s] 58%|█████▊    | 153/264 [02:11<01:31,  1.22it/s] 58%|█████▊    | 154/264 [02:12<01:30,  1.22it/s] 59%|█████▊    | 155/264 [02:13<01:29,  1.22it/s] 59%|█████▉    | 156/264 [02:14<01:28,  1.21it/s] 59%|█████▉    | 157/264 [02:15<01:27,  1.22it/s] 60%|█████▉    | 158/264 [02:15<01:26,  1.22it/s] 60%|██████    | 159/264 [02:16<01:25,  1.22it/s] 61%|██████    | 160/264 [02:17<01:29,  1.17it/s] 61%|██████    | 161/264 [02:18<01:27,  1.18it/s] 61%|██████▏   | 162/264 [02:19<01:27,  1.16it/s] 62%|██████▏   | 163/264 [02:20<01:26,  1.17it/s] 62%|██████▏   | 164/264 [02:21<01:26,  1.16it/s] 62%|██████▎   | 165/264 [02:22<01:25,  1.16it/s] 63%|██████▎   | 166/264 [02:22<01:25,  1.15it/s] 63%|██████▎   | 167/264 [02:23<01:23,  1.17it/s] 64%|██████▎   | 168/264 [02:24<01:20,  1.20it/s] 64%|██████▍   | 169/264 [02:25<01:18,  1.21it/s] 64%|██████▍   | 170/264 [02:26<01:18,  1.20it/s] 65%|██████▍   | 171/264 [02:26<01:17,  1.21it/s] 65%|██████▌   | 172/264 [02:27<01:18,  1.17it/s] 66%|██████▌   | 173/264 [02:28<01:17,  1.17it/s] 66%|██████▌   | 174/264 [02:29<01:15,  1.19it/s] 66%|██████▋   | 175/264 [02:30<01:14,  1.20it/s] 67%|██████▋   | 176/264 [02:31<01:12,  1.21it/s] 67%|██████▋   | 177/264 [02:31<01:11,  1.22it/s] 67%|██████▋   | 178/264 [02:32<01:10,  1.22it/s] 68%|██████▊   | 179/264 [02:33<01:09,  1.22it/s] 68%|██████▊   | 180/264 [02:34<01:13,  1.14it/s] 69%|██████▊   | 181/264 [02:35<01:12,  1.15it/s] 69%|██████▉   | 182/264 [02:36<01:10,  1.17it/s] 69%|██████▉   | 183/264 [02:37<01:09,  1.17it/s] 70%|██████▉   | 184/264 [02:37<01:07,  1.19it/s] 70%|███████   | 185/264 [02:38<01:07,  1.18it/s] 70%|███████   | 186/264 [02:39<01:05,  1.18it/s] 71%|███████   | 187/264 [02:40<01:06,  1.15it/s] 71%|███████   | 188/264 [02:41<01:04,  1.18it/s] 72%|███████▏  | 189/264 [02:42<01:02,  1.20it/s] 72%|███████▏  | 190/264 [02:43<01:01,  1.21it/s] 72%|███████▏  | 191/264 [02:43<01:00,  1.20it/s] 73%|███████▎  | 192/264 [02:44<00:59,  1.21it/s] 73%|███████▎  | 193/264 [02:45<00:58,  1.21it/s] 73%|███████▎  | 194/264 [02:46<00:56,  1.23it/s] 74%|███████▍  | 195/264 [02:47<00:56,  1.22it/s] 74%|███████▍  | 196/264 [02:47<00:55,  1.22it/s] 75%|███████▍  | 197/264 [02:48<00:55,  1.22it/s] 75%|███████▌  | 198/264 [02:49<00:55,  1.18it/s] 75%|███████▌  | 199/264 [02:50<00:57,  1.13it/s] 76%|███████▌  | 200/264 [02:51<00:54,  1.17it/s] 76%|███████▌  | 201/264 [02:52<00:54,  1.15it/s] 77%|███████▋  | 202/264 [02:53<00:54,  1.14it/s] 77%|███████▋  | 203/264 [02:54<00:54,  1.13it/s] 77%|███████▋  | 204/264 [02:55<00:53,  1.11it/s] 78%|███████▊  | 205/264 [02:55<00:52,  1.13it/s] 78%|███████▊  | 206/264 [02:56<00:50,  1.15it/s] 78%|███████▊  | 207/264 [02:57<00:49,  1.16it/s] 79%|███████▉  | 208/264 [02:58<00:47,  1.17it/s] 79%|███████▉  | 209/264 [02:59<00:46,  1.19it/s] 80%|███████▉  | 210/264 [03:00<00:45,  1.20it/s] 80%|███████▉  | 211/264 [03:00<00:45,  1.17it/s] 80%|████████  | 212/264 [03:01<00:43,  1.19it/s] 81%|████████  | 213/264 [03:02<00:43,  1.19it/s] 81%|████████  | 214/264 [03:03<00:42,  1.18it/s] 81%|████████▏ | 215/264 [03:04<00:41,  1.19it/s] 82%|████████▏ | 216/264 [03:05<00:41,  1.17it/s] 82%|████████▏ | 217/264 [03:06<00:41,  1.15it/s] 83%|████████▎ | 218/264 [03:06<00:39,  1.15it/s] 83%|████████▎ | 219/264 [03:07<00:37,  1.19it/s] 83%|████████▎ | 220/264 [03:08<00:37,  1.16it/s] 84%|████████▎ | 221/264 [03:09<00:36,  1.18it/s] 84%|████████▍ | 222/264 [03:10<00:35,  1.20it/s] 84%|████████▍ | 223/264 [03:11<00:34,  1.19it/s] 85%|████████▍ | 224/264 [03:12<00:34,  1.17it/s] 85%|████████▌ | 225/264 [03:12<00:33,  1.18it/s] 86%|████████▌ | 226/264 [03:13<00:33,  1.15it/s] 86%|████████▌ | 227/264 [03:14<00:31,  1.17it/s] 86%|████████▋ | 228/264 [03:15<00:30,  1.18it/s] 87%|████████▋ | 229/264 [03:16<00:29,  1.18it/s] 87%|████████▋ | 230/264 [03:17<00:28,  1.20it/s] 88%|████████▊ | 231/264 [03:17<00:28,  1.18it/s] 88%|████████▊ | 232/264 [03:18<00:27,  1.17it/s] 88%|████████▊ | 233/264 [03:19<00:26,  1.18it/s] 89%|████████▊ | 234/264 [03:20<00:25,  1.20it/s] 89%|████████▉ | 235/264 [03:21<00:24,  1.20it/s] 89%|████████▉ | 236/264 [03:22<00:23,  1.22it/s] 90%|████████▉ | 237/264 [03:22<00:22,  1.21it/s] 90%|█████████ | 238/264 [03:23<00:21,  1.22it/s] 91%|█████████ | 239/264 [03:24<00:20,  1.22it/s] 91%|█████████ | 240/264 [03:25<00:19,  1.23it/s] 91%|█████████▏| 241/264 [03:26<00:18,  1.22it/s] 92%|█████████▏| 242/264 [03:26<00:17,  1.23it/s] 92%|█████████▏| 243/264 [03:27<00:17,  1.23it/s] 92%|█████████▏| 244/264 [03:28<00:16,  1.23it/s] 93%|█████████▎| 245/264 [03:29<00:15,  1.23it/s] 93%|█████████▎| 246/264 [03:30<00:14,  1.20it/s] 94%|█████████▎| 247/264 [03:31<00:14,  1.17it/s] 94%|█████████▍| 248/264 [03:32<00:13,  1.17it/s] 94%|█████████▍| 249/264 [03:32<00:12,  1.16it/s] 95%|█████████▍| 250/264 [03:33<00:12,  1.15it/s] 95%|█████████▌| 251/264 [03:34<00:11,  1.17it/s] 95%|█████████▌| 252/264 [03:35<00:10,  1.18it/s] 96%|█████████▌| 253/264 [03:36<00:09,  1.18it/s] 96%|█████████▌| 254/264 [03:37<00:08,  1.19it/s] 97%|█████████▋| 255/264 [03:37<00:07,  1.20it/s] 97%|█████████▋| 256/264 [03:38<00:06,  1.20it/s] 97%|█████████▋| 257/264 [03:39<00:05,  1.20it/s] 98%|█████████▊| 258/264 [03:40<00:04,  1.21it/s] 98%|█████████▊| 259/264 [03:41<00:04,  1.19it/s] 98%|█████████▊| 260/264 [03:42<00:03,  1.19it/s] 99%|█████████▉| 261/264 [03:42<00:02,  1.24it/s] 99%|█████████▉| 262/264 [03:43<00:01,  1.29it/s]100%|█████████▉| 263/264 [03:44<00:00,  1.32it/s]100%|██████████| 264/264 [03:45<00:00,  1.34it/s]100%|██████████| 264/264 [03:45<00:00,  1.17it/s]Save Model
Save current model ...
[Error] Traceback (most recent call last):
  File "train.py", line 346, in train
    best_model, best_loss, current_model = \
  File "train.py", line 439, in save_model
    model_path = os.path.join(save_dir, current_model)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 328, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 401, in _legacy_save
    pickler.dump(obj)
AttributeError: Can't pickle local object 'train.<locals>.ModelWithLoss'

Can't pickle local object 'train.<locals>.ModelWithLoss'
Step: 3500. Epoch: 13/30. Iteration: 69/264. Cls loss: 23.81645. Reg loss: 0.05012. Total loss: 23.86656
Step 3500: Current Classification Loss:23.816446; Current Regression Loss:0.050117; Current Loss:23.866564;              Average Classification Loss:37.029157; Average Regression Loss:0.052534; Average Loss:37.081691; Current Learning Rate:0.000100.
Save Model
Save current model ...
[Error] Traceback (most recent call last):
  File "train.py", line 346, in train
    best_model, best_loss, current_model = \
  File "train.py", line 439, in save_model
    model_path = os.path.join(save_dir, current_model)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 328, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 401, in _legacy_save
    pickler.dump(obj)
AttributeError: Can't pickle local object 'train.<locals>.ModelWithLoss'

Can't pickle local object 'train.<locals>.ModelWithLoss'
Step: 3600. Epoch: 13/30. Iteration: 169/264. Cls loss: 25.32378. Reg loss: 0.06876. Total loss: 25.39254
Step 3600: Current Classification Loss:25.323780; Current Regression Loss:0.068756; Current Loss:25.392536;              Average Classification Loss:34.971496; Average Regression Loss:0.052660; Average Loss:35.024156; Current Learning Rate:0.000100.

  0%|          | 0/264 [00:00<?, ?it/s]Val. Epoch: 13/30. Classification loss: 14.28604. Regression loss: 0.06818. Total loss: 14.35423
--------------------------------------------After Epoch 13------------------------------------------------
Step 3696: Validation Classification Loss:14.286042; Regression Loss:0.068184; Total Loss:14.354226
----------------------------------------------------------------------------------------------------------
  0%|          | 1/264 [00:01<08:17,  1.89s/it]  1%|          | 2/264 [00:02<06:58,  1.60s/it]  1%|          | 3/264 [00:03<06:03,  1.39s/it]  2%|▏         | 4/264 [00:04<05:24,  1.25s/it]  2%|▏         | 5/264 [00:05<05:03,  1.17s/it]  2%|▏         | 6/264 [00:06<04:40,  1.09s/it]  3%|▎         | 7/264 [00:07<04:25,  1.03s/it]  3%|▎         | 8/264 [00:08<04:14,  1.00it/s]  3%|▎         | 9/264 [00:09<04:06,  1.04it/s]  4%|▍         | 10/264 [00:10<04:01,  1.05it/s]  4%|▍         | 11/264 [00:10<03:50,  1.10it/s]  5%|▍         | 12/264 [00:11<03:50,  1.10it/s]  5%|▍         | 13/264 [00:12<03:48,  1.10it/s]  5%|▌         | 14/264 [00:13<03:40,  1.13it/s]  6%|▌         | 15/264 [00:14<03:35,  1.16it/s]  6%|▌         | 16/264 [00:15<03:39,  1.13it/s]  6%|▋         | 17/264 [00:16<03:39,  1.12it/s]  7%|▋         | 18/264 [00:17<03:33,  1.15it/s]  7%|▋         | 19/264 [00:17<03:36,  1.13it/s]  8%|▊         | 20/264 [00:18<03:34,  1.14it/s]  8%|▊         | 21/264 [00:19<03:34,  1.13it/s]  8%|▊         | 22/264 [00:20<03:41,  1.09it/s]  9%|▊         | 23/264 [00:21<03:31,  1.14it/s]  9%|▉         | 24/264 [00:22<03:26,  1.16it/s]  9%|▉         | 25/264 [00:23<03:35,  1.11it/s] 10%|▉         | 26/264 [00:24<03:32,  1.12it/s] 10%|█         | 27/264 [00:25<03:30,  1.13it/s] 11%|█         | 28/264 [00:25<03:25,  1.15it/s] 11%|█         | 29/264 [00:26<03:21,  1.16it/s] 11%|█▏        | 30/264 [00:27<03:17,  1.18it/s] 12%|█▏        | 31/264 [00:28<03:16,  1.19it/s] 12%|█▏        | 32/264 [00:29<03:12,  1.20it/s] 12%|█▎        | 33/264 [00:30<03:10,  1.21it/s] 13%|█▎        | 34/264 [00:30<03:15,  1.18it/s] 13%|█▎        | 35/264 [00:31<03:17,  1.16it/s] 14%|█▎        | 36/264 [00:32<03:19,  1.14it/s] 14%|█▍        | 37/264 [00:33<03:22,  1.12it/s] 14%|█▍        | 38/264 [00:34<03:17,  1.14it/s] 15%|█▍        | 39/264 [00:35<03:18,  1.14it/s] 15%|█▌        | 40/264 [00:36<03:18,  1.13it/s] 16%|█▌        | 41/264 [00:37<03:15,  1.14it/s] 16%|█▌        | 42/264 [00:37<03:10,  1.16it/s] 16%|█▋        | 43/264 [00:38<03:14,  1.13it/s] 17%|█▋        | 44/264 [00:39<03:09,  1.16it/s] 17%|█▋        | 45/264 [00:40<03:16,  1.12it/s] 17%|█▋        | 46/264 [00:41<03:17,  1.10it/s] 18%|█▊        | 47/264 [00:42<03:10,  1.14it/s] 18%|█▊        | 48/264 [00:43<03:04,  1.17it/s] 19%|█▊        | 49/264 [00:44<03:08,  1.14it/s] 19%|█▉        | 50/264 [00:45<03:12,  1.11it/s] 19%|█▉        | 51/264 [00:45<03:09,  1.12it/s] 20%|█▉        | 52/264 [00:46<03:04,  1.15it/s] 20%|██        | 53/264 [00:47<03:00,  1.17it/s] 20%|██        | 54/264 [00:48<02:57,  1.19it/s] 21%|██        | 55/264 [00:49<02:53,  1.20it/s] 21%|██        | 56/264 [00:50<02:51,  1.21it/s] 22%|██▏       | 57/264 [00:50<02:58,  1.16it/s] 22%|██▏       | 58/264 [00:51<03:02,  1.13it/s] 22%|██▏       | 59/264 [00:52<02:57,  1.15it/s] 23%|██▎       | 60/264 [00:53<03:02,  1.12it/s] 23%|██▎       | 61/264 [00:54<03:03,  1.11it/s] 23%|██▎       | 62/264 [00:55<03:01,  1.11it/s] 24%|██▍       | 63/264 [00:56<02:58,  1.13it/s] 24%|██▍       | 64/264 [00:57<02:58,  1.12it/s] 25%|██▍       | 65/264 [00:58<02:57,  1.12it/s] 25%|██▌       | 66/264 [00:59<02:52,  1.15it/s] 25%|██▌       | 67/264 [00:59<02:47,  1.17it/s] 26%|██▌       | 68/264 [01:00<02:49,  1.16it/s] 26%|██▌       | 69/264 [01:01<02:51,  1.14it/s] 27%|██▋       | 70/264 [01:02<02:48,  1.15it/s] 27%|██▋       | 71/264 [01:03<02:42,  1.19it/s] 27%|██▋       | 72/264 [01:04<02:41,  1.19it/s] 28%|██▊       | 73/264 [01:04<02:38,  1.21it/s] 28%|██▊       | 74/264 [01:05<02:46,  1.14it/s] 28%|██▊       | 75/264 [01:06<02:42,  1.16it/s] 29%|██▉       | 76/264 [01:07<02:38,  1.18it/s] 29%|██▉       | 77/264 [01:08<02:40,  1.16it/s] 30%|██▉       | 78/264 [01:09<02:39,  1.17it/s] 30%|██▉       | 79/264 [01:10<02:41,  1.15it/s] 30%|███       | 80/264 [01:11<02:42,  1.13it/s] 31%|███       | 81/264 [01:11<02:38,  1.15it/s] 31%|███       | 82/264 [01:12<02:41,  1.13it/s] 31%|███▏      | 83/264 [01:13<02:36,  1.16it/s] 32%|███▏      | 84/264 [01:14<02:34,  1.16it/s] 32%|███▏      | 85/264 [01:15<02:32,  1.17it/s] 33%|███▎      | 86/264 [01:16<02:36,  1.14it/s] 33%|███▎      | 87/264 [01:17<02:36,  1.13it/s] 33%|███▎      | 88/264 [01:17<02:31,  1.16it/s] 34%|███▎      | 89/264 [01:18<02:28,  1.18it/s] 34%|███▍      | 90/264 [01:19<02:26,  1.19it/s] 34%|███▍      | 91/264 [01:20<02:23,  1.20it/s] 35%|███▍      | 92/264 [01:21<02:31,  1.13it/s] 35%|███▌      | 93/264 [01:22<02:26,  1.17it/s] 36%|███▌      | 94/264 [01:23<02:23,  1.18it/s] 36%|███▌      | 95/264 [01:23<02:21,  1.19it/s] 36%|███▋      | 96/264 [01:24<02:19,  1.20it/s] 37%|███▋      | 97/264 [01:25<02:18,  1.21it/s] 37%|███▋      | 98/264 [01:26<02:16,  1.21it/s] 38%|███▊      | 99/264 [01:27<02:14,  1.22it/s] 38%|███▊      | 100/264 [01:27<02:14,  1.22it/s] 38%|███▊      | 101/264 [01:28<02:13,  1.22it/s] 39%|███▊      | 102/264 [01:29<02:11,  1.23it/s] 39%|███▉      | 103/264 [01:30<02:10,  1.23it/s] 39%|███▉      | 104/264 [01:31<02:09,  1.23it/s] 40%|███▉      | 105/264 [01:32<02:11,  1.21it/s] 40%|████      | 106/264 [01:32<02:09,  1.22it/s] 41%|████      | 107/264 [01:33<02:09,  1.21it/s] 41%|████      | 108/264 [01:34<02:09,  1.20it/s] 41%|████▏     | 109/264 [01:35<02:08,  1.21it/s] 42%|████▏     | 110/264 [01:36<02:07,  1.21it/s] 42%|████▏     | 111/264 [01:37<02:12,  1.16it/s] 42%|████▏     | 112/264 [01:37<02:10,  1.17it/s] 43%|████▎     | 113/264 [01:38<02:07,  1.18it/s] 43%|████▎     | 114/264 [01:39<02:05,  1.20it/s] 44%|████▎     | 115/264 [01:40<02:03,  1.21it/s] 44%|████▍     | 116/264 [01:41<02:01,  1.21it/s] 44%|████▍     | 117/264 [01:42<02:01,  1.21it/s] 45%|████▍     | 118/264 [01:42<02:05,  1.16it/s] 45%|████▌     | 119/264 [01:43<02:03,  1.18it/s] 45%|████▌     | 120/264 [01:44<02:00,  1.20it/s] 46%|████▌     | 121/264 [01:45<01:58,  1.20it/s] 46%|████▌     | 122/264 [01:46<01:57,  1.21it/s] 47%|████▋     | 123/264 [01:47<01:55,  1.22it/s] 47%|████▋     | 124/264 [01:47<01:54,  1.22it/s] 47%|████▋     | 125/264 [01:48<01:55,  1.20it/s] 48%|████▊     | 126/264 [01:49<01:55,  1.20it/s] 48%|████▊     | 127/264 [01:50<01:54,  1.20it/s] 48%|████▊     | 128/264 [01:51<01:54,  1.19it/s] 49%|████▉     | 129/264 [01:52<01:52,  1.19it/s] 49%|████▉     | 130/264 [01:52<01:55,  1.16it/s] 50%|████▉     | 131/264 [01:53<01:55,  1.15it/s] 50%|█████     | 132/264 [01:54<01:56,  1.13it/s] 50%|█████     | 133/264 [01:55<01:54,  1.15it/s] 51%|█████     | 134/264 [01:56<01:51,  1.16it/s] 51%|█████     | 135/264 [01:57<01:54,  1.13it/s] 52%|█████▏    | 136/264 [01:58<01:52,  1.13it/s] 52%|█████▏    | 137/264 [01:59<01:49,  1.16it/s] 52%|█████▏    | 138/264 [01:59<01:46,  1.19it/s] 53%|█████▎    | 139/264 [02:00<01:48,  1.15it/s] 53%|█████▎    | 140/264 [02:01<01:48,  1.14it/s] 53%|█████▎    | 141/264 [02:02<01:47,  1.14it/s] 54%|█████▍    | 142/264 [02:03<01:45,  1.16it/s] 54%|█████▍    | 143/264 [02:04<01:45,  1.14it/s] 55%|█████▍    | 144/264 [02:05<01:46,  1.13it/s] 55%|█████▍    | 145/264 [02:06<01:44,  1.14it/s] 55%|█████▌    | 146/264 [02:06<01:40,  1.17it/s] 56%|█████▌    | 147/264 [02:07<01:41,  1.15it/s] 56%|█████▌    | 148/264 [02:08<01:41,  1.14it/s] 56%|█████▋    | 149/264 [02:09<01:41,  1.14it/s] 57%|█████▋    | 150/264 [02:10<01:37,  1.17it/s] 57%|█████▋    | 151/264 [02:11<01:36,  1.17it/s] 58%|█████▊    | 152/264 [02:12<01:36,  1.16it/s] 58%|█████▊    | 153/264 [02:13<01:36,  1.15it/s] 58%|█████▊    | 154/264 [02:13<01:36,  1.14it/s] 59%|█████▊    | 155/264 [02:14<01:34,  1.16it/s] 59%|█████▉    | 156/264 [02:15<01:32,  1.17it/s] 59%|█████▉    | 157/264 [02:16<01:29,  1.20it/s] 60%|█████▉    | 158/264 [02:17<01:27,  1.21it/s] 60%|██████    | 159/264 [02:17<01:26,  1.21it/s] 61%|██████    | 160/264 [02:18<01:30,  1.16it/s] 61%|██████    | 161/264 [02:19<01:26,  1.18it/s] 61%|██████▏   | 162/264 [02:20<01:26,  1.18it/s] 62%|██████▏   | 163/264 [02:21<01:26,  1.17it/s] 62%|██████▏   | 164/264 [02:22<01:23,  1.19it/s] 62%|██████▎   | 165/264 [02:23<01:27,  1.13it/s] 63%|██████▎   | 166/264 [02:24<01:24,  1.16it/s] 63%|██████▎   | 167/264 [02:24<01:25,  1.14it/s] 64%|██████▎   | 168/264 [02:25<01:21,  1.18it/s] 64%|██████▍   | 169/264 [02:26<01:23,  1.14it/s] 64%|██████▍   | 170/264 [02:27<01:22,  1.13it/s] 65%|██████▍   | 171/264 [02:28<01:21,  1.14it/s] 65%|██████▌   | 172/264 [02:29<01:21,  1.13it/s] 66%|██████▌   | 173/264 [02:30<01:18,  1.16it/s] 66%|██████▌   | 174/264 [02:31<01:16,  1.18it/s] 66%|██████▋   | 175/264 [02:31<01:14,  1.19it/s] 67%|██████▋   | 176/264 [02:32<01:13,  1.20it/s] 67%|██████▋   | 177/264 [02:33<01:12,  1.20it/s] 67%|██████▋   | 178/264 [02:34<01:11,  1.21it/s] 68%|██████▊   | 179/264 [02:35<01:10,  1.21it/s] 68%|██████▊   | 180/264 [02:35<01:09,  1.21it/s] 69%|██████▊   | 181/264 [02:36<01:08,  1.21it/s] 69%|██████▉   | 182/264 [02:37<01:10,  1.17it/s] 69%|██████▉   | 183/264 [02:38<01:10,  1.14it/s] 70%|██████▉   | 184/264 [02:39<01:08,  1.17it/s] 70%|███████   | 185/264 [02:40<01:08,  1.15it/s] 70%|███████   | 186/264 [02:41<01:07,  1.16it/s] 71%|███████   | 187/264 [02:42<01:06,  1.15it/s] 71%|███████   | 188/264 [02:42<01:06,  1.15it/s] 72%|███████▏  | 189/264 [02:43<01:03,  1.18it/s] 72%|███████▏  | 190/264 [02:44<01:01,  1.20it/s] 72%|███████▏  | 191/264 [02:45<01:00,  1.20it/s] 73%|███████▎  | 192/264 [02:46<00:59,  1.21it/s] 73%|███████▎  | 193/264 [02:47<00:58,  1.21it/s] 73%|███████▎  | 194/264 [02:47<00:57,  1.21it/s] 74%|███████▍  | 195/264 [02:48<00:57,  1.21it/s] 74%|███████▍  | 196/264 [02:49<00:57,  1.19it/s] 75%|███████▍  | 197/264 [02:50<00:55,  1.20it/s] 75%|███████▌  | 198/264 [02:51<00:55,  1.20it/s] 75%|███████▌  | 199/264 [02:52<00:54,  1.20it/s] 76%|███████▌  | 200/264 [02:52<00:53,  1.19it/s] 76%|███████▌  | 201/264 [02:53<00:54,  1.16it/s] 77%|███████▋  | 202/264 [02:54<00:52,  1.18it/s] 77%|███████▋  | 203/264 [02:55<00:51,  1.19it/s] 77%|███████▋  | 204/264 [02:56<00:50,  1.20it/s] 78%|███████▊  | 205/264 [02:57<00:49,  1.19it/s] 78%|███████▊  | 206/264 [02:57<00:48,  1.20it/s] 78%|███████▊  | 207/264 [02:58<00:47,  1.21it/s] 79%|███████▉  | 208/264 [02:59<00:46,  1.22it/s] 79%|███████▉  | 209/264 [03:00<00:45,  1.21it/s] 80%|███████▉  | 210/264 [03:01<00:44,  1.21it/s] 80%|███████▉  | 211/264 [03:02<00:43,  1.22it/s] 80%|████████  | 212/264 [03:03<00:45,  1.15it/s] 81%|████████  | 213/264 [03:03<00:44,  1.14it/s] 81%|████████  | 214/264 [03:04<00:44,  1.13it/s] 81%|████████▏ | 215/264 [03:05<00:42,  1.15it/s] 82%|████████▏ | 216/264 [03:06<00:42,  1.13it/s] 82%|████████▏ | 217/264 [03:07<00:41,  1.13it/s] 83%|████████▎ | 218/264 [03:08<00:40,  1.13it/s] 83%|████████▎ | 219/264 [03:09<00:40,  1.11it/s] 83%|████████▎ | 220/264 [03:10<00:38,  1.14it/s] 84%|████████▎ | 221/264 [03:11<00:38,  1.12it/s] 84%|████████▍ | 222/264 [03:11<00:36,  1.16it/s] 84%|████████▍ | 223/264 [03:12<00:35,  1.17it/s] 85%|████████▍ | 224/264 [03:13<00:33,  1.18it/s] 85%|████████▌ | 225/264 [03:14<00:33,  1.18it/s] 86%|████████▌ | 226/264 [03:15<00:31,  1.19it/s] 86%|████████▌ | 227/264 [03:16<00:31,  1.16it/s] 86%|████████▋ | 228/264 [03:16<00:31,  1.14it/s] 87%|████████▋ | 229/264 [03:17<00:30,  1.15it/s] 87%|████████▋ | 230/264 [03:18<00:29,  1.16it/s] 88%|████████▊ | 231/264 [03:19<00:29,  1.13it/s] 88%|████████▊ | 232/264 [03:20<00:27,  1.16it/s] 88%|████████▊ | 233/264 [03:21<00:25,  1.19it/s] 89%|████████▊ | 234/264 [03:22<00:24,  1.20it/s] 89%|████████▉ | 235/264 [03:22<00:24,  1.21it/s] 89%|████████▉ | 236/264 [03:23<00:23,  1.21it/s] 90%|████████▉ | 237/264 [03:24<00:22,  1.21it/s] 90%|█████████ | 238/264 [03:25<00:21,  1.21it/s] 91%|█████████ | 239/264 [03:26<00:20,  1.22it/s] 91%|█████████ | 240/264 [03:26<00:19,  1.22it/s] 91%|█████████▏| 241/264 [03:27<00:18,  1.23it/s] 92%|█████████▏| 242/264 [03:28<00:17,  1.23it/s] 92%|█████████▏| 243/264 [03:29<00:17,  1.23it/s] 92%|█████████▏| 244/264 [03:30<00:17,  1.16it/s] 93%|█████████▎| 245/264 [03:31<00:16,  1.17it/s] 93%|█████████▎| 246/264 [03:31<00:15,  1.19it/s] 94%|█████████▎| 247/264 [03:32<00:14,  1.15it/s] 94%|█████████▍| 248/264 [03:33<00:13,  1.18it/s] 94%|█████████▍| 249/264 [03:34<00:12,  1.16it/s] 95%|█████████▍| 250/264 [03:35<00:11,  1.19it/s] 95%|█████████▌| 251/264 [03:36<00:10,  1.21it/s] 95%|█████████▌| 252/264 [03:36<00:09,  1.22it/s] 96%|█████████▌| 253/264 [03:37<00:08,  1.23it/s] 96%|█████████▌| 254/264 [03:38<00:08,  1.16it/s] 97%|█████████▋| 255/264 [03:39<00:07,  1.15it/s] 97%|█████████▋| 256/264 [03:40<00:06,  1.17it/s] 97%|█████████▋| 257/264 [03:41<00:05,  1.19it/s] 98%|█████████▊| 258/264 [03:42<00:05,  1.20it/s] 98%|█████████▊| 259/264 [03:42<00:04,  1.20it/s] 98%|█████████▊| 260/264 [03:43<00:03,  1.21it/s] 99%|█████████▉| 261/264 [03:44<00:02,  1.24it/s] 99%|█████████▉| 262/264 [03:45<00:01,  1.29it/s]100%|█████████▉| 263/264 [03:45<00:00,  1.33it/s]100%|██████████| 264/264 [03:46<00:00,  1.35it/s]100%|██████████| 264/264 [03:46<00:00,  1.16it/s]Save Model
Save current model ...
[Error] Traceback (most recent call last):
  File "train.py", line 346, in train
    best_model, best_loss, current_model = \
  File "train.py", line 439, in save_model
    model_path = os.path.join(save_dir, current_model)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 328, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 401, in _legacy_save
    pickler.dump(obj)
AttributeError: Can't pickle local object 'train.<locals>.ModelWithLoss'

Can't pickle local object 'train.<locals>.ModelWithLoss'
Step: 3700. Epoch: 14/30. Iteration: 5/264. Cls loss: 21.02499. Reg loss: 0.06979. Total loss: 21.09478
Step 3700: Current Classification Loss:21.024990; Current Regression Loss:0.069786; Current Loss:21.094776;              Average Classification Loss:28.045610; Average Regression Loss:0.050998; Average Loss:28.096608; Current Learning Rate:0.000100.
Save Model
Save current model ...
[Error] Traceback (most recent call last):
  File "train.py", line 346, in train
    best_model, best_loss, current_model = \
  File "train.py", line 439, in save_model
    model_path = os.path.join(save_dir, current_model)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 328, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 401, in _legacy_save
    pickler.dump(obj)
AttributeError: Can't pickle local object 'train.<locals>.ModelWithLoss'

Can't pickle local object 'train.<locals>.ModelWithLoss'
Step: 3800. Epoch: 14/30. Iteration: 105/264. Cls loss: 17.47429. Reg loss: 0.08174. Total loss: 17.55602
Step 3800: Current Classification Loss:17.474285; Current Regression Loss:0.081740; Current Loss:17.556025;              Average Classification Loss:27.231808; Average Regression Loss:0.052604; Average Loss:27.284412; Current Learning Rate:0.000100.
Save Model
Save current model ...
[Error] Traceback (most recent call last):
  File "train.py", line 346, in train
    best_model, best_loss, current_model = \
  File "train.py", line 439, in save_model
    model_path = os.path.join(save_dir, current_model)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 328, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 401, in _legacy_save
    pickler.dump(obj)
AttributeError: Can't pickle local object 'train.<locals>.ModelWithLoss'

Can't pickle local object 'train.<locals>.ModelWithLoss'
Step: 3900. Epoch: 14/30. Iteration: 205/264. Cls loss: 23.61872. Reg loss: 0.05164. Total loss: 23.67036
Step 3900: Current Classification Loss:23.618723; Current Regression Loss:0.051641; Current Loss:23.670364;              Average Classification Loss:25.120953; Average Regression Loss:0.052014; Average Loss:25.172967; Current Learning Rate:0.000100.

  0%|          | 0/264 [00:00<?, ?it/s]Val. Epoch: 14/30. Classification loss: 11.51012. Regression loss: 0.07448. Total loss: 11.58460
--------------------------------------------After Epoch 14------------------------------------------------
Step 3960: Validation Classification Loss:11.510122; Regression Loss:0.074480; Total Loss:11.584602
----------------------------------------------------------------------------------------------------------
  0%|          | 1/264 [00:02<09:00,  2.06s/it]  1%|          | 2/264 [00:02<07:29,  1.72s/it]  1%|          | 3/264 [00:03<06:24,  1.47s/it]  2%|▏         | 4/264 [00:04<05:40,  1.31s/it]  2%|▏         | 5/264 [00:05<05:13,  1.21s/it]  2%|▏         | 6/264 [00:06<04:51,  1.13s/it]  3%|▎         | 7/264 [00:07<04:29,  1.05s/it]  3%|▎         | 8/264 [00:08<04:10,  1.02it/s]  3%|▎         | 9/264 [00:09<04:03,  1.05it/s]  4%|▍         | 10/264 [00:10<03:56,  1.07it/s]  4%|▍         | 11/264 [00:10<03:46,  1.12it/s]  5%|▍         | 12/264 [00:11<03:40,  1.14it/s]  5%|▍         | 13/264 [00:12<03:36,  1.16it/s]  5%|▌         | 14/264 [00:13<03:31,  1.18it/s]  6%|▌         | 15/264 [00:14<03:28,  1.19it/s]  6%|▌         | 16/264 [00:15<03:26,  1.20it/s]  6%|▋         | 17/264 [00:15<03:24,  1.21it/s]  7%|▋         | 18/264 [00:16<03:23,  1.21it/s]  7%|▋         | 19/264 [00:17<03:21,  1.22it/s]  8%|▊         | 20/264 [00:18<03:20,  1.22it/s]  8%|▊         | 21/264 [00:19<03:22,  1.20it/s]  8%|▊         | 22/264 [00:20<03:20,  1.21it/s]  9%|▊         | 23/264 [00:20<03:18,  1.21it/s]  9%|▉         | 24/264 [00:21<03:26,  1.16it/s]  9%|▉         | 25/264 [00:22<03:21,  1.18it/s] 10%|▉         | 26/264 [00:23<03:19,  1.19it/s] 10%|█         | 27/264 [00:24<03:17,  1.20it/s] 11%|█         | 28/264 [00:25<03:15,  1.21it/s] 11%|█         | 29/264 [00:25<03:13,  1.22it/s] 11%|█▏        | 30/264 [00:26<03:11,  1.22it/s] 12%|█▏        | 31/264 [00:27<03:10,  1.22it/s] 12%|█▏        | 32/264 [00:28<03:10,  1.22it/s] 12%|█▎        | 33/264 [00:29<03:08,  1.22it/s] 13%|█▎        | 34/264 [00:30<03:15,  1.17it/s] 13%|█▎        | 35/264 [00:30<03:09,  1.21it/s] 14%|█▎        | 36/264 [00:31<03:15,  1.17it/s] 14%|█▍        | 37/264 [00:32<03:12,  1.18it/s] 14%|█▍        | 38/264 [00:33<03:16,  1.15it/s] 15%|█▍        | 39/264 [00:34<03:16,  1.15it/s] 15%|█▌        | 40/264 [00:35<03:15,  1.15it/s] 16%|█▌        | 41/264 [00:36<03:12,  1.16it/s] 16%|█▌        | 42/264 [00:36<03:07,  1.19it/s] 16%|█▋        | 43/264 [00:37<03:04,  1.20it/s] 17%|█▋        | 44/264 [00:38<03:01,  1.21it/s] 17%|█▋        | 45/264 [00:39<02:59,  1.22it/s] 17%|█▋        | 46/264 [00:40<02:58,  1.22it/s] 18%|█▊        | 47/264 [00:40<02:56,  1.23it/s] 18%|█▊        | 48/264 [00:41<02:55,  1.23it/s] 19%|█▊        | 49/264 [00:42<02:55,  1.22it/s] 19%|█▉        | 50/264 [00:43<02:54,  1.23it/s] 19%|█▉        | 51/264 [00:44<02:54,  1.22it/s] 20%|█▉        | 52/264 [00:45<03:02,  1.16it/s] 20%|██        | 53/264 [00:46<03:03,  1.15it/s] 20%|██        | 54/264 [00:46<03:01,  1.16it/s] 21%|██        | 55/264 [00:47<02:55,  1.19it/s] 21%|██        | 56/264 [00:48<02:55,  1.19it/s] 22%|██▏       | 57/264 [00:49<02:51,  1.21it/s] 22%|██▏       | 58/264 [00:50<02:50,  1.21it/s] 22%|██▏       | 59/264 [00:51<02:58,  1.15it/s] 23%|██▎       | 60/264 [00:51<02:53,  1.18it/s] 23%|██▎       | 61/264 [00:52<02:53,  1.17it/s] 23%|██▎       | 62/264 [00:53<02:49,  1.19it/s] 24%|██▍       | 63/264 [00:54<02:47,  1.20it/s] 24%|██▍       | 64/264 [00:55<02:51,  1.17it/s] 25%|██▍       | 65/264 [00:56<02:51,  1.16it/s] 25%|██▌       | 66/264 [00:57<02:48,  1.17it/s] 25%|██▌       | 67/264 [00:57<02:47,  1.17it/s] 26%|██▌       | 68/264 [00:58<02:49,  1.16it/s] 26%|██▌       | 69/264 [00:59<02:46,  1.17it/s] 27%|██▋       | 70/264 [01:00<02:42,  1.20it/s] 27%|██▋       | 71/264 [01:01<02:40,  1.20it/s] 27%|██▋       | 72/264 [01:02<02:39,  1.20it/s] 28%|██▊       | 73/264 [01:02<02:37,  1.21it/s] 28%|██▊       | 74/264 [01:03<02:44,  1.15it/s] 28%|██▊       | 75/264 [01:04<02:40,  1.17it/s] 29%|██▉       | 76/264 [01:05<02:37,  1.19it/s] 29%|██▉       | 77/264 [01:06<02:42,  1.15it/s] 30%|██▉       | 78/264 [01:07<02:44,  1.13it/s] 30%|██▉       | 79/264 [01:08<02:42,  1.14it/s] 30%|███       | 80/264 [01:09<02:41,  1.14it/s] 31%|███       | 81/264 [01:09<02:41,  1.13it/s] 31%|███       | 82/264 [01:10<02:42,  1.12it/s] 31%|███▏      | 83/264 [01:11<02:36,  1.16it/s] 32%|███▏      | 84/264 [01:12<02:38,  1.14it/s] 32%|███▏      | 85/264 [01:13<02:36,  1.14it/s] 33%|███▎      | 86/264 [01:14<02:37,  1.13it/s] 33%|███▎      | 87/264 [01:15<02:35,  1.14it/s] 33%|███▎      | 88/264 [01:16<02:31,  1.16it/s] 34%|███▎      | 89/264 [01:16<02:27,  1.18it/s] 34%|███▍      | 90/264 [01:17<02:25,  1.20it/s] 34%|███▍      | 91/264 [01:18<02:23,  1.21it/s] 35%|███▍      | 92/264 [01:19<02:22,  1.21it/s] 35%|███▌      | 93/264 [01:20<02:21,  1.21it/s] 36%|███▌      | 94/264 [01:20<02:19,  1.22it/s] 36%|███▌      | 95/264 [01:21<02:18,  1.22it/s] 36%|███▋      | 96/264 [01:22<02:17,  1.22it/s] 37%|███▋      | 97/264 [01:23<02:15,  1.23it/s] 37%|███▋      | 98/264 [01:24<02:15,  1.23it/s] 38%|███▊      | 99/264 [01:24<02:13,  1.23it/s] 38%|███▊      | 100/264 [01:25<02:12,  1.24it/s] 38%|███▊      | 101/264 [01:26<02:13,  1.22it/s] 39%|███▊      | 102/264 [01:27<02:12,  1.23it/s] 39%|███▉      | 103/264 [01:28<02:10,  1.23it/s] 39%|███▉      | 104/264 [01:29<02:10,  1.23it/s] 40%|███▉      | 105/264 [01:29<02:09,  1.23it/s] 40%|████      | 106/264 [01:30<02:16,  1.16it/s] 41%|████      | 107/264 [01:31<02:13,  1.18it/s] 41%|████      | 108/264 [01:32<02:14,  1.16it/s] 41%|████▏     | 109/264 [01:33<02:12,  1.17it/s] 42%|████▏     | 110/264 [01:34<02:12,  1.16it/s] 42%|████▏     | 111/264 [01:35<02:12,  1.15it/s] 42%|████▏     | 112/264 [01:36<02:15,  1.12it/s] 43%|████▎     | 113/264 [01:36<02:10,  1.16it/s] 43%|████▎     | 114/264 [01:37<02:10,  1.15it/s] 44%|████▎     | 115/264 [01:38<02:07,  1.17it/s] 44%|████▍     | 116/264 [01:39<02:09,  1.14it/s] 44%|████▍     | 117/264 [01:40<02:09,  1.13it/s] 45%|████▍     | 118/264 [01:41<02:06,  1.15it/s] 45%|████▌     | 119/264 [01:42<02:03,  1.18it/s] 45%|████▌     | 120/264 [01:42<02:01,  1.18it/s] 46%|████▌     | 121/264 [01:43<02:00,  1.19it/s] 46%|████▌     | 122/264 [01:44<02:05,  1.14it/s] 47%|████▋     | 123/264 [01:45<02:01,  1.16it/s] 47%|████▋     | 124/264 [01:46<02:00,  1.16it/s] 47%|████▋     | 125/264 [01:47<02:02,  1.14it/s] 48%|████▊     | 126/264 [01:48<01:59,  1.16it/s] 48%|████▊     | 127/264 [01:48<01:55,  1.18it/s] 48%|████▊     | 128/264 [01:49<01:54,  1.19it/s] 49%|████▉     | 129/264 [01:50<01:51,  1.21it/s] 49%|████▉     | 130/264 [01:51<01:50,  1.21it/s] 50%|████▉     | 131/264 [01:52<01:49,  1.21it/s] 50%|█████     | 132/264 [01:53<01:48,  1.22it/s] 50%|█████     | 133/264 [01:53<01:46,  1.22it/s] 51%|█████     | 134/264 [01:54<01:46,  1.22it/s] 51%|█████     | 135/264 [01:55<01:50,  1.17it/s] 52%|█████▏    | 136/264 [01:56<01:47,  1.19it/s] 52%|█████▏    | 137/264 [01:57<01:45,  1.20it/s] 52%|█████▏    | 138/264 [01:58<01:45,  1.20it/s] 53%|█████▎    | 139/264 [01:58<01:47,  1.16it/s] 53%|█████▎    | 140/264 [01:59<01:44,  1.19it/s] 53%|█████▎    | 141/264 [02:00<01:43,  1.19it/s] 54%|█████▍    | 142/264 [02:01<01:41,  1.21it/s] 54%|█████▍    | 143/264 [02:02<01:40,  1.21it/s] 55%|█████▍    | 144/264 [02:03<01:38,  1.22it/s] 55%|█████▍    | 145/264 [02:03<01:37,  1.22it/s] 55%|█████▌    | 146/264 [02:04<01:39,  1.19it/s] 56%|█████▌    | 147/264 [02:05<01:40,  1.16it/s] 56%|█████▌    | 148/264 [02:06<01:37,  1.19it/s] 56%|█████▋    | 149/264 [02:07<01:39,  1.16it/s] 57%|█████▋    | 150/264 [02:08<01:36,  1.18it/s] 57%|█████▋    | 151/264 [02:09<01:34,  1.19it/s] 58%|█████▊    | 152/264 [02:09<01:33,  1.20it/s] 58%|█████▊    | 153/264 [02:10<01:34,  1.17it/s] 58%|█████▊    | 154/264 [02:11<01:32,  1.19it/s] 59%|█████▊    | 155/264 [02:12<01:30,  1.20it/s] 59%|█████▉    | 156/264 [02:13<01:29,  1.21it/s] 59%|█████▉    | 157/264 [02:14<01:31,  1.17it/s] 60%|█████▉    | 158/264 [02:14<01:31,  1.16it/s] 60%|██████    | 159/264 [02:15<01:31,  1.14it/s] 61%|██████    | 160/264 [02:16<01:33,  1.12it/s] 61%|██████    | 161/264 [02:17<01:30,  1.14it/s] 61%|██████▏   | 162/264 [02:18<01:28,  1.15it/s] 62%|██████▏   | 163/264 [02:19<01:24,  1.19it/s] 62%|██████▏   | 164/264 [02:20<01:22,  1.21it/s] 62%|██████▎   | 165/264 [02:21<01:25,  1.15it/s] 63%|██████▎   | 166/264 [02:21<01:26,  1.13it/s] 63%|██████▎   | 167/264 [02:22<01:25,  1.13it/s] 64%|██████▎   | 168/264 [02:23<01:25,  1.12it/s] 64%|██████▍   | 169/264 [02:24<01:22,  1.15it/s] 64%|██████▍   | 170/264 [02:25<01:22,  1.14it/s] 65%|██████▍   | 171/264 [02:26<01:19,  1.17it/s] 65%|██████▌   | 172/264 [02:27<01:17,  1.18it/s] 66%|██████▌   | 173/264 [02:27<01:15,  1.20it/s] 66%|██████▌   | 174/264 [02:28<01:14,  1.21it/s] 66%|██████▋   | 175/264 [02:29<01:13,  1.21it/s] 67%|██████▋   | 176/264 [02:30<01:12,  1.21it/s] 67%|██████▋   | 177/264 [02:31<01:11,  1.22it/s] 67%|██████▋   | 178/264 [02:32<01:13,  1.16it/s] 68%|██████▊   | 179/264 [02:32<01:13,  1.16it/s] 68%|██████▊   | 180/264 [02:33<01:13,  1.14it/s] 69%|██████▊   | 181/264 [02:34<01:11,  1.15it/s] 69%|██████▉   | 182/264 [02:35<01:09,  1.18it/s] 69%|██████▉   | 183/264 [02:36<01:10,  1.16it/s] 70%|██████▉   | 184/264 [02:37<01:08,  1.16it/s] 70%|███████   | 185/264 [02:38<01:09,  1.13it/s] 70%|███████   | 186/264 [02:39<01:06,  1.17it/s] 71%|███████   | 187/264 [02:39<01:05,  1.18it/s] 71%|███████   | 188/264 [02:40<01:06,  1.15it/s] 72%|███████▏  | 189/264 [02:41<01:03,  1.17it/s] 72%|███████▏  | 190/264 [02:42<01:01,  1.20it/s] 72%|███████▏  | 191/264 [02:43<01:03,  1.15it/s] 73%|███████▎  | 192/264 [02:44<01:01,  1.18it/s] 73%|███████▎  | 193/264 [02:44<00:59,  1.19it/s] 73%|███████▎  | 194/264 [02:45<00:58,  1.20it/s] 74%|███████▍  | 195/264 [02:46<00:57,  1.21it/s] 74%|███████▍  | 196/264 [02:47<00:55,  1.22it/s] 75%|███████▍  | 197/264 [02:48<00:54,  1.23it/s] 75%|███████▌  | 198/264 [02:49<00:56,  1.17it/s] 75%|███████▌  | 199/264 [02:49<00:54,  1.19it/s] 76%|███████▌  | 200/264 [02:50<00:54,  1.17it/s] 76%|███████▌  | 201/264 [02:51<00:54,  1.16it/s] 77%|███████▋  | 202/264 [02:52<00:53,  1.16it/s] 77%|███████▋  | 203/264 [02:53<00:53,  1.15it/s] 77%|███████▋  | 204/264 [02:54<00:51,  1.17it/s] 78%|███████▊  | 205/264 [02:55<00:50,  1.16it/s] 78%|███████▊  | 206/264 [02:56<00:50,  1.14it/s] 78%|███████▊  | 207/264 [02:56<00:49,  1.15it/s] 79%|███████▉  | 208/264 [02:57<00:48,  1.16it/s] 79%|███████▉  | 209/264 [02:58<00:46,  1.19it/s] 80%|███████▉  | 210/264 [02:59<00:46,  1.16it/s] 80%|███████▉  | 211/264 [03:00<00:45,  1.16it/s] 80%|████████  | 212/264 [03:01<00:45,  1.15it/s] 81%|████████  | 213/264 [03:02<00:44,  1.14it/s] 81%|████████  | 214/264 [03:02<00:44,  1.13it/s] 81%|████████▏ | 215/264 [03:03<00:42,  1.16it/s] 82%|████████▏ | 216/264 [03:04<00:41,  1.17it/s] 82%|████████▏ | 217/264 [03:05<00:39,  1.19it/s] 83%|████████▎ | 218/264 [03:06<00:38,  1.19it/s] 83%|████████▎ | 219/264 [03:07<00:37,  1.20it/s] 83%|████████▎ | 220/264 [03:07<00:36,  1.21it/s] 84%|████████▎ | 221/264 [03:08<00:35,  1.20it/s] 84%|████████▍ | 222/264 [03:09<00:34,  1.20it/s] 84%|████████▍ | 223/264 [03:10<00:33,  1.21it/s] 85%|████████▍ | 224/264 [03:11<00:32,  1.23it/s] 85%|████████▌ | 225/264 [03:12<00:31,  1.23it/s] 86%|████████▌ | 226/264 [03:12<00:31,  1.22it/s] 86%|████████▌ | 227/264 [03:13<00:30,  1.22it/s] 86%|████████▋ | 228/264 [03:14<00:29,  1.21it/s] 87%|████████▋ | 229/264 [03:15<00:30,  1.15it/s] 87%|████████▋ | 230/264 [03:16<00:28,  1.18it/s] 88%|████████▊ | 231/264 [03:17<00:27,  1.20it/s] 88%|████████▊ | 232/264 [03:18<00:27,  1.16it/s] 88%|████████▊ | 233/264 [03:18<00:27,  1.12it/s] 89%|████████▊ | 234/264 [03:19<00:26,  1.12it/s] 89%|████████▉ | 235/264 [03:20<00:25,  1.14it/s] 89%|████████▉ | 236/264 [03:21<00:24,  1.16it/s] 90%|████████▉ | 237/264 [03:22<00:23,  1.17it/s] 90%|█████████ | 238/264 [03:23<00:22,  1.18it/s] 91%|█████████ | 239/264 [03:24<00:21,  1.19it/s] 91%|█████████ | 240/264 [03:24<00:20,  1.19it/s] 91%|█████████▏| 241/264 [03:25<00:19,  1.19it/s] 92%|█████████▏| 242/264 [03:26<00:18,  1.19it/s] 92%|█████████▏| 243/264 [03:27<00:17,  1.20it/s] 92%|█████████▏| 244/264 [03:28<00:16,  1.19it/s] 93%|█████████▎| 245/264 [03:29<00:15,  1.20it/s] 93%|█████████▎| 246/264 [03:29<00:14,  1.21it/s] 94%|█████████▎| 247/264 [03:30<00:14,  1.18it/s] 94%|█████████▍| 248/264 [03:31<00:13,  1.20it/s] 94%|█████████▍| 249/264 [03:32<00:12,  1.17it/s] 95%|█████████▍| 250/264 [03:33<00:11,  1.19it/s] 95%|█████████▌| 251/264 [03:34<00:11,  1.17it/s] 95%|█████████▌| 252/264 [03:34<00:10,  1.19it/s] 96%|█████████▌| 253/264 [03:35<00:09,  1.21it/s] 96%|█████████▌| 254/264 [03:36<00:08,  1.21it/s] 97%|█████████▋| 255/264 [03:37<00:07,  1.21it/s] 97%|█████████▋| 256/264 [03:38<00:06,  1.22it/s] 97%|█████████▋| 257/264 [03:39<00:06,  1.17it/s] 98%|█████████▊| 258/264 [03:39<00:05,  1.18it/s] 98%|█████████▊| 259/264 [03:40<00:04,  1.16it/s] 98%|█████████▊| 260/264 [03:41<00:03,  1.18it/s] 99%|█████████▉| 261/264 [03:42<00:02,  1.23it/s] 99%|█████████▉| 262/264 [03:43<00:01,  1.29it/s]100%|█████████▉| 263/264 [03:43<00:00,  1.32it/s]100%|██████████| 264/264 [03:44<00:00,  1.35it/s]100%|██████████| 264/264 [03:44<00:00,  1.18it/s]Save Model
Save current model ...
[Error] Traceback (most recent call last):
  File "train.py", line 346, in train
    best_model, best_loss, current_model = \
  File "train.py", line 439, in save_model
    model_path = os.path.join(save_dir, current_model)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 328, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 401, in _legacy_save
    pickler.dump(obj)
AttributeError: Can't pickle local object 'train.<locals>.ModelWithLoss'

Can't pickle local object 'train.<locals>.ModelWithLoss'
Step: 4000. Epoch: 15/30. Iteration: 41/264. Cls loss: 25.75242. Reg loss: 0.02659. Total loss: 25.77901
Step 4000: Current Classification Loss:25.752424; Current Regression Loss:0.026586; Current Loss:25.779011;              Average Classification Loss:21.286176; Average Regression Loss:0.045459; Average Loss:21.331635; Current Learning Rate:0.000100.
Save Model
Save current model ...
[Error] Traceback (most recent call last):
  File "train.py", line 346, in train
    best_model, best_loss, current_model = \
  File "train.py", line 439, in save_model
    model_path = os.path.join(save_dir, current_model)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 328, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 401, in _legacy_save
    pickler.dump(obj)
AttributeError: Can't pickle local object 'train.<locals>.ModelWithLoss'

Can't pickle local object 'train.<locals>.ModelWithLoss'
Step: 4100. Epoch: 15/30. Iteration: 141/264. Cls loss: 19.72599. Reg loss: 0.06360. Total loss: 19.78959
Step 4100: Current Classification Loss:19.725994; Current Regression Loss:0.063597; Current Loss:19.789591;              Average Classification Loss:20.819787; Average Regression Loss:0.052428; Average Loss:20.872215; Current Learning Rate:0.000100.
Save Model
Save current model ...
[Error] Traceback (most recent call last):
  File "train.py", line 346, in train
    best_model, best_loss, current_model = \
  File "train.py", line 439, in save_model
    model_path = os.path.join(save_dir, current_model)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 328, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 401, in _legacy_save
    pickler.dump(obj)
AttributeError: Can't pickle local object 'train.<locals>.ModelWithLoss'

Can't pickle local object 'train.<locals>.ModelWithLoss'
Step: 4200. Epoch: 15/30. Iteration: 241/264. Cls loss: 37.31068. Reg loss: 0.04861. Total loss: 37.35929
Step 4200: Current Classification Loss:37.310680; Current Regression Loss:0.048605; Current Loss:37.359287;              Average Classification Loss:19.981649; Average Regression Loss:0.051002; Average Loss:20.032651; Current Learning Rate:0.000100.

  0%|          | 0/264 [00:00<?, ?it/s]Val. Epoch: 15/30. Classification loss: 9.64337. Regression loss: 0.09160. Total loss: 9.73497
--------------------------------------------After Epoch 15------------------------------------------------
Step 4224: Validation Classification Loss:9.643371; Regression Loss:0.091601; Total Loss:9.734972
----------------------------------------------------------------------------------------------------------
  0%|          | 1/264 [00:01<08:34,  1.96s/it]  1%|          | 2/264 [00:02<07:15,  1.66s/it]  1%|          | 3/264 [00:03<06:16,  1.44s/it]  2%|▏         | 4/264 [00:04<05:33,  1.28s/it]  2%|▏         | 5/264 [00:05<05:06,  1.18s/it]  2%|▏         | 6/264 [00:06<04:38,  1.08s/it]  3%|▎         | 7/264 [00:07<04:19,  1.01s/it]  3%|▎         | 8/264 [00:08<04:03,  1.05it/s]  3%|▎         | 9/264 [00:09<04:01,  1.06it/s]  4%|▍         | 10/264 [00:10<03:56,  1.08it/s]  4%|▍         | 11/264 [00:10<03:55,  1.07it/s]  5%|▍         | 12/264 [00:11<03:49,  1.10it/s]  5%|▍         | 13/264 [00:12<03:46,  1.11it/s]  5%|▌         | 14/264 [00:13<03:47,  1.10it/s]  6%|▌         | 15/264 [00:14<03:43,  1.11it/s]  6%|▌         | 16/264 [00:15<03:36,  1.14it/s]  6%|▋         | 17/264 [00:16<03:33,  1.16it/s]  7%|▋         | 18/264 [00:16<03:27,  1.18it/s]  7%|▋         | 19/264 [00:17<03:32,  1.15it/s]  8%|▊         | 20/264 [00:18<03:24,  1.19it/s]  8%|▊         | 21/264 [00:19<03:23,  1.20it/s]  8%|▊         | 22/264 [00:20<03:25,  1.18it/s]  9%|▊         | 23/264 [00:21<03:27,  1.16it/s]  9%|▉         | 24/264 [00:22<03:23,  1.18it/s]  9%|▉         | 25/264 [00:22<03:22,  1.18it/s] 10%|▉         | 26/264 [00:23<03:18,  1.20it/s] 10%|█         | 27/264 [00:24<03:16,  1.21it/s] 11%|█         | 28/264 [00:25<03:14,  1.21it/s] 11%|█         | 29/264 [00:26<03:14,  1.21it/s] 11%|█▏        | 30/264 [00:27<03:12,  1.22it/s] 12%|█▏        | 31/264 [00:27<03:13,  1.20it/s] 12%|█▏        | 32/264 [00:28<03:13,  1.20it/s] 12%|█▎        | 33/264 [00:29<03:12,  1.20it/s] 13%|█▎        | 34/264 [00:30<03:18,  1.16it/s] 13%|█▎        | 35/264 [00:31<03:20,  1.14it/s] 14%|█▎        | 36/264 [00:32<03:13,  1.18it/s] 14%|█▍        | 37/264 [00:33<03:14,  1.17it/s] 14%|█▍        | 38/264 [00:33<03:19,  1.14it/s] 15%|█▍        | 39/264 [00:34<03:23,  1.10it/s] 15%|█▌        | 40/264 [00:35<03:23,  1.10it/s] 16%|█▌        | 41/264 [00:36<03:16,  1.14it/s] 16%|█▌        | 42/264 [00:37<03:13,  1.15it/s] 16%|█▋        | 43/264 [00:38<03:14,  1.14it/s] 17%|█▋        | 44/264 [00:39<03:06,  1.18it/s] 17%|█▋        | 45/264 [00:40<03:08,  1.16it/s] 17%|█▋        | 46/264 [00:40<03:10,  1.14it/s] 18%|█▊        | 47/264 [00:41<03:12,  1.13it/s] 18%|█▊        | 48/264 [00:42<03:12,  1.12it/s] 19%|█▊        | 49/264 [00:43<03:06,  1.15it/s] 19%|█▉        | 50/264 [00:44<03:08,  1.14it/s] 19%|█▉        | 51/264 [00:45<03:04,  1.16it/s] 20%|█▉        | 52/264 [00:46<02:58,  1.19it/s] 20%|██        | 53/264 [00:46<02:56,  1.19it/s] 20%|██        | 54/264 [00:47<02:55,  1.20it/s] 21%|██        | 55/264 [00:48<03:01,  1.15it/s] 21%|██        | 56/264 [00:49<03:00,  1.15it/s] 22%|██▏       | 57/264 [00:50<02:57,  1.17it/s] 22%|██▏       | 58/264 [00:51<02:55,  1.17it/s] 22%|██▏       | 59/264 [00:52<02:51,  1.20it/s] 23%|██▎       | 60/264 [00:52<02:49,  1.20it/s] 23%|██▎       | 61/264 [00:53<02:47,  1.21it/s] 23%|██▎       | 62/264 [00:54<02:46,  1.21it/s] 24%|██▍       | 63/264 [00:55<02:45,  1.22it/s] 24%|██▍       | 64/264 [00:56<02:44,  1.22it/s] 25%|██▍       | 65/264 [00:57<02:52,  1.16it/s] 25%|██▌       | 66/264 [00:57<02:47,  1.18it/s] 25%|██▌       | 67/264 [00:58<02:46,  1.18it/s] 26%|██▌       | 68/264 [00:59<02:43,  1.20it/s] 26%|██▌       | 69/264 [01:00<02:47,  1.17it/s] 27%|██▋       | 70/264 [01:01<02:48,  1.15it/s] 27%|██▋       | 71/264 [01:02<02:50,  1.13it/s] 27%|██▋       | 72/264 [01:03<02:43,  1.17it/s] 28%|██▊       | 73/264 [01:03<02:40,  1.19it/s] 28%|██▊       | 74/264 [01:04<02:38,  1.20it/s] 28%|██▊       | 75/264 [01:05<02:41,  1.17it/s] 29%|██▉       | 76/264 [01:06<02:42,  1.16it/s] 29%|██▉       | 77/264 [01:07<02:38,  1.18it/s] 30%|██▉       | 78/264 [01:08<02:35,  1.19it/s] 30%|██▉       | 79/264 [01:08<02:34,  1.20it/s] 30%|███       | 80/264 [01:09<02:31,  1.21it/s] 31%|███       | 81/264 [01:10<02:32,  1.20it/s] 31%|███       | 82/264 [01:11<02:30,  1.21it/s] 31%|███▏      | 83/264 [01:12<02:28,  1.22it/s] 32%|███▏      | 84/264 [01:13<02:27,  1.22it/s] 32%|███▏      | 85/264 [01:13<02:26,  1.22it/s] 33%|███▎      | 86/264 [01:14<02:25,  1.22it/s] 33%|███▎      | 87/264 [01:15<02:24,  1.22it/s] 33%|███▎      | 88/264 [01:16<02:23,  1.23it/s] 34%|███▎      | 89/264 [01:17<02:22,  1.23it/s] 34%|███▍      | 90/264 [01:17<02:21,  1.23it/s] 34%|███▍      | 91/264 [01:18<02:20,  1.23it/s] 35%|███▍      | 92/264 [01:19<02:19,  1.23it/s] 35%|███▌      | 93/264 [01:20<02:18,  1.24it/s] 36%|███▌      | 94/264 [01:21<02:17,  1.23it/s] 36%|███▌      | 95/264 [01:22<02:19,  1.21it/s] 36%|███▋      | 96/264 [01:22<02:17,  1.22it/s] 37%|███▋      | 97/264 [01:23<02:16,  1.23it/s] 37%|███▋      | 98/264 [01:24<02:14,  1.23it/s] 38%|███▊      | 99/264 [01:25<02:14,  1.23it/s] 38%|███▊      | 100/264 [01:26<02:13,  1.23it/s] 38%|███▊      | 101/264 [01:26<02:12,  1.23it/s] 39%|███▊      | 102/264 [01:27<02:11,  1.23it/s] 39%|███▉      | 103/264 [01:28<02:11,  1.23it/s] 39%|███▉      | 104/264 [01:29<02:16,  1.17it/s] 40%|███▉      | 105/264 [01:30<02:19,  1.14it/s] 40%|████      | 106/264 [01:31<02:18,  1.14it/s] 41%|████      | 107/264 [01:32<02:18,  1.13it/s] 41%|████      | 108/264 [01:33<02:18,  1.12it/s] 41%|████▏     | 109/264 [01:34<02:21,  1.10it/s] 42%|████▏     | 110/264 [01:34<02:14,  1.15it/s] 42%|████▏     | 111/264 [01:35<02:10,  1.17it/s] 42%|████▏     | 112/264 [01:36<02:08,  1.18it/s] 43%|████▎     | 113/264 [01:37<02:06,  1.19it/s] 43%|████▎     | 114/264 [01:38<02:05,  1.20it/s] 44%|████▎     | 115/264 [01:39<02:07,  1.17it/s] 44%|████▍     | 116/264 [01:39<02:06,  1.17it/s] 44%|████▍     | 117/264 [01:40<02:07,  1.15it/s] 45%|████▍     | 118/264 [01:41<02:08,  1.13it/s] 45%|████▌     | 119/264 [01:42<02:04,  1.16it/s] 45%|████▌     | 120/264 [01:43<02:04,  1.15it/s] 46%|████▌     | 121/264 [01:44<02:01,  1.17it/s] 46%|████▌     | 122/264 [01:45<02:03,  1.15it/s] 47%|████▋     | 123/264 [01:45<02:02,  1.15it/s] 47%|████▋     | 124/264 [01:46<01:58,  1.19it/s] 47%|████▋     | 125/264 [01:47<01:56,  1.19it/s] 48%|████▊     | 126/264 [01:48<02:00,  1.15it/s] 48%|████▊     | 127/264 [01:49<02:00,  1.13it/s] 48%|████▊     | 128/264 [01:50<02:01,  1.12it/s] 49%|████▉     | 129/264 [01:51<01:56,  1.16it/s] 49%|████▉     | 130/264 [01:51<01:54,  1.17it/s] 50%|████▉     | 131/264 [01:52<01:55,  1.15it/s] 50%|█████     | 132/264 [01:53<01:52,  1.17it/s] 50%|█████     | 133/264 [01:54<01:55,  1.13it/s] 51%|█████     | 134/264 [01:55<01:51,  1.17it/s] 51%|█████     | 135/264 [01:56<01:48,  1.19it/s] 52%|█████▏    | 136/264 [01:57<01:46,  1.20it/s] 52%|█████▏    | 137/264 [01:57<01:46,  1.19it/s] 52%|█████▏    | 138/264 [01:58<01:44,  1.21it/s] 53%|█████▎    | 139/264 [01:59<01:49,  1.15it/s] 53%|█████▎    | 140/264 [02:00<01:45,  1.17it/s] 53%|█████▎    | 141/264 [02:01<01:47,  1.15it/s] 54%|█████▍    | 142/264 [02:02<01:46,  1.14it/s] 54%|█████▍    | 143/264 [02:03<01:43,  1.17it/s] 55%|█████▍    | 144/264 [02:03<01:42,  1.18it/s] 55%|█████▍    | 145/264 [02:04<01:39,  1.20it/s] 55%|█████▌    | 146/264 [02:05<01:41,  1.17it/s] 56%|█████▌    | 147/264 [02:06<01:42,  1.14it/s] 56%|█████▌    | 148/264 [02:07<01:39,  1.17it/s] 56%|█████▋    | 149/264 [02:08<01:37,  1.18it/s] 57%|█████▋    | 150/264 [02:09<01:36,  1.19it/s] 57%|█████▋    | 151/264 [02:09<01:36,  1.18it/s] 58%|█████▊    | 152/264 [02:10<01:34,  1.19it/s] 58%|█████▊    | 153/264 [02:11<01:33,  1.19it/s] 58%|█████▊    | 154/264 [02:12<01:31,  1.20it/s] 59%|█████▊    | 155/264 [02:13<01:29,  1.21it/s] 59%|█████▉    | 156/264 [02:14<01:32,  1.17it/s] 59%|█████▉    | 157/264 [02:15<01:33,  1.14it/s] 60%|█████▉    | 158/264 [02:15<01:30,  1.17it/s] 60%|██████    | 159/264 [02:16<01:32,  1.13it/s] 61%|██████    | 160/264 [02:17<01:31,  1.14it/s] 61%|██████    | 161/264 [02:18<01:27,  1.17it/s] 61%|██████▏   | 162/264 [02:19<01:26,  1.18it/s] 62%|██████▏   | 163/264 [02:20<01:24,  1.19it/s] 62%|██████▏   | 164/264 [02:21<01:26,  1.15it/s] 62%|██████▎   | 165/264 [02:22<01:29,  1.11it/s] 63%|██████▎   | 166/264 [02:22<01:27,  1.13it/s] 63%|██████▎   | 167/264 [02:23<01:26,  1.13it/s] 64%|██████▎   | 168/264 [02:24<01:24,  1.14it/s] 64%|██████▍   | 169/264 [02:25<01:24,  1.12it/s] 64%|██████▍   | 170/264 [02:26<01:21,  1.16it/s] 65%|██████▍   | 171/264 [02:27<01:23,  1.12it/s] 65%|██████▌   | 172/264 [02:28<01:19,  1.16it/s] 66%|██████▌   | 173/264 [02:28<01:17,  1.18it/s] 66%|██████▌   | 174/264 [02:29<01:15,  1.19it/s] 66%|██████▋   | 175/264 [02:30<01:16,  1.16it/s] 67%|██████▋   | 176/264 [02:31<01:14,  1.19it/s] 67%|██████▋   | 177/264 [02:32<01:12,  1.21it/s] 67%|██████▋   | 178/264 [02:33<01:10,  1.22it/s] 68%|██████▊   | 179/264 [02:33<01:10,  1.20it/s] 68%|██████▊   | 180/264 [02:34<01:09,  1.21it/s] 69%|██████▊   | 181/264 [02:35<01:08,  1.21it/s] 69%|██████▉   | 182/264 [02:36<01:08,  1.19it/s] 69%|██████▉   | 183/264 [02:37<01:07,  1.19it/s] 70%|██████▉   | 184/264 [02:38<01:06,  1.21it/s] 70%|███████   | 185/264 [02:38<01:06,  1.18it/s] 70%|███████   | 186/264 [02:39<01:07,  1.16it/s] 71%|███████   | 187/264 [02:40<01:06,  1.15it/s] 71%|███████   | 188/264 [02:41<01:05,  1.16it/s] 72%|███████▏  | 189/264 [02:42<01:04,  1.17it/s] 72%|███████▏  | 190/264 [02:43<01:03,  1.16it/s] 72%|███████▏  | 191/264 [02:44<01:03,  1.15it/s] 73%|███████▎  | 192/264 [02:45<01:03,  1.14it/s] 73%|███████▎  | 193/264 [02:46<01:04,  1.10it/s] 73%|███████▎  | 194/264 [02:46<01:01,  1.14it/s] 74%|███████▍  | 195/264 [02:47<00:59,  1.16it/s] 74%|███████▍  | 196/264 [02:48<00:56,  1.20it/s] 75%|███████▍  | 197/264 [02:49<00:57,  1.16it/s] 75%|███████▌  | 198/264 [02:50<00:56,  1.16it/s] 75%|███████▌  | 199/264 [02:51<00:55,  1.17it/s] 76%|███████▌  | 200/264 [02:51<00:54,  1.18it/s] 76%|███████▌  | 201/264 [02:52<00:54,  1.16it/s] 77%|███████▋  | 202/264 [02:53<00:51,  1.20it/s] 77%|███████▋  | 203/264 [02:54<00:52,  1.15it/s] 77%|███████▋  | 204/264 [02:55<00:51,  1.17it/s] 78%|███████▊  | 205/264 [02:56<00:49,  1.19it/s] 78%|███████▊  | 206/264 [02:57<00:49,  1.16it/s] 78%|███████▊  | 207/264 [02:58<00:51,  1.11it/s] 79%|███████▉  | 208/264 [02:58<00:49,  1.14it/s] 79%|███████▉  | 209/264 [02:59<00:48,  1.14it/s] 80%|███████▉  | 210/264 [03:00<00:48,  1.12it/s] 80%|███████▉  | 211/264 [03:01<00:46,  1.15it/s] 80%|████████  | 212/264 [03:02<00:44,  1.16it/s] 81%|████████  | 213/264 [03:03<00:44,  1.14it/s] 81%|████████  | 214/264 [03:04<00:44,  1.12it/s] 81%|████████▏ | 215/264 [03:04<00:42,  1.16it/s] 82%|████████▏ | 216/264 [03:05<00:40,  1.19it/s] 82%|████████▏ | 217/264 [03:06<00:39,  1.19it/s] 83%|████████▎ | 218/264 [03:07<00:38,  1.20it/s] 83%|████████▎ | 219/264 [03:08<00:37,  1.21it/s] 83%|████████▎ | 220/264 [03:09<00:36,  1.22it/s] 84%|████████▎ | 221/264 [03:10<00:37,  1.15it/s] 84%|████████▍ | 222/264 [03:10<00:36,  1.14it/s] 84%|████████▍ | 223/264 [03:11<00:36,  1.13it/s] 85%|████████▍ | 224/264 [03:12<00:34,  1.17it/s] 85%|████████▌ | 225/264 [03:13<00:32,  1.18it/s] 86%|████████▌ | 226/264 [03:14<00:32,  1.19it/s] 86%|████████▌ | 227/264 [03:15<00:32,  1.15it/s] 86%|████████▋ | 228/264 [03:16<00:30,  1.17it/s] 87%|████████▋ | 229/264 [03:16<00:30,  1.16it/s] 87%|████████▋ | 230/264 [03:17<00:29,  1.16it/s] 88%|████████▊ | 231/264 [03:18<00:28,  1.16it/s] 88%|████████▊ | 232/264 [03:19<00:27,  1.17it/s] 88%|████████▊ | 233/264 [03:20<00:26,  1.17it/s] 89%|████████▊ | 234/264 [03:21<00:25,  1.18it/s] 89%|████████▉ | 235/264 [03:22<00:24,  1.17it/s] 89%|████████▉ | 236/264 [03:22<00:24,  1.16it/s] 90%|████████▉ | 237/264 [03:23<00:23,  1.14it/s] 90%|█████████ | 238/264 [03:24<00:22,  1.17it/s] 91%|█████████ | 239/264 [03:25<00:21,  1.17it/s] 91%|█████████ | 240/264 [03:26<00:20,  1.18it/s] 91%|█████████▏| 241/264 [03:27<00:19,  1.19it/s] 92%|█████████▏| 242/264 [03:27<00:18,  1.20it/s] 92%|█████████▏| 243/264 [03:28<00:18,  1.16it/s] 92%|█████████▏| 244/264 [03:29<00:16,  1.19it/s] 93%|█████████▎| 245/264 [03:30<00:15,  1.19it/s] 93%|█████████▎| 246/264 [03:31<00:14,  1.21it/s] 94%|█████████▎| 247/264 [03:32<00:14,  1.16it/s] 94%|█████████▍| 248/264 [03:33<00:13,  1.17it/s] 94%|█████████▍| 249/264 [03:33<00:13,  1.15it/s] 95%|█████████▍| 250/264 [03:34<00:11,  1.18it/s] 95%|█████████▌| 251/264 [03:35<00:11,  1.15it/s] 95%|█████████▌| 252/264 [03:36<00:10,  1.17it/s] 96%|█████████▌| 253/264 [03:37<00:09,  1.18it/s] 96%|█████████▌| 254/264 [03:38<00:08,  1.20it/s] 97%|█████████▋| 255/264 [03:39<00:07,  1.17it/s] 97%|█████████▋| 256/264 [03:39<00:06,  1.16it/s] 97%|█████████▋| 257/264 [03:40<00:05,  1.18it/s] 98%|█████████▊| 258/264 [03:41<00:04,  1.20it/s] 98%|█████████▊| 259/264 [03:42<00:04,  1.20it/s] 98%|█████████▊| 260/264 [03:43<00:03,  1.21it/s] 99%|█████████▉| 261/264 [03:43<00:02,  1.25it/s] 99%|█████████▉| 262/264 [03:44<00:01,  1.29it/s]100%|█████████▉| 263/264 [03:45<00:00,  1.32it/s]100%|██████████| 264/264 [03:46<00:00,  1.34it/s]100%|██████████| 264/264 [03:46<00:00,  1.17it/s]Save Model
Save current model ...
[Error] Traceback (most recent call last):
  File "train.py", line 346, in train
    best_model, best_loss, current_model = \
  File "train.py", line 439, in save_model
    model_path = os.path.join(save_dir, current_model)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 328, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 401, in _legacy_save
    pickler.dump(obj)
AttributeError: Can't pickle local object 'train.<locals>.ModelWithLoss'

Can't pickle local object 'train.<locals>.ModelWithLoss'
Step: 4300. Epoch: 16/30. Iteration: 77/264. Cls loss: 35.09704. Reg loss: 0.02888. Total loss: 35.12592
Step 4300: Current Classification Loss:35.097038; Current Regression Loss:0.028880; Current Loss:35.125919;              Average Classification Loss:17.804145; Average Regression Loss:0.050347; Average Loss:17.854492; Current Learning Rate:0.000100.
Save Model
Save current model ...
[Error] Traceback (most recent call last):
  File "train.py", line 346, in train
    best_model, best_loss, current_model = \
  File "train.py", line 439, in save_model
    model_path = os.path.join(save_dir, current_model)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 328, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 401, in _legacy_save
    pickler.dump(obj)
AttributeError: Can't pickle local object 'train.<locals>.ModelWithLoss'

Can't pickle local object 'train.<locals>.ModelWithLoss'
Step: 4400. Epoch: 16/30. Iteration: 177/264. Cls loss: 15.71661. Reg loss: 0.02863. Total loss: 15.74524
Step 4400: Current Classification Loss:15.716606; Current Regression Loss:0.028631; Current Loss:15.745237;              Average Classification Loss:16.785129; Average Regression Loss:0.049938; Average Loss:16.835067; Current Learning Rate:0.000100.

  0%|          | 0/264 [00:00<?, ?it/s]Val. Epoch: 16/30. Classification loss: 7.79612. Regression loss: 0.07131. Total loss: 7.86743
--------------------------------------------After Epoch 16------------------------------------------------
Step 4488: Validation Classification Loss:7.796116; Regression Loss:0.071312; Total Loss:7.867428
----------------------------------------------------------------------------------------------------------
  0%|          | 1/264 [00:01<08:22,  1.91s/it]  1%|          | 2/264 [00:02<07:08,  1.63s/it]  1%|          | 3/264 [00:03<06:13,  1.43s/it]  2%|▏         | 4/264 [00:04<05:34,  1.28s/it]  2%|▏         | 5/264 [00:05<04:59,  1.16s/it]  2%|▏         | 6/264 [00:06<04:32,  1.06s/it]  3%|▎         | 7/264 [00:07<04:27,  1.04s/it]  3%|▎         | 8/264 [00:08<04:15,  1.00it/s]  3%|▎         | 9/264 [00:09<03:58,  1.07it/s]  4%|▍         | 10/264 [00:09<03:48,  1.11it/s]  4%|▍         | 11/264 [00:10<03:44,  1.13it/s]  5%|▍         | 12/264 [00:11<03:38,  1.15it/s]  5%|▍         | 13/264 [00:12<03:32,  1.18it/s]  5%|▌         | 14/264 [00:13<03:27,  1.20it/s]  6%|▌         | 15/264 [00:14<03:25,  1.21it/s]  6%|▌         | 16/264 [00:14<03:23,  1.22it/s]  6%|▋         | 17/264 [00:15<03:20,  1.23it/s]  7%|▋         | 18/264 [00:16<03:29,  1.18it/s]  7%|▋         | 19/264 [00:17<03:33,  1.15it/s]  8%|▊         | 20/264 [00:18<03:33,  1.14it/s]  8%|▊         | 21/264 [00:19<03:33,  1.14it/s]  8%|▊         | 22/264 [00:20<03:35,  1.12it/s]  9%|▊         | 23/264 [00:21<03:27,  1.16it/s]  9%|▉         | 24/264 [00:21<03:24,  1.17it/s]  9%|▉         | 25/264 [00:22<03:22,  1.18it/s] 10%|▉         | 26/264 [00:23<03:19,  1.19it/s] 10%|█         | 27/264 [00:24<03:18,  1.20it/s] 11%|█         | 28/264 [00:25<03:17,  1.20it/s] 11%|█         | 29/264 [00:26<03:17,  1.19it/s] 11%|█▏        | 30/264 [00:26<03:16,  1.19it/s] 12%|█▏        | 31/264 [00:27<03:21,  1.16it/s] 12%|█▏        | 32/264 [00:28<03:25,  1.13it/s] 12%|█▎        | 33/264 [00:29<03:21,  1.15it/s] 13%|█▎        | 34/264 [00:30<03:18,  1.16it/s] 13%|█▎        | 35/264 [00:31<03:13,  1.18it/s] 14%|█▎        | 36/264 [00:32<03:16,  1.16it/s] 14%|█▍        | 37/264 [00:32<03:15,  1.16it/s] 14%|█▍        | 38/264 [00:33<03:10,  1.18it/s] 15%|█▍        | 39/264 [00:34<03:15,  1.15it/s] 15%|█▌        | 40/264 [00:35<03:12,  1.17it/s] 16%|█▌        | 41/264 [00:36<03:16,  1.13it/s] 16%|█▌        | 42/264 [00:37<03:11,  1.16it/s] 16%|█▋        | 43/264 [00:38<03:13,  1.14it/s] 17%|█▋        | 44/264 [00:39<03:14,  1.13it/s] 17%|█▋        | 45/264 [00:39<03:08,  1.16it/s] 17%|█▋        | 46/264 [00:40<03:05,  1.18it/s] 18%|█▊        | 47/264 [00:41<03:02,  1.19it/s] 18%|█▊        | 48/264 [00:42<03:06,  1.16it/s] 19%|█▊        | 49/264 [00:43<03:09,  1.14it/s] 19%|█▉        | 50/264 [00:44<03:12,  1.11it/s] 19%|█▉        | 51/264 [00:45<03:08,  1.13it/s] 20%|█▉        | 52/264 [00:45<03:03,  1.16it/s] 20%|██        | 53/264 [00:46<03:00,  1.17it/s] 20%|██        | 54/264 [00:47<03:02,  1.15it/s] 21%|██        | 55/264 [00:48<03:00,  1.16it/s] 21%|██        | 56/264 [00:49<02:57,  1.17it/s] 22%|██▏       | 57/264 [00:50<02:54,  1.18it/s] 22%|██▏       | 58/264 [00:51<02:53,  1.19it/s] 22%|██▏       | 59/264 [00:51<02:50,  1.20it/s] 23%|██▎       | 60/264 [00:52<02:50,  1.20it/s] 23%|██▎       | 61/264 [00:53<02:55,  1.16it/s] 23%|██▎       | 62/264 [00:54<02:54,  1.16it/s] 24%|██▍       | 63/264 [00:55<02:51,  1.17it/s] 24%|██▍       | 64/264 [00:56<02:47,  1.20it/s] 25%|██▍       | 65/264 [00:56<02:45,  1.20it/s] 25%|██▌       | 66/264 [00:57<02:52,  1.15it/s] 25%|██▌       | 67/264 [00:58<02:50,  1.16it/s] 26%|██▌       | 68/264 [00:59<02:50,  1.15it/s] 26%|██▌       | 69/264 [01:00<02:45,  1.18it/s] 27%|██▋       | 70/264 [01:01<02:49,  1.15it/s] 27%|██▋       | 71/264 [01:02<02:48,  1.14it/s] 27%|██▋       | 72/264 [01:03<02:48,  1.14it/s] 28%|██▊       | 73/264 [01:04<02:48,  1.14it/s] 28%|██▊       | 74/264 [01:04<02:46,  1.14it/s] 28%|██▊       | 75/264 [01:05<02:44,  1.15it/s] 29%|██▉       | 76/264 [01:06<02:47,  1.12it/s] 29%|██▉       | 77/264 [01:07<02:51,  1.09it/s] 30%|██▉       | 78/264 [01:08<02:43,  1.13it/s] 30%|██▉       | 79/264 [01:09<02:47,  1.11it/s] 30%|███       | 80/264 [01:10<02:47,  1.10it/s] 31%|███       | 81/264 [01:11<02:45,  1.11it/s] 31%|███       | 82/264 [01:12<02:40,  1.13it/s] 31%|███▏      | 83/264 [01:13<02:42,  1.12it/s] 32%|███▏      | 84/264 [01:13<02:40,  1.12it/s] 32%|███▏      | 85/264 [01:14<02:40,  1.11it/s] 33%|███▎      | 86/264 [01:15<02:37,  1.13it/s] 33%|███▎      | 87/264 [01:16<02:32,  1.16it/s] 33%|███▎      | 88/264 [01:17<02:31,  1.16it/s] 34%|███▎      | 89/264 [01:18<02:35,  1.13it/s] 34%|███▍      | 90/264 [01:19<02:33,  1.13it/s] 34%|███▍      | 91/264 [01:19<02:30,  1.15it/s] 35%|███▍      | 92/264 [01:20<02:29,  1.15it/s] 35%|███▌      | 93/264 [01:21<02:25,  1.17it/s] 36%|███▌      | 94/264 [01:22<02:23,  1.18it/s] 36%|███▌      | 95/264 [01:23<02:26,  1.15it/s] 36%|███▋      | 96/264 [01:24<02:24,  1.16it/s] 37%|███▋      | 97/264 [01:25<02:21,  1.18it/s] 37%|███▋      | 98/264 [01:25<02:19,  1.19it/s] 38%|███▊      | 99/264 [01:26<02:20,  1.17it/s] 38%|███▊      | 100/264 [01:27<02:18,  1.19it/s] 38%|███▊      | 101/264 [01:28<02:16,  1.20it/s] 39%|███▊      | 102/264 [01:29<02:16,  1.19it/s] 39%|███▉      | 103/264 [01:30<02:19,  1.15it/s] 39%|███▉      | 104/264 [01:31<02:20,  1.14it/s] 40%|███▉      | 105/264 [01:31<02:17,  1.15it/s] 40%|████      | 106/264 [01:32<02:13,  1.19it/s] 41%|████      | 107/264 [01:33<02:15,  1.16it/s] 41%|████      | 108/264 [01:34<02:12,  1.17it/s] 41%|████▏     | 109/264 [01:35<02:16,  1.14it/s] 42%|████▏     | 110/264 [01:36<02:17,  1.12it/s] 42%|████▏     | 111/264 [01:37<02:14,  1.14it/s] 42%|████▏     | 112/264 [01:38<02:14,  1.13it/s] 43%|████▎     | 113/264 [01:38<02:15,  1.12it/s] 43%|████▎     | 114/264 [01:39<02:15,  1.11it/s] 44%|████▎     | 115/264 [01:40<02:13,  1.12it/s] 44%|████▍     | 116/264 [01:41<02:14,  1.10it/s] 44%|████▍     | 117/264 [01:42<02:13,  1.10it/s] 45%|████▍     | 118/264 [01:43<02:10,  1.12it/s] 45%|████▌     | 119/264 [01:44<02:06,  1.15it/s] 45%|████▌     | 120/264 [01:45<02:03,  1.17it/s] 46%|████▌     | 121/264 [01:45<02:02,  1.16it/s] 46%|████▌     | 122/264 [01:46<02:00,  1.18it/s] 47%|████▋     | 123/264 [01:47<01:58,  1.19it/s] 47%|████▋     | 124/264 [01:48<02:02,  1.15it/s] 47%|████▋     | 125/264 [01:49<02:01,  1.15it/s] 48%|████▊     | 126/264 [01:50<02:00,  1.14it/s] 48%|████▊     | 127/264 [01:51<02:02,  1.12it/s] 48%|████▊     | 128/264 [01:52<01:59,  1.14it/s] 49%|████▉     | 129/264 [01:53<01:59,  1.13it/s] 49%|████▉     | 130/264 [01:53<01:57,  1.14it/s] 50%|████▉     | 131/264 [01:54<01:57,  1.14it/s] 50%|█████     | 132/264 [01:55<01:57,  1.12it/s] 50%|█████     | 133/264 [01:56<01:53,  1.15it/s] 51%|█████     | 134/264 [01:57<01:50,  1.17it/s] 51%|█████     | 135/264 [01:58<01:49,  1.18it/s] 52%|█████▏    | 136/264 [01:59<01:53,  1.13it/s] 52%|█████▏    | 137/264 [01:59<01:49,  1.16it/s] 52%|█████▏    | 138/264 [02:00<01:47,  1.17it/s] 53%|█████▎    | 139/264 [02:01<01:44,  1.19it/s] 53%|█████▎    | 140/264 [02:02<01:44,  1.19it/s] 53%|█████▎    | 141/264 [02:03<01:42,  1.20it/s] 54%|█████▍    | 142/264 [02:04<01:41,  1.21it/s] 54%|█████▍    | 143/264 [02:05<01:46,  1.14it/s] 55%|█████▍    | 144/264 [02:05<01:45,  1.13it/s] 55%|█████▍    | 145/264 [02:06<01:48,  1.10it/s] 55%|█████▌    | 146/264 [02:07<01:43,  1.14it/s] 56%|█████▌    | 147/264 [02:08<01:44,  1.12it/s] 56%|█████▌    | 148/264 [02:09<01:40,  1.16it/s] 56%|█████▋    | 149/264 [02:10<01:40,  1.15it/s] 57%|█████▋    | 150/264 [02:11<01:37,  1.17it/s] 57%|█████▋    | 151/264 [02:12<01:37,  1.15it/s] 58%|█████▊    | 152/264 [02:12<01:39,  1.12it/s] 58%|█████▊    | 153/264 [02:13<01:36,  1.15it/s] 58%|█████▊    | 154/264 [02:14<01:37,  1.13it/s] 59%|█████▊    | 155/264 [02:15<01:38,  1.10it/s] 59%|█████▉    | 156/264 [02:16<01:33,  1.15it/s] 59%|█████▉    | 157/264 [02:17<01:31,  1.17it/s] 60%|█████▉    | 158/264 [02:18<01:29,  1.18it/s] 60%|██████    | 159/264 [02:18<01:27,  1.20it/s] 61%|██████    | 160/264 [02:19<01:30,  1.15it/s] 61%|██████    | 161/264 [02:20<01:31,  1.13it/s] 61%|██████▏   | 162/264 [02:21<01:31,  1.12it/s] 62%|██████▏   | 163/264 [02:22<01:27,  1.15it/s] 62%|██████▏   | 164/264 [02:23<01:27,  1.15it/s] 62%|██████▎   | 165/264 [02:24<01:26,  1.15it/s] 63%|██████▎   | 166/264 [02:25<01:23,  1.17it/s] 63%|██████▎   | 167/264 [02:25<01:24,  1.15it/s] 64%|██████▎   | 168/264 [02:26<01:23,  1.15it/s] 64%|██████▍   | 169/264 [02:27<01:20,  1.18it/s] 64%|██████▍   | 170/264 [02:28<01:18,  1.20it/s] 65%|██████▍   | 171/264 [02:29<01:18,  1.19it/s] 65%|██████▌   | 172/264 [02:30<01:16,  1.20it/s] 66%|██████▌   | 173/264 [02:30<01:15,  1.20it/s] 66%|██████▌   | 174/264 [02:31<01:14,  1.21it/s] 66%|██████▋   | 175/264 [02:32<01:13,  1.21it/s] 67%|██████▋   | 176/264 [02:33<01:13,  1.20it/s] 67%|██████▋   | 177/264 [02:34<01:16,  1.14it/s] 67%|██████▋   | 178/264 [02:35<01:13,  1.17it/s] 68%|██████▊   | 179/264 [02:36<01:13,  1.16it/s] 68%|██████▊   | 180/264 [02:37<01:13,  1.14it/s] 69%|██████▊   | 181/264 [02:37<01:12,  1.14it/s] 69%|██████▉   | 182/264 [02:38<01:12,  1.14it/s] 69%|██████▉   | 183/264 [02:39<01:10,  1.15it/s] 70%|██████▉   | 184/264 [02:40<01:08,  1.17it/s] 70%|███████   | 185/264 [02:41<01:09,  1.14it/s] 70%|███████   | 186/264 [02:42<01:08,  1.13it/s] 71%|███████   | 187/264 [02:43<01:06,  1.15it/s] 71%|███████   | 188/264 [02:43<01:04,  1.17it/s] 72%|███████▏  | 189/264 [02:44<01:03,  1.19it/s] 72%|███████▏  | 190/264 [02:45<01:02,  1.19it/s] 72%|███████▏  | 191/264 [02:46<01:00,  1.20it/s] 73%|███████▎  | 192/264 [02:47<01:01,  1.17it/s] 73%|███████▎  | 193/264 [02:48<01:00,  1.17it/s] 73%|███████▎  | 194/264 [02:48<00:58,  1.21it/s] 74%|███████▍  | 195/264 [02:49<00:59,  1.16it/s] 74%|███████▍  | 196/264 [02:50<00:58,  1.16it/s] 75%|███████▍  | 197/264 [02:51<00:58,  1.15it/s] 75%|███████▌  | 198/264 [02:52<00:59,  1.10it/s] 75%|███████▌  | 199/264 [02:53<00:57,  1.13it/s] 76%|███████▌  | 200/264 [02:54<00:54,  1.17it/s] 76%|███████▌  | 201/264 [02:55<00:53,  1.18it/s] 77%|███████▋  | 202/264 [02:56<00:54,  1.13it/s] 77%|███████▋  | 203/264 [02:56<00:54,  1.12it/s] 77%|███████▋  | 204/264 [02:57<00:53,  1.12it/s] 78%|███████▊  | 205/264 [02:58<00:51,  1.15it/s] 78%|███████▊  | 206/264 [02:59<00:49,  1.18it/s] 78%|███████▊  | 207/264 [03:00<00:47,  1.19it/s] 79%|███████▉  | 208/264 [03:01<00:46,  1.20it/s] 79%|███████▉  | 209/264 [03:01<00:46,  1.17it/s] 80%|███████▉  | 210/264 [03:02<00:47,  1.15it/s] 80%|███████▉  | 211/264 [03:03<00:44,  1.18it/s] 80%|████████  | 212/264 [03:04<00:43,  1.19it/s] 81%|████████  | 213/264 [03:05<00:42,  1.19it/s] 81%|████████  | 214/264 [03:06<00:43,  1.14it/s] 81%|████████▏ | 215/264 [03:07<00:41,  1.19it/s] 82%|████████▏ | 216/264 [03:07<00:40,  1.19it/s] 82%|████████▏ | 217/264 [03:08<00:40,  1.16it/s] 83%|████████▎ | 218/264 [03:09<00:39,  1.15it/s] 83%|████████▎ | 219/264 [03:10<00:39,  1.15it/s] 83%|████████▎ | 220/264 [03:11<00:39,  1.13it/s] 84%|████████▎ | 221/264 [03:12<00:37,  1.16it/s] 84%|████████▍ | 222/264 [03:13<00:35,  1.17it/s] 84%|████████▍ | 223/264 [03:13<00:34,  1.18it/s] 85%|████████▍ | 224/264 [03:14<00:35,  1.14it/s] 85%|████████▌ | 225/264 [03:15<00:33,  1.16it/s] 86%|████████▌ | 226/264 [03:16<00:32,  1.17it/s] 86%|████████▌ | 227/264 [03:17<00:31,  1.19it/s] 86%|████████▋ | 228/264 [03:18<00:32,  1.12it/s] 87%|████████▋ | 229/264 [03:19<00:30,  1.14it/s] 87%|████████▋ | 230/264 [03:20<00:29,  1.17it/s] 88%|████████▊ | 231/264 [03:21<00:29,  1.12it/s] 88%|████████▊ | 232/264 [03:21<00:29,  1.10it/s] 88%|████████▊ | 233/264 [03:22<00:27,  1.15it/s] 89%|████████▊ | 234/264 [03:23<00:26,  1.13it/s] 89%|████████▉ | 235/264 [03:24<00:26,  1.11it/s] 89%|████████▉ | 236/264 [03:25<00:24,  1.14it/s] 90%|████████▉ | 237/264 [03:26<00:23,  1.15it/s] 90%|█████████ | 238/264 [03:27<00:22,  1.14it/s] 91%|█████████ | 239/264 [03:27<00:21,  1.17it/s] 91%|█████████ | 240/264 [03:28<00:20,  1.19it/s] 91%|█████████▏| 241/264 [03:29<00:20,  1.14it/s] 92%|█████████▏| 242/264 [03:30<00:19,  1.14it/s] 92%|█████████▏| 243/264 [03:31<00:18,  1.17it/s] 92%|█████████▏| 244/264 [03:32<00:16,  1.18it/s] 93%|█████████▎| 245/264 [03:33<00:16,  1.14it/s] 93%|█████████▎| 246/264 [03:34<00:15,  1.16it/s] 94%|█████████▎| 247/264 [03:34<00:14,  1.18it/s] 94%|█████████▍| 248/264 [03:35<00:13,  1.19it/s] 94%|█████████▍| 249/264 [03:36<00:12,  1.20it/s] 95%|█████████▍| 250/264 [03:37<00:11,  1.20it/s] 95%|█████████▌| 251/264 [03:38<00:10,  1.20it/s] 95%|█████████▌| 252/264 [03:39<00:10,  1.15it/s] 96%|█████████▌| 253/264 [03:40<00:09,  1.13it/s] 96%|█████████▌| 254/264 [03:40<00:08,  1.17it/s] 97%|█████████▋| 255/264 [03:41<00:07,  1.16it/s] 97%|█████████▋| 256/264 [03:42<00:06,  1.17it/s] 97%|█████████▋| 257/264 [03:43<00:05,  1.19it/s] 98%|█████████▊| 258/264 [03:44<00:05,  1.20it/s] 98%|█████████▊| 259/264 [03:44<00:04,  1.21it/s] 98%|█████████▊| 260/264 [03:45<00:03,  1.22it/s] 99%|█████████▉| 261/264 [03:46<00:02,  1.23it/s] 99%|█████████▉| 262/264 [03:47<00:01,  1.28it/s]100%|█████████▉| 263/264 [03:47<00:00,  1.32it/s]100%|██████████| 264/264 [03:48<00:00,  1.34it/s]100%|██████████| 264/264 [03:48<00:00,  1.15it/s]Save Model
Save current model ...
[Error] Traceback (most recent call last):
  File "train.py", line 346, in train
    best_model, best_loss, current_model = \
  File "train.py", line 439, in save_model
    model_path = os.path.join(save_dir, current_model)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 328, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 401, in _legacy_save
    pickler.dump(obj)
AttributeError: Can't pickle local object 'train.<locals>.ModelWithLoss'

Can't pickle local object 'train.<locals>.ModelWithLoss'
Step: 4500. Epoch: 17/30. Iteration: 13/264. Cls loss: 11.91492. Reg loss: 0.04094. Total loss: 11.95587
Step 4500: Current Classification Loss:11.914925; Current Regression Loss:0.040943; Current Loss:11.955868;              Average Classification Loss:12.940061; Average Regression Loss:0.046386; Average Loss:12.986447; Current Learning Rate:0.000100.
Save Model
Save current model ...
[Error] Traceback (most recent call last):
  File "train.py", line 346, in train
    best_model, best_loss, current_model = \
  File "train.py", line 439, in save_model
    model_path = os.path.join(save_dir, current_model)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 328, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 401, in _legacy_save
    pickler.dump(obj)
AttributeError: Can't pickle local object 'train.<locals>.ModelWithLoss'

Can't pickle local object 'train.<locals>.ModelWithLoss'
Step: 4600. Epoch: 17/30. Iteration: 113/264. Cls loss: 11.03542. Reg loss: 0.04150. Total loss: 11.07693
Step 4600: Current Classification Loss:11.035423; Current Regression Loss:0.041503; Current Loss:11.076926;              Average Classification Loss:14.256417; Average Regression Loss:0.047808; Average Loss:14.304225; Current Learning Rate:0.000100.
Save Model
Save current model ...
[Error] Traceback (most recent call last):
  File "train.py", line 346, in train
    best_model, best_loss, current_model = \
  File "train.py", line 439, in save_model
    model_path = os.path.join(save_dir, current_model)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 328, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/scratch/mj1477/anaconda3/lib/python3.7/site-packages/torch/serialization.py", line 401, in _legacy_save
    pickler.dump(obj)
AttributeError: Can't pickle local object 'train.<locals>.ModelWithLoss'

Can't pickle local object 'train.<locals>.ModelWithLoss'
Step: 4700. Epoch: 17/30. Iteration: 213/264. Cls loss: 5.43370. Reg loss: 0.08253. Total loss: 5.51624
Step 4700: Current Classification Loss:5.433705; Current Regression Loss:0.082534; Current Loss:5.516238;              Average Classification Loss:13.152867; Average Regression Loss:0.047717; Average Loss:13.200584; Current Learning Rate:0.000100.

  0%|          | 0/264 [00:00<?, ?it/s]Val. Epoch: 17/30. Classification loss: 6.54260. Regression loss: 0.08520. Total loss: 6.62780
--------------------------------------------After Epoch 17------------------------------------------------
Step 4752: Validation Classification Loss:6.542599; Regression Loss:0.085201; Total Loss:6.627800
----------------------------------------------------------------------------------------------------------
